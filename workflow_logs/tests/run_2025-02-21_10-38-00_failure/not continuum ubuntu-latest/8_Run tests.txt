2025-02-21T10:39:25.5452145Z ##[group]Run pytest tardis --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"
2025-02-21T10:39:25.5454644Z [36;1mpytest tardis --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"[0m
2025-02-21T10:39:25.5514529Z shell: /usr/bin/bash -l {0}
2025-02-21T10:39:25.5514796Z env:
2025-02-21T10:39:25.5514971Z   CACHE_NUMBER: 0
2025-02-21T10:39:25.5515593Z   PYTEST_FLAGS: --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append
2025-02-21T10:39:25.5516247Z   CODECOV_TOKEN: 
2025-02-21T10:39:25.5516467Z   MAMBA_ROOT_PREFIX: /home/runner/micromamba
2025-02-21T10:39:25.5516773Z   MAMBA_EXE: /home/runner/micromamba-bin/micromamba
2025-02-21T10:39:25.5517116Z   CONDARC: /home/runner/work/_temp/setup-micromamba/.condarc
2025-02-21T10:39:25.5517448Z ##[endgroup]
2025-02-21T10:39:34.8099476Z ============================= test session starts ==============================
2025-02-21T10:39:34.8100248Z platform linux -- Python 3.12.4, pytest-8.2.2, pluggy-1.5.0
2025-02-21T10:39:34.8100872Z rootdir: /home/runner/work/tardis/tardis
2025-02-21T10:39:34.8101386Z configfile: pyproject.toml
2025-02-21T10:39:34.8101996Z plugins: metadata-3.1.1, anyio-4.4.0, doctestplus-1.2.1, cov-5.0.0, html-4.1.1
2025-02-21T10:39:34.8103369Z collected 1796 items / 2 deselected / 1794 selected
2025-02-21T10:39:34.8103753Z 
2025-02-21T10:39:39.6834129Z tardis/energy_input/tests/test_energy_source.py ..xxx                    [  0%]
2025-02-21T10:39:42.6080693Z tardis/energy_input/tests/test_gamma_ray_channel.py ...........          [  0%]
2025-02-21T10:39:44.1542397Z tardis/energy_input/tests/test_gamma_ray_grid.py xx.                     [  1%]
2025-02-21T10:39:45.9009144Z tardis/energy_input/tests/test_gamma_ray_interactions.py xx....          [  1%]
2025-02-21T10:39:45.9100470Z tardis/energy_input/tests/test_gamma_ray_packet_source.py sssssssss      [  1%]
2025-02-21T10:39:47.2317938Z tardis/energy_input/tests/test_util.py .....xxxx.....                    [  2%]
2025-02-21T10:39:47.6085139Z tardis/grid/tests/test_grid.py .                                         [  2%]
2025-02-21T10:39:47.6100424Z tardis/gui/tests/test_gui.py s                                           [  2%]
2025-02-21T10:39:51.1754266Z tardis/io/configuration/tests/test_config_reader.py ...........          [  3%]
2025-02-21T10:39:51.1881838Z tardis/io/configuration/tests/test_configuration_namespace.py .........  [  3%]
2025-02-21T10:39:51.2152302Z tardis/io/logger/tests/test_logging.py ssssssssssssssssssssssssssss      [  5%]
2025-02-21T10:40:28.8717348Z tardis/io/model/readers/tests/test_arepo_parser.py ..                    [  5%]
2025-02-21T10:40:28.8865892Z tardis/io/model/readers/tests/test_ascii_readers.py ...                  [  5%]
2025-02-21T10:40:28.8970164Z tardis/io/model/readers/tests/test_cmfgen_reader.py ..                   [  5%]
2025-02-21T10:40:28.9283254Z tardis/io/model/readers/tests/test_csvy_reader.py ....                   [  6%]
2025-02-21T10:40:28.9488739Z tardis/io/model/readers/tests/test_stella_reader.py ..                   [  6%]
2025-02-21T10:40:29.2461793Z tardis/io/tests/test_HDFWriter.py ...............                        [  7%]
2025-02-21T10:40:29.5743918Z tardis/io/tests/test_atomic.py .....                                     [  7%]
2025-02-21T10:40:29.5936546Z tardis/io/tests/test_decay.py ..                                         [  7%]
2025-02-21T10:40:29.7908679Z tardis/io/tests/test_model_reader.py ......                              [  7%]
2025-02-21T10:40:29.7975889Z tardis/model/geometry/tests/test_radial1d.py ..                          [  7%]
2025-02-21T10:41:27.0512093Z tardis/model/tests/test_base.py ........................................ [ 10%]
2025-02-21T10:41:28.0437181Z ............                                                             [ 10%]
2025-02-21T10:41:31.1004659Z tardis/model/tests/test_csvy_model.py .........                          [ 11%]
2025-02-21T10:41:31.1469984Z tardis/model/tests/test_density.py ..                                    [ 11%]
2025-02-21T10:41:32.4489614Z tardis/opacities/tests/test_opacity_solver.py .....                      [ 11%]
2025-02-21T10:41:33.7729812Z tardis/opacities/tests/test_opacity_state_numba.py .....                 [ 11%]
2025-02-21T10:41:35.3768945Z tardis/opacities/tests/test_tau_sobolev.py ..                            [ 12%]
2025-02-21T10:41:38.4079513Z tardis/plasma/equilibrium/tests/test_collisional_transitions.py ...      [ 12%]
2025-02-21T10:42:23.8922816Z tardis/plasma/equilibrium/tests/test_level_populations.py ....           [ 12%]
2025-02-21T10:42:35.4084400Z tardis/plasma/equilibrium/tests/test_rate_matrix.py .                    [ 12%]
2025-02-21T10:42:36.8027152Z tardis/plasma/tests/test_complete_plasmas.py ..............s......s..... [ 13%]
2025-02-21T10:42:39.6365104Z s....ssssss............s......s.....ss.....s....ssssss............s..... [ 18%]
2025-02-21T10:42:41.5542110Z .s.....ss.....s....ssssss............s......s.....ss.....s....ssssss.... [ 22%]
2025-02-21T10:42:44.4024344Z ........s......s.....ss.....s....ssssss............s......s.....ss.....s [ 26%]
2025-02-21T10:42:47.2263950Z ....ssssss............s......s.....ss.....s....ssssss............s...... [ 30%]
2025-02-21T10:42:47.9141642Z s.....ss.....s....ssssss............s......s.....ss.....s.ss.ssssss..... [ 34%]
2025-02-21T10:42:50.7575830Z .......s......s.....ss.....s....ssssss............s......s.....ss.....s. [ 38%]
2025-02-21T10:42:53.8884123Z ...ssssss............s......s.....ss.....s....ssssss............s......s [ 42%]
2025-02-21T10:42:56.8926584Z .....ss.....s....ssssss............s......s.....s...........ssssss...... [ 46%]
2025-02-21T10:42:58.6539030Z ......s......s.....s...........ssssss............s......s.....s......... [ 50%]
2025-02-21T10:43:01.4936329Z ..ssssss............s......s.....ss.....s....ssssss............s......s. [ 54%]
2025-02-21T10:43:04.9309083Z ....ss.....s....ssssss...................s......s.....s....ssss......... [ 58%]
2025-02-21T10:43:05.2134076Z ............s......s.....s....ssss.......                                [ 60%]
2025-02-21T10:43:05.3268398Z tardis/plasma/tests/test_hdf_plasma.py ................................. [ 62%]
2025-02-21T10:43:05.3380359Z ......                                                                   [ 62%]
2025-02-21T10:43:05.4759676Z tardis/plasma/tests/test_nlte_excitation.py ...                          [ 62%]
2025-02-21T10:45:22.8035418Z tardis/plasma/tests/test_nlte_solver.py .....X                           [ 63%]
2025-02-21T10:45:22.8060729Z tardis/plasma/tests/test_plasma_continuum.py .                           [ 63%]
2025-02-21T10:45:46.1639337Z tardis/plasma/tests/test_plasma_vboundary.py .............               [ 63%]
2025-02-21T10:45:59.4395764Z tardis/plasma/tests/test_tardis_model_density_config.py ...              [ 64%]
2025-02-21T10:46:00.1850373Z tardis/simulation/tests/test_convergence.py .....                        [ 64%]
2025-02-21T10:46:08.7286998Z tardis/simulation/tests/test_simulation.py .............                 [ 65%]
2025-02-21T10:46:08.7477403Z tardis/spectrum/tests/test_cuda_formal_integral.py sssssssssssssssssssss [ 66%]
2025-02-21T10:46:09.2166956Z ssss...ssssssssssssssssssssss                                            [ 67%]
2025-02-21T10:46:09.2238037Z tardis/spectrum/tests/test_luminosity.py ....                            [ 68%]
2025-02-21T10:46:10.8076199Z tardis/spectrum/tests/test_numba_formal_integral.py .................... [ 69%]
2025-02-21T10:46:10.8265047Z ..........                                                               [ 69%]
2025-02-21T10:46:10.9941825Z tardis/spectrum/tests/test_spectrum.py ................................. [ 71%]
2025-02-21T10:46:11.0261731Z .........                                                                [ 72%]
2025-02-21T10:46:11.1082437Z tardis/spectrum/tests/test_spectrum_solver.py .FFF                       [ 72%]
2025-02-21T10:46:42.5581402Z tardis/tests/test_tardis_full.py .FFF                                    [ 72%]
2025-02-21T10:48:07.4043896Z tardis/tests/test_tardis_full_formal_integral.py ................        [ 73%]
2025-02-21T10:48:07.4778886Z tardis/tests/test_util.py .............................................  [ 75%]
2025-02-21T10:48:10.1602429Z tardis/transport/montecarlo/tests/test_base.py x.....................    [ 77%]
2025-02-21T10:48:17.2861158Z tardis/transport/montecarlo/tests/test_interaction.py .......            [ 77%]
2025-02-21T10:48:17.4992268Z tardis/transport/montecarlo/tests/test_macro_atom.py ....                [ 77%]
2025-02-21T10:48:17.5167567Z tardis/transport/montecarlo/tests/test_montecarlo.py sssssssssssssssssss [ 78%]
2025-02-21T10:48:17.5580768Z sssssssssssssssssssssssssssssssssssssssssssss                            [ 81%]
2025-02-21T10:48:26.9365120Z tardis/transport/montecarlo/tests/test_montecarlo_main_loop.py x..       [ 81%]
2025-02-21T10:48:26.9428396Z tardis/transport/montecarlo/tests/test_nonhomologous.py ...              [ 81%]
2025-02-21T10:48:32.7286961Z tardis/transport/montecarlo/tests/test_numba_interface.py .....x.        [ 82%]
2025-02-21T10:48:33.2183485Z tardis/transport/montecarlo/tests/test_opacities.py ...............      [ 82%]
2025-02-21T10:48:34.2352919Z tardis/transport/montecarlo/tests/test_packet.py .................xXXXXX [ 84%]
2025-02-21T10:48:34.3733294Z XX.........                                                              [ 84%]
2025-02-21T10:48:34.4012496Z tardis/transport/montecarlo/tests/test_packet_source.py ........         [ 85%]
2025-02-21T10:48:34.7103201Z tardis/transport/montecarlo/tests/test_rpacket_last_interaction_tracker.py . [ 85%]
2025-02-21T10:48:35.1138720Z .....                                                                    [ 85%]
2025-02-21T10:49:10.1607823Z tardis/transport/montecarlo/tests/test_rpacket_tracker.py ......         [ 85%]
2025-02-21T10:49:10.1893972Z tardis/transport/montecarlo/tests/test_single_packet_loop.py xxx         [ 86%]
2025-02-21T10:49:10.1926616Z tardis/transport/montecarlo/tests/test_tracker_utils.py ..               [ 86%]
2025-02-21T10:49:12.5986847Z tardis/transport/montecarlo/tests/test_vpacket.py ..x.                   [ 86%]
2025-02-21T10:49:12.6158671Z tardis/transport/montecarlo/tests/test_weighted_packet_source.py ....    [ 86%]
2025-02-21T10:49:16.0252070Z tardis/transport/montecarlo/tests/test_weighted_packet_source_integration.py . [ 86%]
2025-02-21T10:49:16.0253612Z                                                                          [ 86%]
2025-02-21T10:49:16.7623798Z tardis/transport/tests/test_doppler_factor.py ..................         [ 87%]
2025-02-21T10:49:18.5820199Z tardis/visualization/tools/tests/test_convergence_plot.py .............. [ 88%]
2025-02-21T10:49:20.8082804Z ......                                                                   [ 88%]
2025-02-21T10:49:25.5188356Z tardis/visualization/tools/tests/test_liv_plot.py ...................... [ 90%]
2025-02-21T10:49:28.1629283Z .............................                                            [ 91%]
2025-02-21T10:49:31.0084248Z tardis/visualization/tools/tests/test_rpacket_plot.py .................. [ 92%]
2025-02-21T10:49:38.0360237Z ....                                                                     [ 92%]
2025-02-21T10:49:44.0553622Z tardis/visualization/tools/tests/test_sdec_plot.py ..................... [ 94%]
2025-02-21T10:49:52.1072369Z ..............................                                           [ 95%]
2025-02-21T10:49:52.5447601Z tardis/visualization/widgets/tests/test_custom_abundance.py ........ss.. [ 96%]
2025-02-21T10:49:52.6166610Z ....                                                                     [ 96%]
2025-02-21T10:49:53.6728197Z tardis/visualization/widgets/tests/test_line_info.py ................... [ 97%]
2025-02-21T10:49:54.2984073Z ..................                                                       [ 98%]
2025-02-21T10:50:57.4518752Z tardis/visualization/widgets/tests/test_shell_info.py .................. [ 99%]
2025-02-21T10:51:06.0569706Z ......                                                                   [100%]
2025-02-21T10:51:06.0570208Z 
2025-02-21T10:51:06.0570395Z =================================== FAILURES ===================================
2025-02-21T10:51:06.0571070Z ________________ TestSpectrumSolver.test_spectrum_real_packets _________________
2025-02-21T10:51:06.0571593Z 
2025-02-21T10:51:06.0572044Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7fb3c81348c0>
2025-02-21T10:51:06.0573295Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fb3c7149820>
2025-02-21T10:51:06.0573879Z 
2025-02-21T10:51:06.0574172Z     def test_spectrum_real_packets(self, simulation_regression_data):
2025-02-21T10:51:06.0574924Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T10:51:06.0575815Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T10:51:06.0576503Z     
2025-02-21T10:51:06.0576965Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T10:51:06.0577637Z         result = solver.spectrum_real_packets.luminosity
2025-02-21T10:51:06.0578282Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T10:51:06.0578894Z         expected = self.get_expected_data(key)
2025-02-21T10:51:06.0579613Z     
2025-02-21T10:51:06.0579934Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T10:51:06.0580366Z     
2025-02-21T10:51:06.0580650Z >       assert_quantity_allclose(
2025-02-21T10:51:06.0581036Z             result,
2025-02-21T10:51:06.0581339Z             luminosity,
2025-02-21T10:51:06.0581652Z         )
2025-02-21T10:51:06.0581823Z 
2025-02-21T10:51:06.0582037Z tardis/spectrum/tests/test_spectrum_solver.py:61: 
2025-02-21T10:51:06.0582590Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0583747Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T10:51:06.0584633Z     np.testing.assert_allclose(
2025-02-21T10:51:06.0585071Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0585415Z 
2025-02-21T10:51:06.0586268Z args = (<function assert_allclose.<locals>.compare at 0x7fb396c7fce0>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T10:51:06.0587430Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T10:51:06.0588163Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T10:51:06.0588746Z 
2025-02-21T10:51:06.0588863Z     @wraps(func)
2025-02-21T10:51:06.0589181Z     def inner(*args, **kwds):
2025-02-21T10:51:06.0589558Z         with self._recreate_cm():
2025-02-21T10:51:06.0589962Z >           return func(*args, **kwds)
2025-02-21T10:51:06.0590373Z E           AssertionError: 
2025-02-21T10:51:06.0590792Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0591231Z E           
2025-02-21T10:51:06.0591557Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T10:51:06.0592028Z E           Max absolute difference: 1.94155993e+40
2025-02-21T10:51:06.0592497Z E           Max relative difference: 137.15340685
2025-02-21T10:51:06.0593242Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0593799Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0594319Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T10:51:06.0594864Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0595152Z 
2025-02-21T10:51:06.0595507Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T10:51:06.0596660Z ___________ TestSpectrumSolver.test_spectrum_real_packets_reabsorbed ___________
2025-02-21T10:51:06.0597188Z 
2025-02-21T10:51:06.0597659Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7fb3c8134bf0>
2025-02-21T10:51:06.0598755Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fb3c7149820>
2025-02-21T10:51:06.0599362Z 
2025-02-21T10:51:06.0599698Z     def test_spectrum_real_packets_reabsorbed(self, simulation_regression_data):
2025-02-21T10:51:06.0600504Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T10:51:06.0601385Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T10:51:06.0602054Z     
2025-02-21T10:51:06.0602521Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T10:51:06.0603441Z         result = solver.spectrum_real_packets_reabsorbed.luminosity
2025-02-21T10:51:06.0604194Z         key = "simulation/spectrum_solver/spectrum_real_packets_reabsorbed/luminosity"
2025-02-21T10:51:06.0604869Z         expected = self.get_expected_data(key)
2025-02-21T10:51:06.0605286Z     
2025-02-21T10:51:06.0605600Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T10:51:06.0606029Z     
2025-02-21T10:51:06.0606311Z >       assert_quantity_allclose(
2025-02-21T10:51:06.0606684Z             result,
2025-02-21T10:51:06.0606980Z             luminosity,
2025-02-21T10:51:06.0607484Z         )
2025-02-21T10:51:06.0607640Z 
2025-02-21T10:51:06.0607846Z tardis/spectrum/tests/test_spectrum_solver.py:77: 
2025-02-21T10:51:06.0608391Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0609328Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T10:51:06.0610217Z     np.testing.assert_allclose(
2025-02-21T10:51:06.0610660Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0611020Z 
2025-02-21T10:51:06.0611669Z args = (<function assert_allclose.<locals>.compare at 0x7fb396c7c4a0>, array([0., 0., 0., ..., 0., 0., 0.]), array([2.03920412e+38, 3.72882494e+38, 2.29646943e+38, ...,
2025-02-21T10:51:06.0612647Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T10:51:06.0613530Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T10:51:06.0614122Z 
2025-02-21T10:51:06.0614265Z     @wraps(func)
2025-02-21T10:51:06.0614623Z     def inner(*args, **kwds):
2025-02-21T10:51:06.0615002Z         with self._recreate_cm():
2025-02-21T10:51:06.0615404Z >           return func(*args, **kwds)
2025-02-21T10:51:06.0615815Z E           AssertionError: 
2025-02-21T10:51:06.0616221Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0616658Z E           
2025-02-21T10:51:06.0616984Z E           Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T10:51:06.0617461Z E           Max absolute difference: 1.0639846e+40
2025-02-21T10:51:06.0617930Z E           Max relative difference: 122.79315318
2025-02-21T10:51:06.0618388Z E            x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T10:51:06.0618934Z E            y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T10:51:06.0619484Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0619770Z 
2025-02-21T10:51:06.0620119Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T10:51:06.0620895Z ________________________ TestSpectrumSolver.test_solve _________________________
2025-02-21T10:51:06.0621331Z 
2025-02-21T10:51:06.0621779Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7fb3c8135490>
2025-02-21T10:51:06.0622791Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fb3c7149820>
2025-02-21T10:51:06.0623514Z 
2025-02-21T10:51:06.0623710Z     def test_solve(self, simulation_regression_data):
2025-02-21T10:51:06.0624543Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T10:51:06.0625416Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T10:51:06.0626113Z     
2025-02-21T10:51:06.0626608Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T10:51:06.0627381Z         result_real, result_virtual, result_integrated = solver.solve(
2025-02-21T10:51:06.0627973Z             transport_state
2025-02-21T10:51:06.0628344Z         )
2025-02-21T10:51:06.0628840Z         key_real = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T10:51:06.0629510Z         expected_real = self.get_expected_data(key_real)
2025-02-21T10:51:06.0629961Z     
2025-02-21T10:51:06.0630324Z         luminosity_real = u.Quantity(expected_real, "erg /s")
2025-02-21T10:51:06.0630795Z     
2025-02-21T10:51:06.0631074Z >       assert_quantity_allclose(
2025-02-21T10:51:06.0631478Z             result_real.luminosity,
2025-02-21T10:51:06.0631875Z             luminosity_real,
2025-02-21T10:51:06.0632217Z         )
2025-02-21T10:51:06.0632373Z 
2025-02-21T10:51:06.0632583Z tardis/spectrum/tests/test_spectrum_solver.py:95: 
2025-02-21T10:51:06.0633300Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0634243Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T10:51:06.0635304Z     np.testing.assert_allclose(
2025-02-21T10:51:06.0635740Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0636086Z 
2025-02-21T10:51:06.0636895Z args = (<function assert_allclose.<locals>.compare at 0x7fb396c7ff60>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T10:51:06.0638019Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T10:51:06.0638752Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T10:51:06.0639322Z 
2025-02-21T10:51:06.0639496Z     @wraps(func)
2025-02-21T10:51:06.0639814Z     def inner(*args, **kwds):
2025-02-21T10:51:06.0640190Z         with self._recreate_cm():
2025-02-21T10:51:06.0640589Z >           return func(*args, **kwds)
2025-02-21T10:51:06.0641004Z E           AssertionError: 
2025-02-21T10:51:06.0641416Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0641848Z E           
2025-02-21T10:51:06.0642175Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T10:51:06.0642649Z E           Max absolute difference: 1.94155993e+40
2025-02-21T10:51:06.0643267Z E           Max relative difference: 137.15340685
2025-02-21T10:51:06.0643823Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0644378Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0644914Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T10:51:06.0645461Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0645743Z 
2025-02-21T10:51:06.0646088Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T10:51:06.0646895Z __________________ TestTransportSimple.test_j_blue_estimators __________________
2025-02-21T10:51:06.0647370Z 
2025-02-21T10:51:06.0647733Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7fb3c8135e20>
2025-02-21T10:51:06.0648670Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fb3c7149820>
2025-02-21T10:51:06.0649250Z 
2025-02-21T10:51:06.0649493Z     def test_j_blue_estimators(self, simulation_regression_data):
2025-02-21T10:51:06.0650145Z         key = "simulation/transport/transport_state/j_blue_estimator"
2025-02-21T10:51:06.0650706Z         expected = self.get_expected_data(key)
2025-02-21T10:51:06.0651304Z     
2025-02-21T10:51:06.0651585Z >       npt.assert_allclose(
2025-02-21T10:51:06.0652289Z             simulation_regression_data.transport.transport_state.radfield_mc_estimators.j_blue_estimator,
2025-02-21T10:51:06.0653180Z             expected.values,
2025-02-21T10:51:06.0653523Z         )
2025-02-21T10:51:06.0653683Z 
2025-02-21T10:51:06.0653842Z tardis/tests/test_tardis_full.py:60: 
2025-02-21T10:51:06.0654306Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0654655Z 
2025-02-21T10:51:06.0666423Z args = (<function assert_allclose.<locals>.compare at 0x7fb3c767ce00>, array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0667295Z        [0., 0., .....,
2025-02-21T10:51:06.0667654Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0668053Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0668441Z        [0., 0., 0., ..., 0., 0., 0.]]))
2025-02-21T10:51:06.0669104Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T10:51:06.0669680Z 
2025-02-21T10:51:06.0669812Z     @wraps(func)
2025-02-21T10:51:06.0670136Z     def inner(*args, **kwds):
2025-02-21T10:51:06.0670526Z         with self._recreate_cm():
2025-02-21T10:51:06.0670937Z >           return func(*args, **kwds)
2025-02-21T10:51:06.0671373Z E           AssertionError: 
2025-02-21T10:51:06.0671813Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0672513Z E           
2025-02-21T10:51:06.0672872Z E           Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T10:51:06.0673597Z E           Max absolute difference: 1.43452643e-17
2025-02-21T10:51:06.0674094Z E           Max relative difference: 235.31367318
2025-02-21T10:51:06.0674581Z E            x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0675052Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0675500Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T10:51:06.0675950Z E            y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0676365Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0676762Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T10:51:06.0677037Z 
2025-02-21T10:51:06.0677375Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T10:51:06.0678139Z ______________________ TestTransportSimple.test_spectrum _______________________
2025-02-21T10:51:06.0678579Z 
2025-02-21T10:51:06.0678933Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7fb3c8136090>
2025-02-21T10:51:06.0679817Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fb3c7149820>
2025-02-21T10:51:06.0680379Z 
2025-02-21T10:51:06.0680592Z     def test_spectrum(self, simulation_regression_data):
2025-02-21T10:51:06.0681216Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T10:51:06.0681798Z         expected = self.get_expected_data(key)
2025-02-21T10:51:06.0682196Z     
2025-02-21T10:51:06.0682499Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T10:51:06.0682910Z     
2025-02-21T10:51:06.0683355Z >       assert_quantity_allclose(
2025-02-21T10:51:06.0683956Z             simulation_regression_data.spectrum_solver.spectrum_real_packets.luminosity,
2025-02-21T10:51:06.0684568Z             luminosity,
2025-02-21T10:51:06.0684876Z         )
2025-02-21T10:51:06.0685037Z 
2025-02-21T10:51:06.0685201Z tardis/tests/test_tardis_full.py:71: 
2025-02-21T10:51:06.0685686Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0686592Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T10:51:06.0687442Z     np.testing.assert_allclose(
2025-02-21T10:51:06.0687873Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0688205Z 
2025-02-21T10:51:06.0689026Z args = (<function assert_allclose.<locals>.compare at 0x7fb3bc91d6c0>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.47119190e+39, 1.69564189e+39, 1.35368464e+39, ...,
2025-02-21T10:51:06.0690382Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T10:51:06.0691112Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T10:51:06.0691700Z 
2025-02-21T10:51:06.0691825Z     @wraps(func)
2025-02-21T10:51:06.0692150Z     def inner(*args, **kwds):
2025-02-21T10:51:06.0692539Z         with self._recreate_cm():
2025-02-21T10:51:06.0692921Z >           return func(*args, **kwds)
2025-02-21T10:51:06.0693526Z E           AssertionError: 
2025-02-21T10:51:06.0693957Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0694422Z E           
2025-02-21T10:51:06.0694774Z E           Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T10:51:06.0695314Z E           Max absolute difference: 1.96604107e+40
2025-02-21T10:51:06.0695784Z E           Max relative difference: 97.03021569
2025-02-21T10:51:06.0696345Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0696894Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0697417Z E            y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0697960Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0698456Z 
2025-02-21T10:51:06.0698805Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T10:51:06.0699609Z __________________ TestTransportSimple.test_virtual_spectrum ___________________
2025-02-21T10:51:06.0700080Z 
2025-02-21T10:51:06.0700436Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7fb3c8136360>
2025-02-21T10:51:06.0701359Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fb3c7149820>
2025-02-21T10:51:06.0701935Z 
2025-02-21T10:51:06.0702192Z     def test_virtual_spectrum(self, simulation_regression_data):
2025-02-21T10:51:06.0702888Z         key = "simulation/spectrum_solver/spectrum_virtual_packets/luminosity"
2025-02-21T10:51:06.0703717Z         expected = self.get_expected_data(key)
2025-02-21T10:51:06.0704133Z     
2025-02-21T10:51:06.0704454Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T10:51:06.0704881Z     
2025-02-21T10:51:06.0705168Z >       assert_quantity_allclose(
2025-02-21T10:51:06.0705815Z             simulation_regression_data.spectrum_solver.spectrum_virtual_packets.luminosity,
2025-02-21T10:51:06.0706479Z             luminosity,
2025-02-21T10:51:06.0706793Z         )
2025-02-21T10:51:06.0706955Z 
2025-02-21T10:51:06.0707106Z tardis/tests/test_tardis_full.py:82: 
2025-02-21T10:51:06.0707573Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0708502Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T10:51:06.0709455Z     np.testing.assert_allclose(
2025-02-21T10:51:06.0709941Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T10:51:06.0710311Z 
2025-02-21T10:51:06.0711119Z args = (<function assert_allclose.<locals>.compare at 0x7fb3bc91ede0>, array([1.31895331e+39, 2.31381538e+39, 3.72000430e+39,...), array([1.44033177e+39, 1.35611403e+39, 1.39755698e+39, ...,
2025-02-21T10:51:06.0712174Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T10:51:06.0712843Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T10:51:06.0713752Z 
2025-02-21T10:51:06.0713863Z     @wraps(func)
2025-02-21T10:51:06.0714091Z     def inner(*args, **kwds):
2025-02-21T10:51:06.0714338Z         with self._recreate_cm():
2025-02-21T10:51:06.0714590Z >           return func(*args, **kwds)
2025-02-21T10:51:06.0714858Z E           AssertionError: 
2025-02-21T10:51:06.0715119Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0715610Z E           
2025-02-21T10:51:06.0715822Z E           Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T10:51:06.0716114Z E           Max absolute difference: 4.69537822e+39
2025-02-21T10:51:06.0716403Z E           Max relative difference: 419.77405263
2025-02-21T10:51:06.0716743Z E            x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0717088Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0717426Z E            y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0717752Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0717923Z 
2025-02-21T10:51:06.0718144Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T10:51:06.0718569Z =============================== warnings summary ===============================
2025-02-21T10:51:06.0718901Z tardis/io/configuration/config_validator.py:6
2025-02-21T10:51:06.0719230Z tardis/io/configuration/config_validator.py:6
2025-02-21T10:51:06.0719761Z   /home/runner/work/tardis/tardis/tardis/io/configuration/config_validator.py:6: DeprecationWarning:
2025-02-21T10:51:06.0720250Z   
2025-02-21T10:51:06.0721630Z   jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
2025-02-21T10:51:06.0723362Z 
2025-02-21T10:51:06.0723639Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22
2025-02-21T10:51:06.0724403Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22: DeprecationWarning:
2025-02-21T10:51:06.0724975Z   
2025-02-21T10:51:06.0725237Z   Jupyter is migrating its paths to use standard platformdirs
2025-02-21T10:51:06.0725674Z   given by the platformdirs library.  To remove this warning and
2025-02-21T10:51:06.0726119Z   see the appropriate new directories, set the environment variable
2025-02-21T10:51:06.0726554Z   `JUPYTER_PLATFORM_DIRS=1` and then run `jupyter --paths`.
2025-02-21T10:51:06.0726976Z   The use of platformdirs will be the default in `jupyter_core` v6
2025-02-21T10:51:06.0727247Z 
2025-02-21T10:51:06.0734722Z tardis/io/tests/test_HDFWriter.py::test_multi_index_write
2025-02-21T10:51:06.0735261Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T10:51:06.0735826Z   /home/runner/work/tardis/tardis/tardis/io/util.py:276: PerformanceWarning:
2025-02-21T10:51:06.0736200Z   
2025-02-21T10:51:06.0736354Z   
2025-02-21T10:51:06.0736650Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T10:51:06.0737217Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T10:51:06.0737571Z 
2025-02-21T10:51:06.0737776Z tardis/io/tests/test_model_reader.py::test_read_cmfgen_isotope_abundances
2025-02-21T10:51:06.0738276Z tardis/plasma/tests/test_tardis_model_density_config.py::test_electron_densities
2025-02-21T10:51:06.0738849Z tardis/plasma/tests/test_tardis_model_density_config.py::test_isotope_number_densities
2025-02-21T10:51:06.0739347Z tardis/plasma/tests/test_tardis_model_density_config.py::test_t_rad
2025-02-21T10:51:06.0739932Z   /home/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:82: DeprecationWarning:
2025-02-21T10:51:06.0740397Z   
2025-02-21T10:51:06.0740596Z   The current CMFGEN model parser is deprecated
2025-02-21T10:51:06.0740793Z 
2025-02-21T10:51:06.0740900Z tardis/io/tests/test_model_reader.py: 1 warning
2025-02-21T10:51:06.0741263Z tardis/plasma/tests/test_tardis_model_density_config.py: 9 warnings
2025-02-21T10:51:06.0741827Z   /home/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:40: DeprecationWarning:
2025-02-21T10:51:06.0742463Z   
2025-02-21T10:51:06.0742668Z   The current CMFGEN model parser is deprecated
2025-02-21T10:51:06.0742866Z 
2025-02-21T10:51:06.0743314Z tardis/model/tests/test_base.py::TestModelFromPaper1Config::test_abundances
2025-02-21T10:51:06.0743977Z   /home/runner/work/tardis/tardis/tardis/transport/montecarlo/montecarlo_main_loop.py:123: NumbaTypeSafetyWarning:
2025-02-21T10:51:06.0744494Z   
2025-02-21T10:51:06.0745023Z   [1m[1m[1munsafe cast from uint64 to int64. Precision may be lost.[0m[0m[0m
2025-02-21T10:51:06.0745289Z 
2025-02-21T10:51:06.0745395Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T10:51:06.0745686Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T10:51:06.0746056Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T10:51:06.0746615Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:50: DeprecationWarning:
2025-02-21T10:51:06.0747039Z   
2025-02-21T10:51:06.0747228Z   v_inner_boundary < 0, assuming default value
2025-02-21T10:51:06.0747408Z 
2025-02-21T10:51:06.0747510Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T10:51:06.0747794Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T10:51:06.0748478Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T10:51:06.0749373Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:61: DeprecationWarning:
2025-02-21T10:51:06.0749977Z   
2025-02-21T10:51:06.0750165Z   v_outer_boundary < 0, assuming default value
2025-02-21T10:51:06.0750350Z 
2025-02-21T10:51:06.0750816Z tardis/plasma/equilibrium/tests/test_level_populations.py::TestLevelPopulationSolver::test_solve[collisional_rate_solver0-radiative_transitions0]
2025-02-21T10:51:06.0751665Z   /home/runner/work/tardis/tardis/tardis/plasma/equilibrium/level_populations.py:65: FutureWarning:
2025-02-21T10:51:06.0752118Z   
2025-02-21T10:51:06.0752489Z   A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
2025-02-21T10:51:06.0753526Z   The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
2025-02-21T10:51:06.0754126Z   
2025-02-21T10:51:06.0754740Z   For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
2025-02-21T10:51:06.0755347Z 
2025-02-21T10:51:06.0755569Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3750]
2025-02-21T10:51:06.0756074Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3850]
2025-02-21T10:51:06.0756568Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3900]
2025-02-21T10:51:06.0757097Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:71: UserWarning:
2025-02-21T10:51:06.0757492Z   
2025-02-21T10:51:06.0757768Z   Requesting inner boundary below inner shell. Extrapolating the inner cell
2025-02-21T10:51:06.0758052Z 
2025-02-21T10:51:06.0758260Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T10:51:06.0758755Z   /home/runner/work/tardis/tardis/tardis/spectrum/base.py:70: UserWarning:
2025-02-21T10:51:06.0759103Z   
2025-02-21T10:51:06.0759512Z   SpectrumSolver.spectrum_virtual_packets is zero. Please run the montecarlo simulation with no_of_virtual_packets > 0
2025-02-21T10:51:06.0759924Z 
2025-02-21T10:51:06.0760133Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T10:51:06.0760624Z   /home/runner/work/tardis/tardis/tardis/spectrum/base.py:111: UserWarning:
2025-02-21T10:51:06.0760974Z   
2025-02-21T10:51:06.0761398Z   SpectrumSolver.integrator: The FormalIntegrator is not yet available.Please run the montecarlo simulation at least once.
2025-02-21T10:51:06.0761832Z 
2025-02-21T10:51:06.0762271Z tardis/transport/montecarlo/tests/test_vpacket.py::test_trace_vpacket_volley
2025-02-21T10:51:06.0762713Z   <string>:3: NumbaPendingDeprecationWarning:
2025-02-21T10:51:06.0763125Z   
2025-02-21T10:51:06.0764385Z   [1m[1mCode using Numba extension API maybe depending on 'old_style' error-capturing, which is deprecated and will be replaced by 'new_style' in a future release. See details at https://numba.readthedocs.io/en/latest/reference/deprecation.html#deprecation-of-old-style-numba-captured-errors
2025-02-21T10:51:06.0765433Z   Exception origin:
2025-02-21T10:51:06.0765804Z     File "/home/runner/micromamba/envs/tardis/lib/python3.12/inspect.py", line 3180, in _bind
2025-02-21T10:51:06.0766232Z       raise TypeError(msg) from None
2025-02-21T10:51:06.0766485Z   [0m[0m
2025-02-21T10:51:06.0766581Z 
2025-02-21T10:51:06.0766916Z tardis/visualization/tools/tests/test_sdec_plot.py::TestSDECPlotter::test_mpl_image[plotter_generate_plot_mpl4]
2025-02-21T10:51:06.0767620Z   /home/runner/work/tardis/tardis/tardis/visualization/tools/sdec_plot.py:1225: RuntimeWarning:
2025-02-21T10:51:06.0768056Z   
2025-02-21T10:51:06.0769006Z   More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
2025-02-21T10:51:06.0769961Z 
2025-02-21T10:51:06.0770463Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0771255Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0772035Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0772808Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0773823Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0774590Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0775374Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T10:51:06.0775879Z   
2025-02-21T10:51:06.0776161Z   Passing unrecognized arguments to super(Checkbox).__init__(icon='lock').
2025-02-21T10:51:06.0776616Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T10:51:06.0777116Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T10:51:06.0777449Z 
2025-02-21T10:51:06.0777806Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0778597Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0779390Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T10:51:06.0779894Z   
2025-02-21T10:51:06.0780158Z   Passing unrecognized arguments to super(FloatText).__init__(min=0).
2025-02-21T10:51:06.0780587Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T10:51:06.0781090Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T10:51:06.0781410Z 
2025-02-21T10:51:06.0781763Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T10:51:06.0782555Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T10:51:06.0783265Z   
2025-02-21T10:51:06.0783537Z   Passing unrecognized arguments to super(HTML).__init__(indent=True).
2025-02-21T10:51:06.0784111Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T10:51:06.0784597Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T10:51:06.0784921Z 
2025-02-21T10:51:06.0785350Z tardis/visualization/widgets/tests/test_line_info.py::TestLineInfoWidgetData::test_get_species_interactions[wavelength_range0-packet_out_nu]
2025-02-21T10:51:06.0786199Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/qgridnext/grid.py:825: DeprecationWarning:
2025-02-21T10:51:06.0786673Z   
2025-02-21T10:51:06.0787028Z   QgridWidget._grid_options_changed is deprecated in traitlets 4.1: use @observe and @unobserve instead.
2025-02-21T10:51:06.0787386Z 
2025-02-21T10:51:06.0787649Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T10:51:06.0788196Z   /home/runner/work/tardis/tardis/tardis/io/util.py:289: PerformanceWarning:
2025-02-21T10:51:06.0788558Z   
2025-02-21T10:51:06.0788706Z   
2025-02-21T10:51:06.0788990Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T10:51:06.0789527Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T10:51:06.0789870Z 
2025-02-21T10:51:06.0790120Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T10:51:06.0790806Z   /home/runner/work/tardis/tardis/tardis/io/util.py:292: PerformanceWarning:
2025-02-21T10:51:06.0791159Z   
2025-02-21T10:51:06.0791313Z   
2025-02-21T10:51:06.0791591Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T10:51:06.0792048Z   map directly to c-types [inferred_type->mixed,key->values] [items->None]
2025-02-21T10:51:06.0792307Z 
2025-02-21T10:51:06.0792558Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T10:51:06.0793415Z   /home/runner/work/tardis/tardis/tardis/spectrum/formal_integral.py:398: UserWarning:
2025-02-21T10:51:06.0793820Z   
2025-02-21T10:51:06.0794091Z   The number of interpolate_shells was not specified. The value was set to 80.
2025-02-21T10:51:06.0794368Z 
2025-02-21T10:51:06.0794559Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-02-21T10:51:06.0794832Z 
2025-02-21T10:51:06.0794996Z ---------- coverage: platform linux, python 3.12.4-final-0 -----------
2025-02-21T10:51:06.0795365Z Coverage HTML written to dir coverage_html_report
2025-02-21T10:51:06.0795659Z Coverage XML written to file coverage.xml
2025-02-21T10:51:06.0795842Z 
2025-02-21T10:51:06.0795962Z =========================== short test summary info ============================
2025-02-21T10:51:06.0796537Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets - AssertionError: 
2025-02-21T10:51:06.0797080Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0797258Z 
2025-02-21T10:51:06.0797350Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T10:51:06.0797610Z Max absolute difference: 1.94155993e+40
2025-02-21T10:51:06.0797861Z Max relative difference: 137.15340685
2025-02-21T10:51:06.0798161Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0798467Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0798751Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T10:51:06.0799050Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0799581Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets_reabsorbed - AssertionError: 
2025-02-21T10:51:06.0800141Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0800318Z 
2025-02-21T10:51:06.0800406Z Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T10:51:06.0800658Z Max absolute difference: 1.0639846e+40
2025-02-21T10:51:06.0800905Z Max relative difference: 122.79315318
2025-02-21T10:51:06.0801358Z  x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T10:51:06.0801771Z  y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T10:51:06.0802165Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0802849Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve - AssertionError: 
2025-02-21T10:51:06.0803712Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0803942Z 
2025-02-21T10:51:06.0804135Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T10:51:06.0804528Z Max absolute difference: 1.94155993e+40
2025-02-21T10:51:06.0804885Z Max relative difference: 137.15340685
2025-02-21T10:51:06.0805385Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0805782Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0806190Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T10:51:06.0817716Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0818494Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_j_blue_estimators - AssertionError: 
2025-02-21T10:51:06.0819241Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0819519Z 
2025-02-21T10:51:06.0819665Z Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T10:51:06.0820085Z Max absolute difference: 1.43452643e-17
2025-02-21T10:51:06.0820480Z Max relative difference: 235.31367318
2025-02-21T10:51:06.0820860Z  x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0821466Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0821828Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T10:51:06.0822200Z  y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0822560Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T10:51:06.0822914Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T10:51:06.0823750Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_spectrum - AssertionError: 
2025-02-21T10:51:06.0824467Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0824757Z 
2025-02-21T10:51:06.0824892Z Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T10:51:06.0825305Z Max absolute difference: 1.96604107e+40
2025-02-21T10:51:06.0825711Z Max relative difference: 97.03021569
2025-02-21T10:51:06.0826184Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0826663Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0827113Z  y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0827589Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0828289Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_virtual_spectrum - AssertionError: 
2025-02-21T10:51:06.0829051Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T10:51:06.0829325Z 
2025-02-21T10:51:06.0829465Z Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T10:51:06.0829865Z Max absolute difference: 4.69537822e+39
2025-02-21T10:51:06.0830264Z Max relative difference: 419.77405263
2025-02-21T10:51:06.0830736Z  x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0831211Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0831642Z  y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T10:51:06.0832107Z        0.000000e+00, 0.000000e+00])
2025-02-21T10:51:06.0832740Z = 6 failed, 1404 passed, 357 skipped, 2 deselected, 19 xfailed, 8 xpassed, 63 warnings in 692.86s (0:11:32) =
2025-02-21T10:51:08.2945381Z ##[error]Process completed with exit code 1.
