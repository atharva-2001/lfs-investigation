2025-02-21T11:56:14.5553630Z ##[group]Run pytest tardis --tardis-regression-data=/Users/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"
2025-02-21T11:56:14.5577010Z [36;1mpytest tardis --tardis-regression-data=/Users/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"[0m
2025-02-21T11:56:14.5674950Z shell: /bin/bash -l {0}
2025-02-21T11:56:14.5675310Z env:
2025-02-21T11:56:14.5675540Z   CACHE_NUMBER: 0
2025-02-21T11:56:14.5676140Z   PYTEST_FLAGS: --tardis-regression-data=/Users/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append
2025-02-21T11:56:14.5676830Z   CODECOV_TOKEN: 
2025-02-21T11:56:14.5677130Z   MAMBA_ROOT_PREFIX: /Users/runner/micromamba
2025-02-21T11:56:14.5677810Z   MAMBA_EXE: /Users/runner/micromamba-bin/micromamba
2025-02-21T11:56:14.5678320Z   CONDARC: /Users/runner/work/_temp/setup-micromamba/.condarc
2025-02-21T11:56:14.5679000Z ##[endgroup]
2025-02-21T11:56:27.4884590Z ============================= test session starts ==============================
2025-02-21T11:56:27.4885770Z platform darwin -- Python 3.12.4, pytest-8.2.2, pluggy-1.5.0
2025-02-21T11:56:27.4886590Z rootdir: /Users/runner/work/tardis/tardis
2025-02-21T11:56:27.4887220Z configfile: pyproject.toml
2025-02-21T11:56:27.4888020Z plugins: cov-5.0.0, html-4.1.1, metadata-3.1.1, doctestplus-1.2.1, anyio-4.4.0
2025-02-21T11:56:27.4888930Z collected 1796 items / 2 deselected / 1794 selected
2025-02-21T11:56:27.4889480Z 
2025-02-21T11:56:31.0235500Z tardis/energy_input/tests/test_energy_source.py ..xxx                    [  0%]
2025-02-21T11:56:32.5863380Z tardis/energy_input/tests/test_gamma_ray_channel.py ...........          [  0%]
2025-02-21T11:56:33.9332930Z tardis/energy_input/tests/test_gamma_ray_grid.py xx.                     [  1%]
2025-02-21T11:56:35.1637880Z tardis/energy_input/tests/test_gamma_ray_interactions.py xx....          [  1%]
2025-02-21T11:56:35.1740350Z tardis/energy_input/tests/test_gamma_ray_packet_source.py sssssssss      [  1%]
2025-02-21T11:56:36.3085160Z tardis/energy_input/tests/test_util.py .....xxxx.....                    [  2%]
2025-02-21T11:56:36.6305190Z tardis/grid/tests/test_grid.py .                                         [  2%]
2025-02-21T11:56:36.6328090Z tardis/gui/tests/test_gui.py s                                           [  2%]
2025-02-21T11:56:39.7099410Z tardis/io/configuration/tests/test_config_reader.py ...........          [  3%]
2025-02-21T11:56:39.7176270Z tardis/io/configuration/tests/test_configuration_namespace.py .........  [  3%]
2025-02-21T11:56:39.7338780Z tardis/io/logger/tests/test_logging.py ssssssssssssssssssssssssssss      [  5%]
2025-02-21T11:57:09.6189360Z tardis/io/model/readers/tests/test_arepo_parser.py ..                    [  5%]
2025-02-21T11:57:09.6391970Z tardis/io/model/readers/tests/test_ascii_readers.py ...                  [  5%]
2025-02-21T11:57:09.6593520Z tardis/io/model/readers/tests/test_cmfgen_reader.py ..                   [  5%]
2025-02-21T11:57:09.6774720Z tardis/io/model/readers/tests/test_csvy_reader.py ....                   [  6%]
2025-02-21T11:57:09.6947810Z tardis/io/model/readers/tests/test_stella_reader.py ..                   [  6%]
2025-02-21T11:57:09.9440580Z tardis/io/tests/test_HDFWriter.py ...............                        [  7%]
2025-02-21T11:57:10.5260700Z tardis/io/tests/test_atomic.py .....                                     [  7%]
2025-02-21T11:57:10.5463120Z tardis/io/tests/test_decay.py ..                                         [  7%]
2025-02-21T11:57:10.7315680Z tardis/io/tests/test_model_reader.py ......                              [  7%]
2025-02-21T11:57:10.7417130Z tardis/model/geometry/tests/test_radial1d.py ..                          [  7%]
2025-02-21T11:57:38.9975810Z tardis/model/tests/test_base.py ........................................ [ 10%]
2025-02-21T11:57:39.7421400Z ............                                                             [ 10%]
2025-02-21T11:57:42.1384100Z tardis/model/tests/test_csvy_model.py .........                          [ 11%]
2025-02-21T11:57:42.1695160Z tardis/model/tests/test_density.py ..                                    [ 11%]
2025-02-21T11:57:43.2833640Z tardis/opacities/tests/test_opacity_solver.py .....                      [ 11%]
2025-02-21T11:57:44.2439530Z tardis/opacities/tests/test_opacity_state_numba.py .....                 [ 11%]
2025-02-21T11:57:46.1861020Z tardis/opacities/tests/test_tau_sobolev.py ..                            [ 12%]
2025-02-21T11:57:48.4147880Z tardis/plasma/equilibrium/tests/test_collisional_transitions.py ...      [ 12%]
2025-02-21T11:58:25.4261340Z tardis/plasma/equilibrium/tests/test_level_populations.py ....           [ 12%]
2025-02-21T11:58:34.6391080Z tardis/plasma/equilibrium/tests/test_rate_matrix.py .                    [ 12%]
2025-02-21T11:58:35.8768150Z tardis/plasma/tests/test_complete_plasmas.py ..............s......s..... [ 13%]
2025-02-21T11:58:38.8024260Z s....ssssss............s......s.....ss.....s....ssssss............s..... [ 18%]
2025-02-21T11:58:40.2619360Z .s.....ss.....s....ssssss............s......s.....ss.....s....ssssss.... [ 22%]
2025-02-21T11:58:42.8880610Z ........s......s.....ss.....s....ssssss............s......s.....ss.....s [ 26%]
2025-02-21T11:58:45.5166110Z ....ssssss............s......s.....ss.....s....ssssss............s...... [ 30%]
2025-02-21T11:58:46.1048870Z s.....ss.....s....ssssss............s......s.....ss.....s.ss.ssssss..... [ 34%]
2025-02-21T11:58:48.5905760Z .......s......s.....ss.....s....ssssss............s......s.....ss.....s. [ 38%]
2025-02-21T11:58:51.5436480Z ...ssssss............s......s.....ss.....s....ssssss............s......s [ 42%]
2025-02-21T11:58:55.2683370Z .....ss.....s....ssssss............s......s.....s...........ssssss...... [ 46%]
2025-02-21T11:58:57.3909840Z ......s......s.....s...........ssssss............s......s.....s......... [ 50%]
2025-02-21T11:59:00.7594120Z ..ssssss............s......s.....ss.....s....ssssss............s......s. [ 54%]
2025-02-21T11:59:05.1572280Z ....ss.....s....ssssss...................s......s.....s....ssss......... [ 58%]
2025-02-21T11:59:05.5427780Z ............s......s.....s....ssss.......                                [ 60%]
2025-02-21T11:59:05.8050030Z tardis/plasma/tests/test_hdf_plasma.py ................................. [ 62%]
2025-02-21T11:59:05.8291680Z ......                                                                   [ 62%]
2025-02-21T11:59:06.2600820Z tardis/plasma/tests/test_nlte_excitation.py ...                          [ 62%]
2025-02-21T12:01:07.8131770Z tardis/plasma/tests/test_nlte_solver.py .....X                           [ 63%]
2025-02-21T12:01:07.8180380Z tardis/plasma/tests/test_plasma_continuum.py .                           [ 63%]
2025-02-21T12:01:28.5819020Z tardis/plasma/tests/test_plasma_vboundary.py .............               [ 63%]
2025-02-21T12:01:39.1374840Z tardis/plasma/tests/test_tardis_model_density_config.py ...              [ 64%]
2025-02-21T12:01:39.6777650Z tardis/simulation/tests/test_convergence.py .....                        [ 64%]
2025-02-21T12:01:46.0074710Z tardis/simulation/tests/test_simulation.py .............                 [ 65%]
2025-02-21T12:01:46.0230570Z tardis/spectrum/tests/test_cuda_formal_integral.py sssssssssssssssssssss [ 66%]
2025-02-21T12:01:46.3103570Z ssss...ssssssssssssssssssssss                                            [ 67%]
2025-02-21T12:01:46.3155140Z tardis/spectrum/tests/test_luminosity.py ....                            [ 68%]
2025-02-21T12:01:47.2571250Z tardis/spectrum/tests/test_numba_formal_integral.py .................... [ 69%]
2025-02-21T12:01:47.2814230Z ..........                                                               [ 69%]
2025-02-21T12:01:47.4477910Z tardis/spectrum/tests/test_spectrum.py ................................. [ 71%]
2025-02-21T12:01:47.4777840Z .........                                                                [ 72%]
2025-02-21T12:01:47.5639350Z tardis/spectrum/tests/test_spectrum_solver.py .FFF                       [ 72%]
2025-02-21T12:02:14.9357980Z tardis/tests/test_tardis_full.py .FFF                                    [ 72%]
2025-02-21T12:03:42.4302890Z tardis/tests/test_tardis_full_formal_integral.py ................        [ 73%]
2025-02-21T12:03:42.4728990Z tardis/tests/test_util.py .............................................  [ 75%]
2025-02-21T12:03:44.4040310Z tardis/transport/montecarlo/tests/test_base.py x.....................    [ 77%]
2025-02-21T12:03:48.5896780Z tardis/transport/montecarlo/tests/test_interaction.py .......            [ 77%]
2025-02-21T12:03:48.7173190Z tardis/transport/montecarlo/tests/test_macro_atom.py ....                [ 77%]
2025-02-21T12:03:48.7275260Z tardis/transport/montecarlo/tests/test_montecarlo.py sssssssssssssssssss [ 78%]
2025-02-21T12:03:48.7492290Z sssssssssssssssssssssssssssssssssssssssssssss                            [ 81%]
2025-02-21T12:03:55.2388760Z tardis/transport/montecarlo/tests/test_montecarlo_main_loop.py x..       [ 81%]
2025-02-21T12:03:55.2484750Z tardis/transport/montecarlo/tests/test_nonhomologous.py ...              [ 81%]
2025-02-21T12:03:57.0296470Z tardis/transport/montecarlo/tests/test_numba_interface.py .....x.        [ 82%]
2025-02-21T12:03:57.3415540Z tardis/transport/montecarlo/tests/test_opacities.py ...............      [ 82%]
2025-02-21T12:03:57.9756210Z tardis/transport/montecarlo/tests/test_packet.py .................xXXXXX [ 84%]
2025-02-21T12:03:58.0598730Z XX.........                                                              [ 84%]
2025-02-21T12:03:58.0814080Z tardis/transport/montecarlo/tests/test_packet_source.py ........         [ 85%]
2025-02-21T12:03:58.2673360Z tardis/transport/montecarlo/tests/test_rpacket_last_interaction_tracker.py . [ 85%]
2025-02-21T12:03:58.5327290Z .....                                                                    [ 85%]
2025-02-21T12:04:07.6784990Z tardis/transport/montecarlo/tests/test_rpacket_tracker.py ......         [ 85%]
2025-02-21T12:04:07.6986680Z tardis/transport/montecarlo/tests/test_single_packet_loop.py xxx         [ 86%]
2025-02-21T12:04:07.7012320Z tardis/transport/montecarlo/tests/test_tracker_utils.py ..               [ 86%]
2025-02-21T12:04:08.7971110Z tardis/transport/montecarlo/tests/test_vpacket.py ..x.                   [ 86%]
2025-02-21T12:04:08.8102760Z tardis/transport/montecarlo/tests/test_weighted_packet_source.py ....    [ 86%]
2025-02-21T12:04:11.1960590Z tardis/transport/montecarlo/tests/test_weighted_packet_source_integration.py . [ 86%]
2025-02-21T12:04:11.1961410Z                                                                          [ 86%]
2025-02-21T12:04:11.9300260Z tardis/transport/tests/test_doppler_factor.py ..................         [ 87%]
2025-02-21T12:04:13.6796880Z tardis/visualization/tools/tests/test_convergence_plot.py .............. [ 88%]
2025-02-21T12:04:15.1521140Z ......                                                                   [ 88%]
2025-02-21T12:04:18.2570570Z tardis/visualization/tools/tests/test_liv_plot.py ...................... [ 90%]
2025-02-21T12:04:21.2009420Z .............................                                            [ 91%]
2025-02-21T12:04:23.8107370Z tardis/visualization/tools/tests/test_rpacket_plot.py .................. [ 92%]
2025-02-21T12:04:31.1967580Z ....                                                                     [ 92%]
2025-02-21T12:04:37.7103320Z tardis/visualization/tools/tests/test_sdec_plot.py ..................... [ 94%]
2025-02-21T12:04:45.8044340Z ..............................                                           [ 95%]
2025-02-21T12:04:46.3367270Z tardis/visualization/widgets/tests/test_custom_abundance.py ........ss.. [ 96%]
2025-02-21T12:04:46.4050460Z ....                                                                     [ 96%]
2025-02-21T12:04:47.4314960Z tardis/visualization/widgets/tests/test_line_info.py ................... [ 97%]
2025-02-21T12:04:48.0132000Z ..................                                                       [ 98%]
2025-02-21T12:07:54.0782950Z tardis/visualization/widgets/tests/test_shell_info.py .................. [ 99%]
2025-02-21T12:08:01.2893730Z ......                                                                   [100%]
2025-02-21T12:08:01.2894300Z 
2025-02-21T12:08:01.2894690Z =================================== FAILURES ===================================
2025-02-21T12:08:01.2895270Z ________________ TestSpectrumSolver.test_spectrum_real_packets _________________
2025-02-21T12:08:01.2895660Z 
2025-02-21T12:08:01.2896030Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x11e281490>
2025-02-21T12:08:01.2897140Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x169dd1fa0>
2025-02-21T12:08:01.2897770Z 
2025-02-21T12:08:01.2898100Z     def test_spectrum_real_packets(self, simulation_regression_data):
2025-02-21T12:08:01.2898680Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:08:01.2899280Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:08:01.2899820Z     
2025-02-21T12:08:01.2900190Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:08:01.2900660Z         result = solver.spectrum_real_packets.luminosity
2025-02-21T12:08:01.2901080Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:08:01.2901510Z         expected = self.get_expected_data(key)
2025-02-21T12:08:01.2901790Z     
2025-02-21T12:08:01.2902100Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:08:01.2902950Z     
2025-02-21T12:08:01.2903520Z >       assert_quantity_allclose(
2025-02-21T12:08:01.2903850Z             result,
2025-02-21T12:08:01.2904060Z             luminosity,
2025-02-21T12:08:01.2904290Z         )
2025-02-21T12:08:01.2904410Z 
2025-02-21T12:08:01.2904580Z tardis/spectrum/tests/test_spectrum_solver.py:61: 
2025-02-21T12:08:01.2904910Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.2905450Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:08:01.2906020Z     np.testing.assert_allclose(
2025-02-21T12:08:01.2906320Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.2906550Z 
2025-02-21T12:08:01.2906980Z args = (<function assert_allclose.<locals>.compare at 0x166878540>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39, .....), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T12:08:01.2907580Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:08:01.2908100Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:08:01.2908440Z 
2025-02-21T12:08:01.2908500Z     @wraps(func)
2025-02-21T12:08:01.2908740Z     def inner(*args, **kwds):
2025-02-21T12:08:01.2909000Z         with self._recreate_cm():
2025-02-21T12:08:01.2909240Z >           return func(*args, **kwds)
2025-02-21T12:08:01.2909550Z E           AssertionError: 
2025-02-21T12:08:01.2909800Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.2910100Z E           
2025-02-21T12:08:01.2910300Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:08:01.2910620Z E           Max absolute difference: 1.94155993e+40
2025-02-21T12:08:01.2910910Z E           Max relative difference: 137.15340685
2025-02-21T12:08:01.2911370Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.2923110Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.2923500Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:08:01.2923820Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.2924010Z 
2025-02-21T12:08:01.2924220Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:08:01.2933250Z ___________ TestSpectrumSolver.test_spectrum_real_packets_reabsorbed ___________
2025-02-21T12:08:01.2933570Z 
2025-02-21T12:08:01.2933850Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x11e2817f0>
2025-02-21T12:08:01.2934440Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x169dd1fa0>
2025-02-21T12:08:01.2934710Z 
2025-02-21T12:08:01.2934920Z     def test_spectrum_real_packets_reabsorbed(self, simulation_regression_data):
2025-02-21T12:08:01.2935450Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:08:01.2935960Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:08:01.2936630Z     
2025-02-21T12:08:01.2936950Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:08:01.2937430Z         result = solver.spectrum_real_packets_reabsorbed.luminosity
2025-02-21T12:08:01.2937860Z         key = "simulation/spectrum_solver/spectrum_real_packets_reabsorbed/luminosity"
2025-02-21T12:08:01.2938330Z         expected = self.get_expected_data(key)
2025-02-21T12:08:01.2938610Z     
2025-02-21T12:08:01.2938880Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:08:01.2939130Z     
2025-02-21T12:08:01.2939350Z >       assert_quantity_allclose(
2025-02-21T12:08:01.2939570Z             result,
2025-02-21T12:08:01.2939820Z             luminosity,
2025-02-21T12:08:01.2940010Z         )
2025-02-21T12:08:01.2940130Z 
2025-02-21T12:08:01.2940280Z tardis/spectrum/tests/test_spectrum_solver.py:77: 
2025-02-21T12:08:01.2940840Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.2941390Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:08:01.2941910Z     np.testing.assert_allclose(
2025-02-21T12:08:01.2942210Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.2942450Z 
2025-02-21T12:08:01.2942860Z args = (<function assert_allclose.<locals>.compare at 0x16657cb80>, array([0., 0., 0., ..., 0., 0., 0.]), array([2.03920412e+38, 3.72882494e+38, 2.29646943e+38, ...,
2025-02-21T12:08:01.2943560Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:08:01.2944000Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:08:01.2944510Z 
2025-02-21T12:08:01.2944730Z     @wraps(func)
2025-02-21T12:08:01.2945040Z     def inner(*args, **kwds):
2025-02-21T12:08:01.2945530Z         with self._recreate_cm():
2025-02-21T12:08:01.2945840Z >           return func(*args, **kwds)
2025-02-21T12:08:01.2946240Z E           AssertionError: 
2025-02-21T12:08:01.2974100Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.2974550Z E           
2025-02-21T12:08:01.2974850Z E           Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T12:08:01.2975210Z E           Max absolute difference: 1.0639846e+40
2025-02-21T12:08:01.2975550Z E           Max relative difference: 122.79315318
2025-02-21T12:08:01.2975880Z E            x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T12:08:01.2976170Z E            y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T12:08:01.2976450Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.2976620Z 
2025-02-21T12:08:01.2976810Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:08:01.2977280Z ________________________ TestSpectrumSolver.test_solve _________________________
2025-02-21T12:08:01.2978290Z 
2025-02-21T12:08:01.2978510Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x11e282060>
2025-02-21T12:08:01.2979010Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x169dd1fa0>
2025-02-21T12:08:01.2979330Z 
2025-02-21T12:08:01.2979440Z     def test_solve(self, simulation_regression_data):
2025-02-21T12:08:01.2980200Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:08:01.2980680Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:08:01.2981020Z     
2025-02-21T12:08:01.2981280Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:08:01.2981640Z         result_real, result_virtual, result_integrated = solver.solve(
2025-02-21T12:08:01.2981940Z             transport_state
2025-02-21T12:08:01.2982130Z         )
2025-02-21T12:08:01.2982420Z         key_real = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:08:01.2982760Z         expected_real = self.get_expected_data(key_real)
2025-02-21T12:08:01.2983000Z     
2025-02-21T12:08:01.2983220Z         luminosity_real = u.Quantity(expected_real, "erg /s")
2025-02-21T12:08:01.2983530Z     
2025-02-21T12:08:01.2983730Z >       assert_quantity_allclose(
2025-02-21T12:08:01.2984020Z             result_real.luminosity,
2025-02-21T12:08:01.2984300Z             luminosity_real,
2025-02-21T12:08:01.2984580Z         )
2025-02-21T12:08:01.2984660Z 
2025-02-21T12:08:01.2984830Z tardis/spectrum/tests/test_spectrum_solver.py:95: 
2025-02-21T12:08:01.2985210Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.2985740Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:08:01.2986270Z     np.testing.assert_allclose(
2025-02-21T12:08:01.2986570Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.2986820Z 
2025-02-21T12:08:01.2987260Z args = (<function assert_allclose.<locals>.compare at 0x16657e2a0>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39, .....), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T12:08:01.2987860Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:08:01.2988360Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:08:01.2988740Z 
2025-02-21T12:08:01.2988850Z     @wraps(func)
2025-02-21T12:08:01.2989040Z     def inner(*args, **kwds):
2025-02-21T12:08:01.2989340Z         with self._recreate_cm():
2025-02-21T12:08:01.2989570Z >           return func(*args, **kwds)
2025-02-21T12:08:01.2989780Z E           AssertionError: 
2025-02-21T12:08:01.2990060Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.2990360Z E           
2025-02-21T12:08:01.2990590Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:08:01.2990970Z E           Max absolute difference: 1.94155993e+40
2025-02-21T12:08:01.2991270Z E           Max relative difference: 137.15340685
2025-02-21T12:08:01.2991650Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.2991940Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.2992310Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:08:01.2992620Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.2992830Z 
2025-02-21T12:08:01.2993170Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:08:01.2993610Z __________________ TestTransportSimple.test_j_blue_estimators __________________
2025-02-21T12:08:01.2994120Z 
2025-02-21T12:08:01.2994340Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x11e282960>
2025-02-21T12:08:01.2994760Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x169dd1fa0>
2025-02-21T12:08:01.2995390Z 
2025-02-21T12:08:01.2995570Z     def test_j_blue_estimators(self, simulation_regression_data):
2025-02-21T12:08:01.2995880Z         key = "simulation/transport/transport_state/j_blue_estimator"
2025-02-21T12:08:01.2996260Z         expected = self.get_expected_data(key)
2025-02-21T12:08:01.2996770Z     
2025-02-21T12:08:01.2996910Z >       npt.assert_allclose(
2025-02-21T12:08:01.2997240Z             simulation_regression_data.transport.transport_state.radfield_mc_estimators.j_blue_estimator,
2025-02-21T12:08:01.2997590Z             expected.values,
2025-02-21T12:08:01.2997760Z         )
2025-02-21T12:08:01.2997840Z 
2025-02-21T12:08:01.2997910Z tardis/tests/test_tardis_full.py:60: 
2025-02-21T12:08:01.2998160Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.2998330Z 
2025-02-21T12:08:01.2998540Z args = (<function assert_allclose.<locals>.compare at 0x11f5cdda0>, array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.2998880Z        [0., 0., 0.,.....,
2025-02-21T12:08:01.2999110Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.2999400Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.2999590Z        [0., 0., 0., ..., 0., 0., 0.]]))
2025-02-21T12:08:01.2999940Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:08:01.3000240Z 
2025-02-21T12:08:01.3000310Z     @wraps(func)
2025-02-21T12:08:01.3000520Z     def inner(*args, **kwds):
2025-02-21T12:08:01.3000720Z         with self._recreate_cm():
2025-02-21T12:08:01.3000930Z >           return func(*args, **kwds)
2025-02-21T12:08:01.3001130Z E           AssertionError: 
2025-02-21T12:08:01.3001340Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3001560Z E           
2025-02-21T12:08:01.3001860Z E           Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T12:08:01.3002150Z E           Max absolute difference: 1.43452643e-17
2025-02-21T12:08:01.3002510Z E           Max relative difference: 235.31367318
2025-02-21T12:08:01.3002860Z E            x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.3003200Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.3003530Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:08:01.3003800Z E            y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.3004070Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.3004350Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:08:01.3004550Z 
2025-02-21T12:08:01.3004790Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:08:01.3005230Z ______________________ TestTransportSimple.test_spectrum _______________________
2025-02-21T12:08:01.3005490Z 
2025-02-21T12:08:01.3005720Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x11e282c60>
2025-02-21T12:08:01.3006250Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x169dd1fa0>
2025-02-21T12:08:01.3006570Z 
2025-02-21T12:08:01.3006720Z     def test_spectrum(self, simulation_regression_data):
2025-02-21T12:08:01.3007100Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:08:01.3007550Z         expected = self.get_expected_data(key)
2025-02-21T12:08:01.3007840Z     
2025-02-21T12:08:01.3008100Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:08:01.3008310Z     
2025-02-21T12:08:01.3008450Z >       assert_quantity_allclose(
2025-02-21T12:08:01.3008750Z             simulation_regression_data.spectrum_solver.spectrum_real_packets.luminosity,
2025-02-21T12:08:01.3009060Z             luminosity,
2025-02-21T12:08:01.3009260Z         )
2025-02-21T12:08:01.3009330Z 
2025-02-21T12:08:01.3009410Z tardis/tests/test_tardis_full.py:71: 
2025-02-21T12:08:01.3009650Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.3010450Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:08:01.3011010Z     np.testing.assert_allclose(
2025-02-21T12:08:01.3011240Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.3011410Z 
2025-02-21T12:08:01.3011790Z args = (<function assert_allclose.<locals>.compare at 0x166879760>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39, .....), array([1.47119190e+39, 1.69564189e+39, 1.35368464e+39, ...,
2025-02-21T12:08:01.3012610Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:08:01.3012980Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:08:01.3013250Z 
2025-02-21T12:08:01.3013300Z     @wraps(func)
2025-02-21T12:08:01.3013460Z     def inner(*args, **kwds):
2025-02-21T12:08:01.3013650Z         with self._recreate_cm():
2025-02-21T12:08:01.3013840Z >           return func(*args, **kwds)
2025-02-21T12:08:01.3014050Z E           AssertionError: 
2025-02-21T12:08:01.3014330Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3014590Z E           
2025-02-21T12:08:01.3014820Z E           Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T12:08:01.3015090Z E           Max absolute difference: 1.96604107e+40
2025-02-21T12:08:01.3015320Z E           Max relative difference: 97.03021569
2025-02-21T12:08:01.3015690Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3015960Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3016340Z E            y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3016690Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3016830Z 
2025-02-21T12:08:01.3016990Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:08:01.3017370Z __________________ TestTransportSimple.test_virtual_spectrum ___________________
2025-02-21T12:08:01.3017590Z 
2025-02-21T12:08:01.3017760Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x11e282f30>
2025-02-21T12:08:01.3018170Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x169dd1fa0>
2025-02-21T12:08:01.3018430Z 
2025-02-21T12:08:01.3018550Z     def test_virtual_spectrum(self, simulation_regression_data):
2025-02-21T12:08:01.3018880Z         key = "simulation/spectrum_solver/spectrum_virtual_packets/luminosity"
2025-02-21T12:08:01.3019180Z         expected = self.get_expected_data(key)
2025-02-21T12:08:01.3019370Z     
2025-02-21T12:08:01.3019520Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:08:01.3019720Z     
2025-02-21T12:08:01.3020760Z >       assert_quantity_allclose(
2025-02-21T12:08:01.3021110Z             simulation_regression_data.spectrum_solver.spectrum_virtual_packets.luminosity,
2025-02-21T12:08:01.3021420Z             luminosity,
2025-02-21T12:08:01.3021580Z         )
2025-02-21T12:08:01.3021660Z 
2025-02-21T12:08:01.3021730Z tardis/tests/test_tardis_full.py:82: 
2025-02-21T12:08:01.3021970Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.3022420Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:08:01.3022910Z     np.testing.assert_allclose(
2025-02-21T12:08:01.3023130Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:08:01.3023300Z 
2025-02-21T12:08:01.3023670Z args = (<function assert_allclose.<locals>.compare at 0x16657f060>, array([1.31895331e+39, 2.31381538e+39, 3.72000430e+39, .....), array([1.44033177e+39, 1.35611403e+39, 1.39755698e+39, ...,
2025-02-21T12:08:01.3024190Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:08:01.3024550Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:08:01.3025180Z 
2025-02-21T12:08:01.3025230Z     @wraps(func)
2025-02-21T12:08:01.3025390Z     def inner(*args, **kwds):
2025-02-21T12:08:01.3025570Z         with self._recreate_cm():
2025-02-21T12:08:01.3025780Z >           return func(*args, **kwds)
2025-02-21T12:08:01.3025970Z E           AssertionError: 
2025-02-21T12:08:01.3026180Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3026600Z E           
2025-02-21T12:08:01.3026760Z E           Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T12:08:01.3026990Z E           Max absolute difference: 4.69537822e+39
2025-02-21T12:08:01.3027220Z E           Max relative difference: 419.77405263
2025-02-21T12:08:01.3027490Z E            x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3027760Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3028020Z E            y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3028280Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3028420Z 
2025-02-21T12:08:01.3028590Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:08:01.3028920Z =============================== warnings summary ===============================
2025-02-21T12:08:01.3029180Z tardis/io/configuration/config_validator.py:6
2025-02-21T12:08:01.3029430Z tardis/io/configuration/config_validator.py:6
2025-02-21T12:08:01.3029840Z   /Users/runner/work/tardis/tardis/tardis/io/configuration/config_validator.py:6: DeprecationWarning:
2025-02-21T12:08:01.3030290Z   
2025-02-21T12:08:01.3031270Z   jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
2025-02-21T12:08:01.3032280Z 
2025-02-21T12:08:01.3032480Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22
2025-02-21T12:08:01.3033030Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22: DeprecationWarning:
2025-02-21T12:08:01.3033440Z   
2025-02-21T12:08:01.3033630Z   Jupyter is migrating its paths to use standard platformdirs
2025-02-21T12:08:01.3033960Z   given by the platformdirs library.  To remove this warning and
2025-02-21T12:08:01.3034290Z   see the appropriate new directories, set the environment variable
2025-02-21T12:08:01.3034690Z   `JUPYTER_PLATFORM_DIRS=1` and then run `jupyter --paths`.
2025-02-21T12:08:01.3035010Z   The use of platformdirs will be the default in `jupyter_core` v6
2025-02-21T12:08:01.3035220Z 
2025-02-21T12:08:01.3041250Z tardis/io/tests/test_HDFWriter.py::test_multi_index_write
2025-02-21T12:08:01.3041700Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:08:01.3042170Z   /Users/runner/work/tardis/tardis/tardis/io/util.py:276: PerformanceWarning:
2025-02-21T12:08:01.3042460Z   
2025-02-21T12:08:01.3042580Z   
2025-02-21T12:08:01.3042820Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:08:01.3043280Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T12:08:01.3043570Z 
2025-02-21T12:08:01.3043740Z tardis/io/tests/test_model_reader.py::test_read_cmfgen_isotope_abundances
2025-02-21T12:08:01.3044140Z tardis/plasma/tests/test_tardis_model_density_config.py::test_electron_densities
2025-02-21T12:08:01.3044660Z tardis/plasma/tests/test_tardis_model_density_config.py::test_isotope_number_densities
2025-02-21T12:08:01.3045070Z tardis/plasma/tests/test_tardis_model_density_config.py::test_t_rad
2025-02-21T12:08:01.3045540Z   /Users/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:82: DeprecationWarning:
2025-02-21T12:08:01.3046730Z   
2025-02-21T12:08:01.3046880Z   The current CMFGEN model parser is deprecated
2025-02-21T12:08:01.3047040Z 
2025-02-21T12:08:01.3047140Z tardis/io/tests/test_model_reader.py: 1 warning
2025-02-21T12:08:01.3047430Z tardis/plasma/tests/test_tardis_model_density_config.py: 9 warnings
2025-02-21T12:08:01.3047890Z   /Users/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:40: DeprecationWarning:
2025-02-21T12:08:01.3048710Z   
2025-02-21T12:08:01.3048870Z   The current CMFGEN model parser is deprecated
2025-02-21T12:08:01.3049020Z 
2025-02-21T12:08:01.3049200Z tardis/model/tests/test_base.py::TestModelFromPaper1Config::test_abundances
2025-02-21T12:08:01.3049730Z   /Users/runner/work/tardis/tardis/tardis/transport/montecarlo/montecarlo_main_loop.py:123: NumbaTypeSafetyWarning:
2025-02-21T12:08:01.3050150Z   
2025-02-21T12:08:01.3053340Z   [1m[1m[1munsafe cast from uint64 to int64. Precision may be lost.[0m[0m[0m
2025-02-21T12:08:01.3053580Z 
2025-02-21T12:08:01.3053660Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T12:08:01.3053910Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T12:08:01.3054210Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T12:08:01.3054640Z   /Users/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:50: DeprecationWarning:
2025-02-21T12:08:01.3054980Z   
2025-02-21T12:08:01.3055140Z   v_inner_boundary < 0, assuming default value
2025-02-21T12:08:01.3055290Z 
2025-02-21T12:08:01.3055370Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T12:08:01.3055600Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T12:08:01.3055900Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T12:08:01.3056320Z   /Users/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:61: DeprecationWarning:
2025-02-21T12:08:01.3056660Z   
2025-02-21T12:08:01.3056800Z   v_outer_boundary < 0, assuming default value
2025-02-21T12:08:01.3056960Z 
2025-02-21T12:08:01.3057320Z tardis/plasma/equilibrium/tests/test_level_populations.py::TestLevelPopulationSolver::test_solve[collisional_rate_solver0-radiative_transitions0]
2025-02-21T12:08:01.3057990Z   /Users/runner/work/tardis/tardis/tardis/plasma/equilibrium/level_populations.py:65: FutureWarning:
2025-02-21T12:08:01.3058350Z   
2025-02-21T12:08:01.3058640Z   A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
2025-02-21T12:08:01.3059290Z   The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
2025-02-21T12:08:01.3059750Z   
2025-02-21T12:08:01.3060240Z   For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
2025-02-21T12:08:01.3060730Z 
2025-02-21T12:08:01.3060910Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3750]
2025-02-21T12:08:01.3061340Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3850]
2025-02-21T12:08:01.3061740Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3900]
2025-02-21T12:08:01.3062170Z   /Users/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:71: UserWarning:
2025-02-21T12:08:01.3062470Z   
2025-02-21T12:08:01.3062700Z   Requesting inner boundary below inner shell. Extrapolating the inner cell
2025-02-21T12:08:01.3062930Z 
2025-02-21T12:08:01.3063110Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T12:08:01.3063520Z   /Users/runner/work/tardis/tardis/tardis/spectrum/base.py:70: UserWarning:
2025-02-21T12:08:01.3063800Z   
2025-02-21T12:08:01.3064710Z   SpectrumSolver.spectrum_virtual_packets is zero. Please run the montecarlo simulation with no_of_virtual_packets > 0
2025-02-21T12:08:01.3065060Z 
2025-02-21T12:08:01.3065250Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T12:08:01.3065990Z   /Users/runner/work/tardis/tardis/tardis/spectrum/base.py:111: UserWarning:
2025-02-21T12:08:01.3066270Z   
2025-02-21T12:08:01.3066630Z   SpectrumSolver.integrator: The FormalIntegrator is not yet available.Please run the montecarlo simulation at least once.
2025-02-21T12:08:01.3066980Z 
2025-02-21T12:08:01.3067170Z tardis/transport/montecarlo/tests/test_vpacket.py::test_trace_vpacket_volley
2025-02-21T12:08:01.3067740Z   <string>:3: NumbaPendingDeprecationWarning:
2025-02-21T12:08:01.3067950Z   
2025-02-21T12:08:01.3068900Z   [1m[1mCode using Numba extension API maybe depending on 'old_style' error-capturing, which is deprecated and will be replaced by 'new_style' in a future release. See details at https://numba.readthedocs.io/en/latest/reference/deprecation.html#deprecation-of-old-style-numba-captured-errors
2025-02-21T12:08:01.3069750Z   Exception origin:
2025-02-21T12:08:01.3070060Z     File "/Users/runner/micromamba/envs/tardis/lib/python3.12/inspect.py", line 3180, in _bind
2025-02-21T12:08:01.3070410Z       raise TypeError(msg) from None
2025-02-21T12:08:01.3070610Z   [0m[0m
2025-02-21T12:08:01.3070700Z 
2025-02-21T12:08:01.3070970Z tardis/visualization/tools/tests/test_sdec_plot.py::TestSDECPlotter::test_mpl_image[plotter_generate_plot_mpl4]
2025-02-21T12:08:01.3071530Z   /Users/runner/work/tardis/tardis/tardis/visualization/tools/sdec_plot.py:1225: RuntimeWarning:
2025-02-21T12:08:01.3071890Z   
2025-02-21T12:08:01.3072630Z   More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
2025-02-21T12:08:01.3073350Z 
2025-02-21T12:08:01.3073640Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3074270Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3075320Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3076050Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3076760Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3077620Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3078320Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:08:01.3086090Z   
2025-02-21T12:08:01.3086330Z   Passing unrecognized arguments to super(Checkbox).__init__(icon='lock').
2025-02-21T12:08:01.3086710Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:08:01.3087120Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:08:01.3087380Z 
2025-02-21T12:08:01.3087680Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3088310Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3088950Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:08:01.3089340Z   
2025-02-21T12:08:01.3089610Z   Passing unrecognized arguments to super(FloatText).__init__(min=0).
2025-02-21T12:08:01.3089980Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:08:01.3090380Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:08:01.3090950Z 
2025-02-21T12:08:01.3091240Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:08:01.3091860Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:08:01.3092260Z   
2025-02-21T12:08:01.3092480Z   Passing unrecognized arguments to super(HTML).__init__(indent=True).
2025-02-21T12:08:01.3093060Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:08:01.3093470Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:08:01.3093730Z 
2025-02-21T12:08:01.3094080Z tardis/visualization/widgets/tests/test_line_info.py::TestLineInfoWidgetData::test_get_species_interactions[wavelength_range0-packet_out_nu]
2025-02-21T12:08:01.3094740Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/qgridnext/grid.py:820: DeprecationWarning:
2025-02-21T12:08:01.3095120Z   
2025-02-21T12:08:01.3095410Z   QgridWidget._precision_changed is deprecated in traitlets 4.1: use @observe and @unobserve instead.
2025-02-21T12:08:01.3095700Z 
2025-02-21T12:08:01.3095930Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:08:01.3096380Z   /Users/runner/work/tardis/tardis/tardis/io/util.py:289: PerformanceWarning:
2025-02-21T12:08:01.3096690Z   
2025-02-21T12:08:01.3096810Z   
2025-02-21T12:08:01.3097040Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:08:01.3097500Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T12:08:01.3097790Z 
2025-02-21T12:08:01.3097990Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:08:01.3098450Z   /Users/runner/work/tardis/tardis/tardis/io/util.py:292: PerformanceWarning:
2025-02-21T12:08:01.3098750Z   
2025-02-21T12:08:01.3098870Z   
2025-02-21T12:08:01.3099100Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:08:01.3099470Z   map directly to c-types [inferred_type->mixed,key->values] [items->None]
2025-02-21T12:08:01.3099690Z 
2025-02-21T12:08:01.3099890Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:08:01.3100370Z   /Users/runner/work/tardis/tardis/tardis/spectrum/formal_integral.py:398: UserWarning:
2025-02-21T12:08:01.3100690Z   
2025-02-21T12:08:01.3100910Z   The number of interpolate_shells was not specified. The value was set to 80.
2025-02-21T12:08:01.3101140Z 
2025-02-21T12:08:01.3101300Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-02-21T12:08:01.3101520Z 
2025-02-21T12:08:01.3101660Z ---------- coverage: platform darwin, python 3.12.4-final-0 ----------
2025-02-21T12:08:01.3101950Z Coverage HTML written to dir coverage_html_report
2025-02-21T12:08:01.3102180Z Coverage XML written to file coverage.xml
2025-02-21T12:08:01.3102340Z 
2025-02-21T12:08:01.3102440Z =========================== short test summary info ============================
2025-02-21T12:08:01.3102900Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets - AssertionError: 
2025-02-21T12:08:01.3103320Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3103470Z 
2025-02-21T12:08:01.3103540Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:08:01.3103760Z Max absolute difference: 1.94155993e+40
2025-02-21T12:08:01.3103970Z Max relative difference: 137.15340685
2025-02-21T12:08:01.3104220Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3104470Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3104710Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:08:01.3104960Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3105400Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets_reabsorbed - AssertionError: 
2025-02-21T12:08:01.3105930Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3106080Z 
2025-02-21T12:08:01.3106150Z Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T12:08:01.3106360Z Max absolute difference: 1.0639846e+40
2025-02-21T12:08:01.3106570Z Max relative difference: 122.79315318
2025-02-21T12:08:01.3106880Z  x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T12:08:01.3107130Z  y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T12:08:01.3107390Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3107740Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve - AssertionError: 
2025-02-21T12:08:01.3108140Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3108290Z 
2025-02-21T12:08:01.3108360Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:08:01.3108570Z Max absolute difference: 1.94155993e+40
2025-02-21T12:08:01.3108780Z Max relative difference: 137.15340685
2025-02-21T12:08:01.3109030Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3109290Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3109530Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:08:01.3109780Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3110150Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_j_blue_estimators - AssertionError: 
2025-02-21T12:08:01.3110530Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3110670Z 
2025-02-21T12:08:01.3110750Z Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T12:08:01.3110970Z Max absolute difference: 1.43452643e-17
2025-02-21T12:08:01.3111180Z Max relative difference: 235.31367318
2025-02-21T12:08:01.3111390Z  x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.3111580Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.3111760Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:08:01.3111960Z  y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.3112150Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:08:01.3112340Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:08:01.3112670Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_spectrum - AssertionError: 
2025-02-21T12:08:01.3113020Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3113170Z 
2025-02-21T12:08:01.3113240Z Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T12:08:01.3113450Z Max absolute difference: 1.96604107e+40
2025-02-21T12:08:01.3113660Z Max relative difference: 97.03021569
2025-02-21T12:08:01.3113910Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3114150Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3114390Z  y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3114740Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3115100Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_virtual_spectrum - AssertionError: 
2025-02-21T12:08:01.3115470Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:08:01.3115620Z 
2025-02-21T12:08:01.3115690Z Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T12:08:01.3115890Z Max absolute difference: 4.69537822e+39
2025-02-21T12:08:01.3116100Z Max relative difference: 419.77405263
2025-02-21T12:08:01.3116350Z  x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3116600Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3116840Z  y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T12:08:01.3117080Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:08:01.3117410Z = 6 failed, 1404 passed, 357 skipped, 2 deselected, 19 xfailed, 8 xpassed, 63 warnings in 695.22s (0:11:35) =
2025-02-21T12:08:03.0183390Z ##[error]Process completed with exit code 1.
