2025-02-21T12:39:30.1984296Z ##[group]Run pytest tardis --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"
2025-02-21T12:39:30.1985770Z [36;1mpytest tardis --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"[0m
2025-02-21T12:39:30.2040566Z shell: /usr/bin/bash -l {0}
2025-02-21T12:39:30.2040809Z env:
2025-02-21T12:39:30.2040990Z   CACHE_NUMBER: 0
2025-02-21T12:39:30.2041623Z   PYTEST_FLAGS: --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append
2025-02-21T12:39:30.2042301Z   CODECOV_TOKEN: 
2025-02-21T12:39:30.2042525Z   MAMBA_ROOT_PREFIX: /home/runner/micromamba
2025-02-21T12:39:30.2042828Z   MAMBA_EXE: /home/runner/micromamba-bin/micromamba
2025-02-21T12:39:30.2043181Z   CONDARC: /home/runner/work/_temp/setup-micromamba/.condarc
2025-02-21T12:39:30.2043525Z ##[endgroup]
2025-02-21T12:39:38.6741064Z ============================= test session starts ==============================
2025-02-21T12:39:38.6741866Z platform linux -- Python 3.12.4, pytest-8.2.2, pluggy-1.5.0
2025-02-21T12:39:38.6742551Z rootdir: /home/runner/work/tardis/tardis
2025-02-21T12:39:38.6743047Z configfile: pyproject.toml
2025-02-21T12:39:38.6743626Z plugins: metadata-3.1.1, anyio-4.4.0, doctestplus-1.2.1, cov-5.0.0, html-4.1.1
2025-02-21T12:39:38.6744301Z collected 1796 items / 2 deselected / 1794 selected
2025-02-21T12:39:38.6744668Z 
2025-02-21T12:39:43.6703492Z tardis/energy_input/tests/test_energy_source.py ..xxx                    [  0%]
2025-02-21T12:39:46.5142722Z tardis/energy_input/tests/test_gamma_ray_channel.py ...........          [  0%]
2025-02-21T12:39:48.0945979Z tardis/energy_input/tests/test_gamma_ray_grid.py xx.                     [  1%]
2025-02-21T12:39:49.8565701Z tardis/energy_input/tests/test_gamma_ray_interactions.py xx....          [  1%]
2025-02-21T12:39:49.8658227Z tardis/energy_input/tests/test_gamma_ray_packet_source.py sssssssss      [  1%]
2025-02-21T12:39:51.1498018Z tardis/energy_input/tests/test_util.py .....xxxx.....                    [  2%]
2025-02-21T12:39:51.4901643Z tardis/grid/tests/test_grid.py .                                         [  2%]
2025-02-21T12:39:51.4916735Z tardis/gui/tests/test_gui.py s                                           [  2%]
2025-02-21T12:39:55.0660254Z tardis/io/configuration/tests/test_config_reader.py ...........          [  3%]
2025-02-21T12:39:55.0788174Z tardis/io/configuration/tests/test_configuration_namespace.py .........  [  3%]
2025-02-21T12:39:55.1060440Z tardis/io/logger/tests/test_logging.py ssssssssssssssssssssssssssss      [  5%]
2025-02-21T12:40:32.3445543Z tardis/io/model/readers/tests/test_arepo_parser.py ..                    [  5%]
2025-02-21T12:40:32.3591875Z tardis/io/model/readers/tests/test_ascii_readers.py ...                  [  5%]
2025-02-21T12:40:32.3706119Z tardis/io/model/readers/tests/test_cmfgen_reader.py ..                   [  5%]
2025-02-21T12:40:32.4016215Z tardis/io/model/readers/tests/test_csvy_reader.py ....                   [  6%]
2025-02-21T12:40:32.4218137Z tardis/io/model/readers/tests/test_stella_reader.py ..                   [  6%]
2025-02-21T12:40:32.7294654Z tardis/io/tests/test_HDFWriter.py ...............                        [  7%]
2025-02-21T12:40:33.0351452Z tardis/io/tests/test_atomic.py .....                                     [  7%]
2025-02-21T12:40:33.0542224Z tardis/io/tests/test_decay.py ..                                         [  7%]
2025-02-21T12:40:33.2501546Z tardis/io/tests/test_model_reader.py ......                              [  7%]
2025-02-21T12:40:33.2568178Z tardis/model/geometry/tests/test_radial1d.py ..                          [  7%]
2025-02-21T12:41:31.5192451Z tardis/model/tests/test_base.py ........................................ [ 10%]
2025-02-21T12:41:32.5154656Z ............                                                             [ 10%]
2025-02-21T12:41:35.5978753Z tardis/model/tests/test_csvy_model.py .........                          [ 11%]
2025-02-21T12:41:35.6461477Z tardis/model/tests/test_density.py ..                                    [ 11%]
2025-02-21T12:41:36.9337344Z tardis/opacities/tests/test_opacity_solver.py .....                      [ 11%]
2025-02-21T12:41:38.2675865Z tardis/opacities/tests/test_opacity_state_numba.py .....                 [ 11%]
2025-02-21T12:41:39.8638809Z tardis/opacities/tests/test_tau_sobolev.py ..                            [ 12%]
2025-02-21T12:41:42.9273083Z tardis/plasma/equilibrium/tests/test_collisional_transitions.py ...      [ 12%]
2025-02-21T12:42:28.7319776Z tardis/plasma/equilibrium/tests/test_level_populations.py ....           [ 12%]
2025-02-21T12:42:40.2387371Z tardis/plasma/equilibrium/tests/test_rate_matrix.py .                    [ 12%]
2025-02-21T12:42:41.6656320Z tardis/plasma/tests/test_complete_plasmas.py ..............s......s..... [ 13%]
2025-02-21T12:42:44.5323861Z s....ssssss............s......s.....ss.....s....ssssss............s..... [ 18%]
2025-02-21T12:42:46.4992512Z .s.....ss.....s....ssssss............s......s.....ss.....s....ssssss.... [ 22%]
2025-02-21T12:42:49.3801786Z ........s......s.....ss.....s....ssssss............s......s.....ss.....s [ 26%]
2025-02-21T12:42:52.2282990Z ....ssssss............s......s.....ss.....s....ssssss............s...... [ 30%]
2025-02-21T12:42:52.9347615Z s.....ss.....s....ssssss............s......s.....ss.....s.ss.ssssss..... [ 34%]
2025-02-21T12:42:55.7790430Z .......s......s.....ss.....s....ssssss............s......s.....ss.....s. [ 38%]
2025-02-21T12:42:58.9300905Z ...ssssss............s......s.....ss.....s....ssssss............s......s [ 42%]
2025-02-21T12:43:01.9860430Z .....ss.....s....ssssss............s......s.....s...........ssssss...... [ 46%]
2025-02-21T12:43:03.7767214Z ......s......s.....s...........ssssss............s......s.....s......... [ 50%]
2025-02-21T12:43:06.6737194Z ..ssssss............s......s.....ss.....s....ssssss............s......s. [ 54%]
2025-02-21T12:43:10.1485660Z ....ss.....s....ssssss...................s......s.....s....ssss......... [ 58%]
2025-02-21T12:43:10.4389110Z ............s......s.....s....ssss.......                                [ 60%]
2025-02-21T12:43:10.5500845Z tardis/plasma/tests/test_hdf_plasma.py ................................. [ 62%]
2025-02-21T12:43:10.5618357Z ......                                                                   [ 62%]
2025-02-21T12:43:10.7002717Z tardis/plasma/tests/test_nlte_excitation.py ...                          [ 62%]
2025-02-21T12:45:27.1407070Z tardis/plasma/tests/test_nlte_solver.py .....X                           [ 63%]
2025-02-21T12:45:27.1431945Z tardis/plasma/tests/test_plasma_continuum.py .                           [ 63%]
2025-02-21T12:45:50.5059995Z tardis/plasma/tests/test_plasma_vboundary.py .............               [ 63%]
2025-02-21T12:46:03.5691602Z tardis/plasma/tests/test_tardis_model_density_config.py ...              [ 64%]
2025-02-21T12:46:04.3194414Z tardis/simulation/tests/test_convergence.py .....                        [ 64%]
2025-02-21T12:46:12.7568718Z tardis/simulation/tests/test_simulation.py .............                 [ 65%]
2025-02-21T12:46:12.7769242Z tardis/spectrum/tests/test_cuda_formal_integral.py sssssssssssssssssssss [ 66%]
2025-02-21T12:46:13.2499049Z ssss...ssssssssssssssssssssss                                            [ 67%]
2025-02-21T12:46:13.2571641Z tardis/spectrum/tests/test_luminosity.py ....                            [ 68%]
2025-02-21T12:46:14.8489215Z tardis/spectrum/tests/test_numba_formal_integral.py .................... [ 69%]
2025-02-21T12:46:14.8686955Z ..........                                                               [ 69%]
2025-02-21T12:46:15.0538366Z tardis/spectrum/tests/test_spectrum.py ................................. [ 71%]
2025-02-21T12:46:15.0885992Z .........                                                                [ 72%]
2025-02-21T12:46:15.1714262Z tardis/spectrum/tests/test_spectrum_solver.py .FFF                       [ 72%]
2025-02-21T12:46:46.6603382Z tardis/tests/test_tardis_full.py .FFF                                    [ 72%]
2025-02-21T12:48:10.9675518Z tardis/tests/test_tardis_full_formal_integral.py ................        [ 73%]
2025-02-21T12:48:11.0417733Z tardis/tests/test_util.py .............................................  [ 75%]
2025-02-21T12:48:13.6826360Z tardis/transport/montecarlo/tests/test_base.py x.....................    [ 77%]
2025-02-21T12:48:20.9518079Z tardis/transport/montecarlo/tests/test_interaction.py .......            [ 77%]
2025-02-21T12:48:21.1801238Z tardis/transport/montecarlo/tests/test_macro_atom.py ....                [ 77%]
2025-02-21T12:48:21.1975534Z tardis/transport/montecarlo/tests/test_montecarlo.py sssssssssssssssssss [ 78%]
2025-02-21T12:48:21.2393090Z sssssssssssssssssssssssssssssssssssssssssssss                            [ 81%]
2025-02-21T12:48:30.5478069Z tardis/transport/montecarlo/tests/test_montecarlo_main_loop.py x..       [ 81%]
2025-02-21T12:48:30.5556526Z tardis/transport/montecarlo/tests/test_nonhomologous.py ...              [ 81%]
2025-02-21T12:48:36.4085797Z tardis/transport/montecarlo/tests/test_numba_interface.py .....x.        [ 82%]
2025-02-21T12:48:36.8891051Z tardis/transport/montecarlo/tests/test_opacities.py ...............      [ 82%]
2025-02-21T12:48:37.9318757Z tardis/transport/montecarlo/tests/test_packet.py .................xXXXXX [ 84%]
2025-02-21T12:48:38.0684366Z XX.........                                                              [ 84%]
2025-02-21T12:48:38.0963393Z tardis/transport/montecarlo/tests/test_packet_source.py ........         [ 85%]
2025-02-21T12:48:38.4273485Z tardis/transport/montecarlo/tests/test_rpacket_last_interaction_tracker.py . [ 85%]
2025-02-21T12:48:38.8448946Z .....                                                                    [ 85%]
2025-02-21T12:49:14.1152750Z tardis/transport/montecarlo/tests/test_rpacket_tracker.py ......         [ 85%]
2025-02-21T12:49:14.1439605Z tardis/transport/montecarlo/tests/test_single_packet_loop.py xxx         [ 86%]
2025-02-21T12:49:14.1472139Z tardis/transport/montecarlo/tests/test_tracker_utils.py ..               [ 86%]
2025-02-21T12:49:16.6207799Z tardis/transport/montecarlo/tests/test_vpacket.py ..x.                   [ 86%]
2025-02-21T12:49:16.6379998Z tardis/transport/montecarlo/tests/test_weighted_packet_source.py ....    [ 86%]
2025-02-21T12:49:20.0282418Z tardis/transport/montecarlo/tests/test_weighted_packet_source_integration.py . [ 86%]
2025-02-21T12:49:20.0284596Z                                                                          [ 86%]
2025-02-21T12:49:20.7789063Z tardis/transport/tests/test_doppler_factor.py ..................         [ 87%]
2025-02-21T12:49:22.5776133Z tardis/visualization/tools/tests/test_convergence_plot.py .............. [ 88%]
2025-02-21T12:49:24.8084669Z ......                                                                   [ 88%]
2025-02-21T12:49:29.5138299Z tardis/visualization/tools/tests/test_liv_plot.py ...................... [ 90%]
2025-02-21T12:49:32.2238552Z .............................                                            [ 91%]
2025-02-21T12:49:35.0708236Z tardis/visualization/tools/tests/test_rpacket_plot.py .................. [ 92%]
2025-02-21T12:49:42.0652788Z ....                                                                     [ 92%]
2025-02-21T12:49:48.0715075Z tardis/visualization/tools/tests/test_sdec_plot.py ..................... [ 94%]
2025-02-21T12:49:56.1972995Z ..............................                                           [ 95%]
2025-02-21T12:49:56.6401855Z tardis/visualization/widgets/tests/test_custom_abundance.py ........ss.. [ 96%]
2025-02-21T12:49:56.7108922Z ....                                                                     [ 96%]
2025-02-21T12:49:57.7569689Z tardis/visualization/widgets/tests/test_line_info.py ................... [ 97%]
2025-02-21T12:49:58.3835506Z ..................                                                       [ 98%]
2025-02-21T12:51:01.7024781Z tardis/visualization/widgets/tests/test_shell_info.py .................. [ 99%]
2025-02-21T12:51:10.3095933Z ......                                                                   [100%]
2025-02-21T12:51:10.3098008Z 
2025-02-21T12:51:10.3098419Z =================================== FAILURES ===================================
2025-02-21T12:51:10.3099318Z ________________ TestSpectrumSolver.test_spectrum_real_packets _________________
2025-02-21T12:51:10.3099672Z 
2025-02-21T12:51:10.3100106Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7f61468acbf0>
2025-02-21T12:51:10.3101128Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7f6140182090>
2025-02-21T12:51:10.3102478Z 
2025-02-21T12:51:10.3102785Z     def test_spectrum_real_packets(self, simulation_regression_data):
2025-02-21T12:51:10.3103540Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:51:10.3104412Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:51:10.3105081Z     
2025-02-21T12:51:10.3105408Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:51:10.3105820Z         result = solver.spectrum_real_packets.luminosity
2025-02-21T12:51:10.3106200Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:51:10.3106560Z         expected = self.get_expected_data(key)
2025-02-21T12:51:10.3106808Z     
2025-02-21T12:51:10.3107001Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:51:10.3107252Z     
2025-02-21T12:51:10.3107615Z >       assert_quantity_allclose(
2025-02-21T12:51:10.3107867Z             result,
2025-02-21T12:51:10.3108053Z             luminosity,
2025-02-21T12:51:10.3108244Z         )
2025-02-21T12:51:10.3108343Z 
2025-02-21T12:51:10.3108471Z tardis/spectrum/tests/test_spectrum_solver.py:61: 
2025-02-21T12:51:10.3108795Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3109355Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:10.3109883Z     np.testing.assert_allclose(
2025-02-21T12:51:10.3110147Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3110350Z 
2025-02-21T12:51:10.3110827Z args = (<function assert_allclose.<locals>.compare at 0x7f6115387ba0>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T12:51:10.3111486Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:10.3111910Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:10.3112235Z 
2025-02-21T12:51:10.3112313Z     @wraps(func)
2025-02-21T12:51:10.3112506Z     def inner(*args, **kwds):
2025-02-21T12:51:10.3112733Z         with self._recreate_cm():
2025-02-21T12:51:10.3112977Z >           return func(*args, **kwds)
2025-02-21T12:51:10.3113229Z E           AssertionError: 
2025-02-21T12:51:10.3113472Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3113733Z E           
2025-02-21T12:51:10.3113932Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:51:10.3114205Z E           Max absolute difference: 1.94155993e+40
2025-02-21T12:51:10.3114477Z E           Max relative difference: 137.15340685
2025-02-21T12:51:10.3114796Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3115119Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3115422Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:51:10.3115739Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3115902Z 
2025-02-21T12:51:10.3116106Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:10.3116862Z ___________ TestSpectrumSolver.test_spectrum_real_packets_reabsorbed ___________
2025-02-21T12:51:10.3117275Z 
2025-02-21T12:51:10.3117736Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7f61468acf50>
2025-02-21T12:51:10.3118324Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7f6140182090>
2025-02-21T12:51:10.3118655Z 
2025-02-21T12:51:10.3118844Z     def test_spectrum_real_packets_reabsorbed(self, simulation_regression_data):
2025-02-21T12:51:10.3119306Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:51:10.3119804Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:51:10.3120190Z     
2025-02-21T12:51:10.3120465Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:51:10.3120882Z         result = solver.spectrum_real_packets_reabsorbed.luminosity
2025-02-21T12:51:10.3121326Z         key = "simulation/spectrum_solver/spectrum_real_packets_reabsorbed/luminosity"
2025-02-21T12:51:10.3121727Z         expected = self.get_expected_data(key)
2025-02-21T12:51:10.3121975Z     
2025-02-21T12:51:10.3122170Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:51:10.3122424Z     
2025-02-21T12:51:10.3122594Z >       assert_quantity_allclose(
2025-02-21T12:51:10.3122815Z             result,
2025-02-21T12:51:10.3122996Z             luminosity,
2025-02-21T12:51:10.3123187Z         )
2025-02-21T12:51:10.3123281Z 
2025-02-21T12:51:10.3123407Z tardis/spectrum/tests/test_spectrum_solver.py:77: 
2025-02-21T12:51:10.3123718Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3124253Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:10.3124775Z     np.testing.assert_allclose(
2025-02-21T12:51:10.3125040Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3125248Z 
2025-02-21T12:51:10.3125623Z args = (<function assert_allclose.<locals>.compare at 0x7f6115386480>, array([0., 0., 0., ..., 0., 0., 0.]), array([2.03920412e+38, 3.72882494e+38, 2.29646943e+38, ...,
2025-02-21T12:51:10.3126196Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:10.3126629Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:10.3126951Z 
2025-02-21T12:51:10.3127031Z     @wraps(func)
2025-02-21T12:51:10.3127228Z     def inner(*args, **kwds):
2025-02-21T12:51:10.3127624Z         with self._recreate_cm():
2025-02-21T12:51:10.3127868Z >           return func(*args, **kwds)
2025-02-21T12:51:10.3128114Z E           AssertionError: 
2025-02-21T12:51:10.3128361Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3128625Z E           
2025-02-21T12:51:10.3128825Z E           Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T12:51:10.3129109Z E           Max absolute difference: 1.0639846e+40
2025-02-21T12:51:10.3129392Z E           Max relative difference: 122.79315318
2025-02-21T12:51:10.3129654Z E            x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T12:51:10.3129974Z E            y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T12:51:10.3130298Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3130469Z 
2025-02-21T12:51:10.3130673Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:10.3131126Z ________________________ TestSpectrumSolver.test_solve _________________________
2025-02-21T12:51:10.3131374Z 
2025-02-21T12:51:10.3131641Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7f61468ad790>
2025-02-21T12:51:10.3132216Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7f6140182090>
2025-02-21T12:51:10.3132540Z 
2025-02-21T12:51:10.3132662Z     def test_solve(self, simulation_regression_data):
2025-02-21T12:51:10.3133182Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:51:10.3133788Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:51:10.3134175Z     
2025-02-21T12:51:10.3134445Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:51:10.3134871Z         result_real, result_virtual, result_integrated = solver.solve(
2025-02-21T12:51:10.3135187Z             transport_state
2025-02-21T12:51:10.3135390Z         )
2025-02-21T12:51:10.3135663Z         key_real = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:51:10.3136047Z         expected_real = self.get_expected_data(key_real)
2025-02-21T12:51:10.3136313Z     
2025-02-21T12:51:10.3136531Z         luminosity_real = u.Quantity(expected_real, "erg /s")
2025-02-21T12:51:10.3136813Z     
2025-02-21T12:51:10.3136982Z >       assert_quantity_allclose(
2025-02-21T12:51:10.3137223Z             result_real.luminosity,
2025-02-21T12:51:10.3137665Z             luminosity_real,
2025-02-21T12:51:10.3137887Z         )
2025-02-21T12:51:10.3137980Z 
2025-02-21T12:51:10.3138106Z tardis/spectrum/tests/test_spectrum_solver.py:95: 
2025-02-21T12:51:10.3138421Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3138963Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:10.3139472Z     np.testing.assert_allclose(
2025-02-21T12:51:10.3139735Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3139939Z 
2025-02-21T12:51:10.3140400Z args = (<function assert_allclose.<locals>.compare at 0x7f6115387c40>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T12:51:10.3141050Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:10.3141476Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:10.3141813Z 
2025-02-21T12:51:10.3141890Z     @wraps(func)
2025-02-21T12:51:10.3142085Z     def inner(*args, **kwds):
2025-02-21T12:51:10.3142309Z         with self._recreate_cm():
2025-02-21T12:51:10.3142544Z >           return func(*args, **kwds)
2025-02-21T12:51:10.3142788Z E           AssertionError: 
2025-02-21T12:51:10.3143029Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3143287Z E           
2025-02-21T12:51:10.3143488Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:51:10.3143766Z E           Max absolute difference: 1.94155993e+40
2025-02-21T12:51:10.3144042Z E           Max relative difference: 137.15340685
2025-02-21T12:51:10.3144361Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3144687Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3144997Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:51:10.3145315Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3145484Z 
2025-02-21T12:51:10.3145681Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:10.3146148Z __________________ TestTransportSimple.test_j_blue_estimators __________________
2025-02-21T12:51:10.3146417Z 
2025-02-21T12:51:10.3146635Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7f61468ae000>
2025-02-21T12:51:10.3147168Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7f6140182090>
2025-02-21T12:51:10.3147691Z 
2025-02-21T12:51:10.3147851Z     def test_j_blue_estimators(self, simulation_regression_data):
2025-02-21T12:51:10.3148232Z         key = "simulation/transport/transport_state/j_blue_estimator"
2025-02-21T12:51:10.3148564Z         expected = self.get_expected_data(key)
2025-02-21T12:51:10.3148947Z     
2025-02-21T12:51:10.3149119Z >       npt.assert_allclose(
2025-02-21T12:51:10.3149634Z             simulation_regression_data.transport.transport_state.radfield_mc_estimators.j_blue_estimator,
2025-02-21T12:51:10.3150069Z             expected.values,
2025-02-21T12:51:10.3150275Z         )
2025-02-21T12:51:10.3150372Z 
2025-02-21T12:51:10.3150463Z tardis/tests/test_tardis_full.py:60: 
2025-02-21T12:51:10.3150743Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3150943Z 
2025-02-21T12:51:10.3159017Z args = (<function assert_allclose.<locals>.compare at 0x7f614002e160>, array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3159837Z        [0., 0., .....,
2025-02-21T12:51:10.3160175Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3160559Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3160935Z        [0., 0., 0., ..., 0., 0., 0.]]))
2025-02-21T12:51:10.3161602Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:10.3162175Z 
2025-02-21T12:51:10.3162308Z     @wraps(func)
2025-02-21T12:51:10.3162635Z     def inner(*args, **kwds):
2025-02-21T12:51:10.3163016Z         with self._recreate_cm():
2025-02-21T12:51:10.3163412Z >           return func(*args, **kwds)
2025-02-21T12:51:10.3163830Z E           AssertionError: 
2025-02-21T12:51:10.3164145Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3164430Z E           
2025-02-21T12:51:10.3164647Z E           Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T12:51:10.3164941Z E           Max absolute difference: 1.43452643e-17
2025-02-21T12:51:10.3165223Z E           Max relative difference: 235.31367318
2025-02-21T12:51:10.3165494Z E            x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3165865Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3166296Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:51:10.3166734Z E            y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3167154Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3167735Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:51:10.3168026Z 
2025-02-21T12:51:10.3168368Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:10.3169147Z ______________________ TestTransportSimple.test_spectrum _______________________
2025-02-21T12:51:10.3169603Z 
2025-02-21T12:51:10.3169961Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7f61468ae360>
2025-02-21T12:51:10.3170914Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7f6140182090>
2025-02-21T12:51:10.3171454Z 
2025-02-21T12:51:10.3171592Z     def test_spectrum(self, simulation_regression_data):
2025-02-21T12:51:10.3171992Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:51:10.3172353Z         expected = self.get_expected_data(key)
2025-02-21T12:51:10.3172608Z     
2025-02-21T12:51:10.3172809Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:51:10.3173069Z     
2025-02-21T12:51:10.3173240Z >       assert_quantity_allclose(
2025-02-21T12:51:10.3173603Z             simulation_regression_data.spectrum_solver.spectrum_real_packets.luminosity,
2025-02-21T12:51:10.3173979Z             luminosity,
2025-02-21T12:51:10.3174175Z         )
2025-02-21T12:51:10.3174275Z 
2025-02-21T12:51:10.3174367Z tardis/tests/test_tardis_full.py:71: 
2025-02-21T12:51:10.3174651Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3175190Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:10.3175708Z     np.testing.assert_allclose(
2025-02-21T12:51:10.3175969Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3176168Z 
2025-02-21T12:51:10.3176638Z args = (<function assert_allclose.<locals>.compare at 0x7f611702cfe0>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.47119190e+39, 1.69564189e+39, 1.35368464e+39, ...,
2025-02-21T12:51:10.3177919Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:10.3178426Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:10.3178999Z 
2025-02-21T12:51:10.3179124Z     @wraps(func)
2025-02-21T12:51:10.3179452Z     def inner(*args, **kwds):
2025-02-21T12:51:10.3179830Z         with self._recreate_cm():
2025-02-21T12:51:10.3180226Z >           return func(*args, **kwds)
2025-02-21T12:51:10.3180634Z E           AssertionError: 
2025-02-21T12:51:10.3181038Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3181471Z E           
2025-02-21T12:51:10.3181776Z E           Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T12:51:10.3182060Z E           Max absolute difference: 1.96604107e+40
2025-02-21T12:51:10.3182349Z E           Max relative difference: 97.03021569
2025-02-21T12:51:10.3182675Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3182998Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3183302Z E            y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3183611Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3183773Z 
2025-02-21T12:51:10.3183974Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:10.3184435Z __________________ TestTransportSimple.test_virtual_spectrum ___________________
2025-02-21T12:51:10.3184704Z 
2025-02-21T12:51:10.3184911Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7f61468ae630>
2025-02-21T12:51:10.3185440Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7f6140182090>
2025-02-21T12:51:10.3185769Z 
2025-02-21T12:51:10.3185919Z     def test_virtual_spectrum(self, simulation_regression_data):
2025-02-21T12:51:10.3186322Z         key = "simulation/spectrum_solver/spectrum_virtual_packets/luminosity"
2025-02-21T12:51:10.3186687Z         expected = self.get_expected_data(key)
2025-02-21T12:51:10.3186932Z     
2025-02-21T12:51:10.3187129Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:51:10.3187378Z     
2025-02-21T12:51:10.3187775Z >       assert_quantity_allclose(
2025-02-21T12:51:10.3188154Z             simulation_regression_data.spectrum_solver.spectrum_virtual_packets.luminosity,
2025-02-21T12:51:10.3188533Z             luminosity,
2025-02-21T12:51:10.3188728Z         )
2025-02-21T12:51:10.3188821Z 
2025-02-21T12:51:10.3188918Z tardis/tests/test_tardis_full.py:82: 
2025-02-21T12:51:10.3189194Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3189730Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:10.3190240Z     np.testing.assert_allclose(
2025-02-21T12:51:10.3190496Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:10.3190701Z 
2025-02-21T12:51:10.3191161Z args = (<function assert_allclose.<locals>.compare at 0x7f611702c900>, array([1.31895331e+39, 2.31381538e+39, 3.72000430e+39,...), array([1.44033177e+39, 1.35611403e+39, 1.39755698e+39, ...,
2025-02-21T12:51:10.3191808Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:10.3192232Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:10.3192555Z 
2025-02-21T12:51:10.3192632Z     @wraps(func)
2025-02-21T12:51:10.3192822Z     def inner(*args, **kwds):
2025-02-21T12:51:10.3193045Z         with self._recreate_cm():
2025-02-21T12:51:10.3193281Z >           return func(*args, **kwds)
2025-02-21T12:51:10.3193522Z E           AssertionError: 
2025-02-21T12:51:10.3193766Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3194172Z E           
2025-02-21T12:51:10.3194475Z E           Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T12:51:10.3194749Z E           Max absolute difference: 4.69537822e+39
2025-02-21T12:51:10.3195023Z E           Max relative difference: 419.77405263
2025-02-21T12:51:10.3195342Z E            x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3195660Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3195966Z E            y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3196278Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3196447Z 
2025-02-21T12:51:10.3196639Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:10.3197044Z =============================== warnings summary ===============================
2025-02-21T12:51:10.3197359Z tardis/io/configuration/config_validator.py:6
2025-02-21T12:51:10.3197794Z tardis/io/configuration/config_validator.py:6
2025-02-21T12:51:10.3198301Z   /home/runner/work/tardis/tardis/tardis/io/configuration/config_validator.py:6: DeprecationWarning:
2025-02-21T12:51:10.3198765Z   
2025-02-21T12:51:10.3199990Z   jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
2025-02-21T12:51:10.3201216Z 
2025-02-21T12:51:10.3201451Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22
2025-02-21T12:51:10.3202127Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22: DeprecationWarning:
2025-02-21T12:51:10.3202646Z   
2025-02-21T12:51:10.3202885Z   Jupyter is migrating its paths to use standard platformdirs
2025-02-21T12:51:10.3203285Z   given by the platformdirs library.  To remove this warning and
2025-02-21T12:51:10.3203691Z   see the appropriate new directories, set the environment variable
2025-02-21T12:51:10.3204081Z   `JUPYTER_PLATFORM_DIRS=1` and then run `jupyter --paths`.
2025-02-21T12:51:10.3204455Z   The use of platformdirs will be the default in `jupyter_core` v6
2025-02-21T12:51:10.3204692Z 
2025-02-21T12:51:10.3212358Z tardis/io/tests/test_HDFWriter.py::test_multi_index_write
2025-02-21T12:51:10.3212921Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:51:10.3213482Z   /home/runner/work/tardis/tardis/tardis/io/util.py:276: PerformanceWarning:
2025-02-21T12:51:10.3213842Z   
2025-02-21T12:51:10.3213994Z   
2025-02-21T12:51:10.3214285Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:51:10.3214836Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T12:51:10.3215196Z 
2025-02-21T12:51:10.3215402Z tardis/io/tests/test_model_reader.py::test_read_cmfgen_isotope_abundances
2025-02-21T12:51:10.3215897Z tardis/plasma/tests/test_tardis_model_density_config.py::test_electron_densities
2025-02-21T12:51:10.3216480Z tardis/plasma/tests/test_tardis_model_density_config.py::test_isotope_number_densities
2025-02-21T12:51:10.3216976Z tardis/plasma/tests/test_tardis_model_density_config.py::test_t_rad
2025-02-21T12:51:10.3217758Z   /home/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:82: DeprecationWarning:
2025-02-21T12:51:10.3218227Z   
2025-02-21T12:51:10.3218427Z   The current CMFGEN model parser is deprecated
2025-02-21T12:51:10.3218618Z 
2025-02-21T12:51:10.3218739Z tardis/io/tests/test_model_reader.py: 1 warning
2025-02-21T12:51:10.3219114Z tardis/plasma/tests/test_tardis_model_density_config.py: 9 warnings
2025-02-21T12:51:10.3219695Z   /home/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:40: DeprecationWarning:
2025-02-21T12:51:10.3220331Z   
2025-02-21T12:51:10.3220634Z   The current CMFGEN model parser is deprecated
2025-02-21T12:51:10.3220824Z 
2025-02-21T12:51:10.3221027Z tardis/model/tests/test_base.py::TestModelFromPaper1Config::test_abundances
2025-02-21T12:51:10.3221676Z   /home/runner/work/tardis/tardis/tardis/transport/montecarlo/montecarlo_main_loop.py:123: NumbaTypeSafetyWarning:
2025-02-21T12:51:10.3222195Z   
2025-02-21T12:51:10.3222702Z   [1m[1m[1munsafe cast from uint64 to int64. Precision may be lost.[0m[0m[0m
2025-02-21T12:51:10.3222972Z 
2025-02-21T12:51:10.3223078Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T12:51:10.3223370Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T12:51:10.3223740Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T12:51:10.3224300Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:50: DeprecationWarning:
2025-02-21T12:51:10.3224722Z   
2025-02-21T12:51:10.3224911Z   v_inner_boundary < 0, assuming default value
2025-02-21T12:51:10.3225105Z 
2025-02-21T12:51:10.3225205Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T12:51:10.3225488Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T12:51:10.3225851Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T12:51:10.3226366Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:61: DeprecationWarning:
2025-02-21T12:51:10.3226781Z   
2025-02-21T12:51:10.3226963Z   v_outer_boundary < 0, assuming default value
2025-02-21T12:51:10.3227141Z 
2025-02-21T12:51:10.3227827Z tardis/plasma/equilibrium/tests/test_level_populations.py::TestLevelPopulationSolver::test_solve[collisional_rate_solver0-radiative_transitions0]
2025-02-21T12:51:10.3228661Z   /home/runner/work/tardis/tardis/tardis/plasma/equilibrium/level_populations.py:65: FutureWarning:
2025-02-21T12:51:10.3229105Z   
2025-02-21T12:51:10.3229458Z   A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
2025-02-21T12:51:10.3230270Z   The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
2025-02-21T12:51:10.3230861Z   
2025-02-21T12:51:10.3231471Z   For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
2025-02-21T12:51:10.3232078Z 
2025-02-21T12:51:10.3232298Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3750]
2025-02-21T12:51:10.3232793Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3850]
2025-02-21T12:51:10.3233279Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3900]
2025-02-21T12:51:10.3233798Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:71: UserWarning:
2025-02-21T12:51:10.3234190Z   
2025-02-21T12:51:10.3234460Z   Requesting inner boundary below inner shell. Extrapolating the inner cell
2025-02-21T12:51:10.3234743Z 
2025-02-21T12:51:10.3234951Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T12:51:10.3235438Z   /home/runner/work/tardis/tardis/tardis/spectrum/base.py:70: UserWarning:
2025-02-21T12:51:10.3235781Z   
2025-02-21T12:51:10.3236184Z   SpectrumSolver.spectrum_virtual_packets is zero. Please run the montecarlo simulation with no_of_virtual_packets > 0
2025-02-21T12:51:10.3236595Z 
2025-02-21T12:51:10.3236799Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T12:51:10.3237290Z   /home/runner/work/tardis/tardis/tardis/spectrum/base.py:111: UserWarning:
2025-02-21T12:51:10.3237803Z   
2025-02-21T12:51:10.3238235Z   SpectrumSolver.integrator: The FormalIntegrator is not yet available.Please run the montecarlo simulation at least once.
2025-02-21T12:51:10.3238659Z 
2025-02-21T12:51:10.3239009Z tardis/transport/montecarlo/tests/test_vpacket.py::test_trace_vpacket_volley
2025-02-21T12:51:10.3239524Z   <string>:3: NumbaPendingDeprecationWarning:
2025-02-21T12:51:10.3239771Z   
2025-02-21T12:51:10.3240908Z   [1m[1mCode using Numba extension API maybe depending on 'old_style' error-capturing, which is deprecated and will be replaced by 'new_style' in a future release. See details at https://numba.readthedocs.io/en/latest/reference/deprecation.html#deprecation-of-old-style-numba-captured-errors
2025-02-21T12:51:10.3241909Z   Exception origin:
2025-02-21T12:51:10.3242278Z     File "/home/runner/micromamba/envs/tardis/lib/python3.12/inspect.py", line 3180, in _bind
2025-02-21T12:51:10.3242698Z       raise TypeError(msg) from None
2025-02-21T12:51:10.3242947Z   [0m[0m
2025-02-21T12:51:10.3243049Z 
2025-02-21T12:51:10.3243377Z tardis/visualization/tools/tests/test_sdec_plot.py::TestSDECPlotter::test_mpl_image[plotter_generate_plot_mpl4]
2025-02-21T12:51:10.3244082Z   /home/runner/work/tardis/tardis/tardis/visualization/tools/sdec_plot.py:1225: RuntimeWarning:
2025-02-21T12:51:10.3244525Z   
2025-02-21T12:51:10.3245478Z   More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
2025-02-21T12:51:10.3246389Z 
2025-02-21T12:51:10.3246746Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3247693Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3248472Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3249234Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3250016Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3250786Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3251593Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:51:10.3252092Z   
2025-02-21T12:51:10.3252365Z   Passing unrecognized arguments to super(Checkbox).__init__(icon='lock').
2025-02-21T12:51:10.3252809Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:51:10.3253303Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:51:10.3253622Z 
2025-02-21T12:51:10.3253976Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3254753Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3255547Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:51:10.3256050Z   
2025-02-21T12:51:10.3256335Z   Passing unrecognized arguments to super(FloatText).__init__(min=0).
2025-02-21T12:51:10.3256766Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:51:10.3257261Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:51:10.3257754Z 
2025-02-21T12:51:10.3258115Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:10.3258996Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:51:10.3259678Z   
2025-02-21T12:51:10.3259940Z   Passing unrecognized arguments to super(HTML).__init__(indent=True).
2025-02-21T12:51:10.3260497Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:51:10.3261095Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:51:10.3261417Z 
2025-02-21T12:51:10.3261843Z tardis/visualization/widgets/tests/test_line_info.py::TestLineInfoWidgetData::test_get_species_interactions[wavelength_range0-packet_out_nu]
2025-02-21T12:51:10.3262675Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/qgridnext/grid.py:825: DeprecationWarning:
2025-02-21T12:51:10.3263151Z   
2025-02-21T12:51:10.3263508Z   QgridWidget._grid_options_changed is deprecated in traitlets 4.1: use @observe and @unobserve instead.
2025-02-21T12:51:10.3263872Z 
2025-02-21T12:51:10.3264131Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:51:10.3264675Z   /home/runner/work/tardis/tardis/tardis/io/util.py:289: PerformanceWarning:
2025-02-21T12:51:10.3265037Z   
2025-02-21T12:51:10.3265183Z   
2025-02-21T12:51:10.3265473Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:51:10.3266019Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T12:51:10.3266358Z 
2025-02-21T12:51:10.3266663Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:51:10.3267293Z   /home/runner/work/tardis/tardis/tardis/io/util.py:292: PerformanceWarning:
2025-02-21T12:51:10.3268174Z   
2025-02-21T12:51:10.3280080Z   
2025-02-21T12:51:10.3280410Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:51:10.3280912Z   map directly to c-types [inferred_type->mixed,key->values] [items->None]
2025-02-21T12:51:10.3281185Z 
2025-02-21T12:51:10.3281468Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:51:10.3282070Z   /home/runner/work/tardis/tardis/tardis/spectrum/formal_integral.py:398: UserWarning:
2025-02-21T12:51:10.3282485Z   
2025-02-21T12:51:10.3282775Z   The number of interpolate_shells was not specified. The value was set to 80.
2025-02-21T12:51:10.3283052Z 
2025-02-21T12:51:10.3283248Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-02-21T12:51:10.3283534Z 
2025-02-21T12:51:10.3283695Z ---------- coverage: platform linux, python 3.12.4-final-0 -----------
2025-02-21T12:51:10.3284057Z Coverage HTML written to dir coverage_html_report
2025-02-21T12:51:10.3284350Z Coverage XML written to file coverage.xml
2025-02-21T12:51:10.3284530Z 
2025-02-21T12:51:10.3284651Z =========================== short test summary info ============================
2025-02-21T12:51:10.3285220Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets - AssertionError: 
2025-02-21T12:51:10.3285755Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3285933Z 
2025-02-21T12:51:10.3286026Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:51:10.3286283Z Max absolute difference: 1.94155993e+40
2025-02-21T12:51:10.3286537Z Max relative difference: 137.15340685
2025-02-21T12:51:10.3286837Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3287144Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3287543Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:51:10.3287840Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3288376Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets_reabsorbed - AssertionError: 
2025-02-21T12:51:10.3288933Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3289108Z 
2025-02-21T12:51:10.3289194Z Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T12:51:10.3289454Z Max absolute difference: 1.0639846e+40
2025-02-21T12:51:10.3289710Z Max relative difference: 122.79315318
2025-02-21T12:51:10.3290151Z  x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T12:51:10.3290557Z  y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T12:51:10.3290872Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3291326Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve - AssertionError: 
2025-02-21T12:51:10.3291810Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3291985Z 
2025-02-21T12:51:10.3292079Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:51:10.3292331Z Max absolute difference: 1.94155993e+40
2025-02-21T12:51:10.3292589Z Max relative difference: 137.15340685
2025-02-21T12:51:10.3292883Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3293178Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3293453Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:51:10.3293741Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3294169Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_j_blue_estimators - AssertionError: 
2025-02-21T12:51:10.3294636Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3294808Z 
2025-02-21T12:51:10.3294903Z Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T12:51:10.3295163Z Max absolute difference: 1.43452643e-17
2025-02-21T12:51:10.3295414Z Max relative difference: 235.31367318
2025-02-21T12:51:10.3295648Z  x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3295878Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3296095Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:51:10.3296320Z  y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3296547Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:10.3296771Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:51:10.3297208Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_spectrum - AssertionError: 
2025-02-21T12:51:10.3297874Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3298066Z 
2025-02-21T12:51:10.3298154Z Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T12:51:10.3298416Z Max absolute difference: 1.96604107e+40
2025-02-21T12:51:10.3298668Z Max relative difference: 97.03021569
2025-02-21T12:51:10.3298970Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3299274Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3299552Z  y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3299851Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3300281Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_virtual_spectrum - AssertionError: 
2025-02-21T12:51:10.3300752Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:10.3300920Z 
2025-02-21T12:51:10.3301016Z Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T12:51:10.3301264Z Max absolute difference: 4.69537822e+39
2025-02-21T12:51:10.3301512Z Max relative difference: 419.77405263
2025-02-21T12:51:10.3301807Z  x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3302105Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3302382Z  y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T12:51:10.3302672Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:10.3303071Z = 6 failed, 1404 passed, 357 skipped, 2 deselected, 19 xfailed, 8 xpassed, 63 warnings in 693.27s (0:11:33) =
2025-02-21T12:51:12.5350912Z ##[error]Process completed with exit code 1.
