2025-01-27T17:42:43.9778319Z ##[group]Run pytest tardis --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"
2025-01-27T17:42:43.9779602Z [36;1mpytest tardis --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"[0m
2025-01-27T17:42:43.9808002Z shell: /usr/bin/bash -l {0}
2025-01-27T17:42:43.9808253Z env:
2025-01-27T17:42:43.9808421Z   CACHE_NUMBER: 0
2025-01-27T17:42:43.9809039Z   PYTEST_FLAGS: --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append
2025-01-27T17:42:43.9809698Z   CODECOV_TOKEN: 
2025-01-27T17:42:43.9809925Z   MAMBA_ROOT_PREFIX: /home/runner/micromamba
2025-01-27T17:42:43.9810232Z   MAMBA_EXE: /home/runner/micromamba-bin/micromamba
2025-01-27T17:42:43.9810583Z   CONDARC: /home/runner/work/_temp/setup-micromamba/.condarc
2025-01-27T17:42:43.9810931Z ##[endgroup]
2025-01-27T17:42:55.4802196Z ============================= test session starts ==============================
2025-01-27T17:42:55.4802985Z platform linux -- Python 3.12.4, pytest-8.2.2, pluggy-1.5.0
2025-01-27T17:42:55.4803594Z rootdir: /home/runner/work/tardis/tardis
2025-01-27T17:42:55.4804123Z configfile: pyproject.toml
2025-01-27T17:42:55.4804613Z plugins: anyio-4.4.0, doctestplus-1.2.1, html-4.1.1, metadata-3.1.1, cov-5.0.0
2025-01-27T17:42:55.4805190Z collected 1802 items / 2 deselected / 1800 selected
2025-01-27T17:42:55.4805481Z 
2025-01-27T17:43:00.6276846Z tardis/energy_input/tests/test_energy_source.py ..xxx                    [  0%]
2025-01-27T17:43:03.8336804Z tardis/energy_input/tests/test_gamma_ray_channel.py ...........          [  0%]
2025-01-27T17:43:05.5009702Z tardis/energy_input/tests/test_gamma_ray_grid.py xx.                     [  1%]
2025-01-27T17:43:07.3598374Z tardis/energy_input/tests/test_gamma_ray_interactions.py xx....          [  1%]
2025-01-27T17:43:07.3691384Z tardis/energy_input/tests/test_gamma_ray_packet_source.py sssssssss      [  1%]
2025-01-27T17:43:08.7092398Z tardis/energy_input/tests/test_util.py .....xxxx.....                    [  2%]
2025-01-27T17:43:09.0503958Z tardis/grid/tests/test_grid.py .                                         [  2%]
2025-01-27T17:43:09.0519928Z tardis/gui/tests/test_gui.py s                                           [  2%]
2025-01-27T17:43:12.5973328Z tardis/io/configuration/tests/test_config_reader.py ...........          [  3%]
2025-01-27T17:43:12.6105689Z tardis/io/configuration/tests/test_configuration_namespace.py .........  [  3%]
2025-01-27T17:43:12.6385943Z tardis/io/logger/tests/test_logging.py ssssssssssssssssssssssssssss      [  5%]
2025-01-27T17:43:51.2546944Z tardis/io/model/readers/tests/test_arepo_parser.py ..                    [  5%]
2025-01-27T17:43:51.2692248Z tardis/io/model/readers/tests/test_ascii_readers.py ...                  [  5%]
2025-01-27T17:43:51.2799113Z tardis/io/model/readers/tests/test_cmfgen_reader.py ..                   [  5%]
2025-01-27T17:43:51.3112677Z tardis/io/model/readers/tests/test_csvy_reader.py ....                   [  6%]
2025-01-27T17:43:51.3337256Z tardis/io/model/readers/tests/test_stella_reader.py ..                   [  6%]
2025-01-27T17:43:51.6410457Z tardis/io/tests/test_HDFWriter.py ...............                        [  7%]
2025-01-27T17:43:51.9613292Z tardis/io/tests/test_atomic.py .....                                     [  7%]
2025-01-27T17:43:51.9809022Z tardis/io/tests/test_decay.py ..                                         [  7%]
2025-01-27T17:43:52.1772781Z tardis/io/tests/test_model_reader.py ......                              [  7%]
2025-01-27T17:43:52.1843937Z tardis/model/geometry/tests/test_radial1d.py ..                          [  7%]
2025-01-27T17:43:52.4689737Z tardis/model/matter/tests/test_composition.py EEEEEE                     [  8%]
2025-01-27T17:44:51.5154184Z tardis/model/tests/test_base.py ........................................ [ 10%]
2025-01-27T17:44:52.5187639Z ............                                                             [ 11%]
2025-01-27T17:44:55.5814299Z tardis/model/tests/test_csvy_model.py .........                          [ 11%]
2025-01-27T17:44:55.6302632Z tardis/model/tests/test_density.py ..                                    [ 11%]
2025-01-27T17:44:56.9476723Z tardis/opacities/tests/test_opacity_solver.py .....                      [ 11%]
2025-01-27T17:44:58.2976519Z tardis/opacities/tests/test_opacity_state_numba.py .....                 [ 12%]
2025-01-27T17:45:00.4017818Z tardis/opacities/tests/test_tau_sobolev.py FF                            [ 12%]
2025-01-27T17:45:03.1584223Z tardis/plasma/equilibrium/tests/test_collisional_transitions.py ...      [ 12%]
2025-01-27T17:45:49.1689381Z tardis/plasma/equilibrium/tests/test_level_populations.py ....           [ 12%]
2025-01-27T17:46:00.8209872Z tardis/plasma/equilibrium/tests/test_rate_matrix.py .                    [ 12%]
2025-01-27T17:46:02.2596356Z tardis/plasma/tests/test_complete_plasmas.py .....................s..... [ 14%]
2025-01-27T17:46:05.2339549Z s....ssssss............s............ss.....s....ssssss............s..... [ 18%]
2025-01-27T17:46:06.9917506Z .......ss.....s....ssssss............s............ss.....s....ssssss.... [ 22%]
2025-01-27T17:46:09.9178691Z ........s............ss.....s........ss............s............ss.....s [ 26%]
2025-01-27T17:46:12.8455905Z ........ss............s............ss.....s....ssssss............s...... [ 30%]
2025-01-27T17:46:13.6031913Z ......ss.....s....ssssss............s............ss.....s.ss.ssssss..... [ 34%]
2025-01-27T17:46:16.5574207Z .......s............ss.....s....ssssss............s............ss.....s. [ 38%]
2025-01-27T17:46:19.4725785Z ...ssssss............s............ss.....s....ssssss............s....... [ 42%]
2025-01-27T17:46:22.5786505Z .....ss.....s....ssssss............s............s...........ssssss...... [ 46%]
2025-01-27T17:46:24.4462710Z ......s............s...........ssssss............s............s......... [ 50%]
2025-01-27T17:46:27.4138331Z ..ssssss............s............ss.....s....ssssss............s........ [ 54%]
2025-01-27T17:46:31.0816514Z ....ss.....s....ssssss..........................s.....s....ssss......... [ 58%]
2025-01-27T17:46:31.4079513Z ...................s.....s....ssss.......                                [ 60%]
2025-01-27T17:46:31.5189290Z tardis/plasma/tests/test_hdf_plasma.py ................................. [ 62%]
2025-01-27T17:46:31.5304342Z ......                                                                   [ 62%]
2025-01-27T17:46:31.6612982Z tardis/plasma/tests/test_nlte_excitation.py ...                          [ 62%]
2025-01-27T17:48:49.5444053Z tardis/plasma/tests/test_nlte_solver.py .....X                           [ 63%]
2025-01-27T17:48:49.5470531Z tardis/plasma/tests/test_plasma_continuum.py .                           [ 63%]
2025-01-27T17:49:14.3045028Z tardis/plasma/tests/test_plasma_vboundary.py .............               [ 64%]
2025-01-27T17:49:27.5943492Z tardis/plasma/tests/test_tardis_model_density_config.py ...              [ 64%]
2025-01-27T17:49:28.3460525Z tardis/simulation/tests/test_convergence.py .....                        [ 64%]
2025-01-27T17:49:37.1201913Z tardis/simulation/tests/test_simulation.py .............                 [ 65%]
2025-01-27T17:49:37.1394357Z tardis/spectrum/tests/test_cuda_formal_integral.py sssssssssssssssssssss [ 66%]
2025-01-27T17:49:37.6188623Z ssss...ssssssssssssssssssssss                                            [ 67%]
2025-01-27T17:49:37.6260461Z tardis/spectrum/tests/test_luminosity.py ....                            [ 68%]
2025-01-27T17:49:39.2477413Z tardis/spectrum/tests/test_numba_formal_integral.py .................... [ 69%]
2025-01-27T17:49:39.2672897Z ..........                                                               [ 69%]
2025-01-27T17:49:39.4431951Z tardis/spectrum/tests/test_spectrum.py ................................. [ 71%]
2025-01-27T17:49:39.4764685Z .........                                                                [ 72%]
2025-01-27T17:49:59.2076358Z tardis/spectrum/tests/test_spectrum_solver.py ....                       [ 72%]
2025-01-27T17:51:01.3080327Z tardis/tests/test_tardis_full.py ....                                    [ 72%]
2025-01-27T17:52:26.8312578Z tardis/tests/test_tardis_full_formal_integral.py ................        [ 73%]
2025-01-27T17:52:26.9061593Z tardis/tests/test_util.py .............................................  [ 76%]
2025-01-27T17:52:29.6060845Z tardis/transport/montecarlo/tests/test_base.py x.....................    [ 77%]
2025-01-27T17:52:37.4368767Z tardis/transport/montecarlo/tests/test_interaction.py .......            [ 77%]
2025-01-27T17:52:37.6891549Z tardis/transport/montecarlo/tests/test_macro_atom.py ....                [ 77%]
2025-01-27T17:52:37.7081368Z tardis/transport/montecarlo/tests/test_montecarlo.py sssssssssssssssssss [ 78%]
2025-01-27T17:52:37.7486903Z sssssssssssssssssssssssssssssssssssssssssssss                            [ 81%]
2025-01-27T17:52:46.6794142Z tardis/transport/montecarlo/tests/test_montecarlo_main_loop.py x..       [ 81%]
2025-01-27T17:52:46.6862737Z tardis/transport/montecarlo/tests/test_nonhomologous.py ...              [ 81%]
2025-01-27T17:52:52.6004058Z tardis/transport/montecarlo/tests/test_numba_interface.py .....x.        [ 82%]
2025-01-27T17:52:53.1163184Z tardis/transport/montecarlo/tests/test_opacities.py ...............      [ 82%]
2025-01-27T17:52:54.1728561Z tardis/transport/montecarlo/tests/test_packet.py .................xXXXXX [ 84%]
2025-01-27T17:52:54.3147881Z XX.........                                                              [ 84%]
2025-01-27T17:52:54.3430575Z tardis/transport/montecarlo/tests/test_packet_source.py ........         [ 85%]
2025-01-27T17:52:54.6736112Z tardis/transport/montecarlo/tests/test_rpacket_last_interaction_tracker.py . [ 85%]
2025-01-27T17:52:55.1331843Z .....                                                                    [ 85%]
2025-01-27T17:53:31.1388636Z tardis/transport/montecarlo/tests/test_rpacket_tracker.py ......         [ 85%]
2025-01-27T17:53:31.1676772Z tardis/transport/montecarlo/tests/test_single_packet_loop.py xxx         [ 86%]
2025-01-27T17:53:31.1708974Z tardis/transport/montecarlo/tests/test_tracker_utils.py ..               [ 86%]
2025-01-27T17:53:34.1649599Z tardis/transport/montecarlo/tests/test_vpacket.py ..x.                   [ 86%]
2025-01-27T17:53:34.1824802Z tardis/transport/montecarlo/tests/test_weighted_packet_source.py ....    [ 86%]
2025-01-27T17:53:37.6525062Z tardis/transport/montecarlo/tests/test_weighted_packet_source_integration.py . [ 86%]
2025-01-27T17:53:37.6526473Z                                                                          [ 86%]
2025-01-27T17:53:38.4200599Z tardis/transport/tests/test_doppler_factor.py ..................         [ 87%]
2025-01-27T17:53:39.8107451Z tardis/visualization/tools/tests/test_convergence_plot.py .............. [ 88%]
2025-01-27T17:53:42.0722603Z ......                                                                   [ 88%]
2025-01-27T17:53:46.8341848Z tardis/visualization/tools/tests/test_liv_plot.py ...................... [ 90%]
2025-01-27T17:53:49.5711268Z .............................                                            [ 91%]
2025-01-27T17:53:52.4370920Z tardis/visualization/tools/tests/test_rpacket_plot.py .................. [ 92%]
2025-01-27T17:53:59.9940586Z ....                                                                     [ 92%]
2025-01-27T17:54:06.0986382Z tardis/visualization/tools/tests/test_sdec_plot.py ..................... [ 94%]
2025-01-27T17:54:13.8882623Z ..............................                                           [ 95%]
2025-01-27T17:54:14.3305447Z tardis/visualization/widgets/tests/test_custom_abundance.py ........ss.. [ 96%]
2025-01-27T17:54:14.4048686Z ....                                                                     [ 96%]
2025-01-27T17:54:15.4882177Z tardis/visualization/widgets/tests/test_line_info.py ................... [ 97%]
2025-01-27T17:54:16.1490055Z ..................                                                       [ 98%]
2025-01-27T17:55:19.8227504Z tardis/visualization/widgets/tests/test_shell_info.py .................. [ 99%]
2025-01-27T17:55:27.0029173Z ......                                                                   [100%]
2025-01-27T17:55:27.0030117Z 
2025-01-27T17:55:27.0030351Z ==================================== ERRORS ====================================
2025-01-27T17:55:27.0031114Z ________________ ERROR at setup of test_elemental_mass_fraction ________________
2025-01-27T17:55:27.0031692Z 
2025-01-27T17:55:27.0033159Z config_verysimple = {'tardis_config_version': 'v1.0', 'supernova': {'luminosity_requested': <Quantity 1.07688e+36 W>, 'time_explosion': <Q...: {'points': 1000, 'interpolate_shells': 0, 'compute': 'CPU'}}, 'config_dirname': 'tardis/io/configuration/tests/data'}
2025-01-27T17:55:27.0034606Z 
2025-01-27T17:55:27.0034744Z     @pytest.fixture(scope="function")
2025-01-27T17:55:27.0035167Z     def composition_instance(config_verysimple):
2025-01-27T17:55:27.0035835Z         time_explosion = config_verysimple.supernova.time_explosion.cgs
2025-01-27T17:55:27.0036598Z         geometry = parse_geometry_from_config(config_verysimple, time_explosion)
2025-01-27T17:55:27.0037467Z >       atom_data = parse_atom_data(config_verysimple)
2025-01-27T17:55:27.0037829Z 
2025-01-27T17:55:27.0038042Z tardis/model/matter/tests/test_composition.py:15: 
2025-01-27T17:55:27.0038616Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0039221Z tardis/io/model/parse_atom_data.py:43: in parse_atom_data
2025-01-27T17:55:27.0039800Z     atom_data = AtomData.from_hdf(atom_data_fname)
2025-01-27T17:55:27.0040307Z tardis/io/atom_data/base.py:190: in from_hdf
2025-01-27T17:55:27.0040777Z     fname = resolve_atom_data_fname(fname)
2025-01-27T17:55:27.0041270Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0041621Z 
2025-01-27T17:55:27.0041779Z fname = PosixPath('kurucz_cd23_chianti_H_He.h5')
2025-01-27T17:55:27.0041995Z 
2025-01-27T17:55:27.0042102Z     def resolve_atom_data_fname(fname):
2025-01-27T17:55:27.0042371Z         """
2025-01-27T17:55:27.0042733Z         Check where if atom data HDF file is available on disk, can be downloaded or does not exist
2025-01-27T17:55:27.0043165Z     
2025-01-27T17:55:27.0043343Z         Parameters
2025-01-27T17:55:27.0043554Z         ----------
2025-01-27T17:55:27.0043772Z         fname : Path
2025-01-27T17:55:27.0044024Z             name or path of atom data HDF file
2025-01-27T17:55:27.0044300Z     
2025-01-27T17:55:27.0044480Z         Returns
2025-01-27T17:55:27.0044669Z         -------
2025-01-27T17:55:27.0044844Z             : Path
2025-01-27T17:55:27.0045032Z             resolved fpath
2025-01-27T17:55:27.0045235Z         """
2025-01-27T17:55:27.0045409Z         fname = Path(fname)
2025-01-27T17:55:27.0045642Z         if os.path.exists(fname):
2025-01-27T17:55:27.0045875Z             return fname
2025-01-27T17:55:27.0046075Z     
2025-01-27T17:55:27.0046270Z         fname = Path(fname.stem).with_suffix(".h5")
2025-01-27T17:55:27.0046585Z         fpath = Path(os.path.join(get_data_dir(), fname))
2025-01-27T17:55:27.0046871Z         if os.path.exists(fpath):
2025-01-27T17:55:27.0047333Z             logger.info(
2025-01-27T17:55:27.0047682Z                 f"\n\tAtom Data {fname} not found in local path.\n\tExists in TARDIS Data repo {fpath}"
2025-01-27T17:55:27.0048044Z             )
2025-01-27T17:55:27.0048220Z             return fpath
2025-01-27T17:55:27.0048409Z     
2025-01-27T17:55:27.0048579Z         atom_data_name = fname.stem
2025-01-27T17:55:27.0048842Z         atom_repo_config = get_atomic_repo_config()
2025-01-27T17:55:27.0049125Z         if atom_data_name in atom_repo_config:
2025-01-27T17:55:27.0049380Z >           raise OSError(
2025-01-27T17:55:27.0049735Z                 f"Atom Data {fname} not found in path or in TARDIS data repo - it is available as download:\n"
2025-01-27T17:55:27.0050419Z                 f"from tardis.io.atom_data import download_atom_data\n"
2025-01-27T17:55:27.0050749Z                 f"download_atom_data('{atom_data_name}')"
2025-01-27T17:55:27.0051005Z             )
2025-01-27T17:55:27.0051408Z E           OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0052034Z E           from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0052364Z E           download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0052563Z 
2025-01-27T17:55:27.0052661Z tardis/io/atom_data/util.py:42: OSError
2025-01-27T17:55:27.0052982Z ---------------------------- Captured stdout setup -----------------------------
2025-01-27T17:55:27.0053621Z [[1mtardis.io.configuration.config_internal[0m][[1;33mWARNING[0m]  
2025-01-27T17:55:27.0054452Z 	Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default ([1mconfig_internal.py[0m:24)
2025-01-27T17:55:27.0055135Z ------------------------------ Captured log setup ------------------------------
2025-01-27T17:55:27.0055954Z WARNING  tardis.io.configuration.config_internal:config_internal.py:24 Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
2025-01-27T17:55:27.0056706Z CRITICAL root:config_internal.py:37 
2025-01-27T17:55:27.0057131Z ********************************************************************************
2025-01-27T17:55:27.0057334Z 
2025-01-27T17:55:27.0057626Z TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data
2025-01-27T17:55:27.0058010Z 
2025-01-27T17:55:27.0058255Z TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:
2025-01-27T17:55:27.0058591Z 
2025-01-27T17:55:27.0058756Z ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
2025-01-27T17:55:27.0059574Z  YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 
2025-01-27T17:55:27.0060105Z 
2025-01-27T17:55:27.0060262Z ********************************************************************************
2025-01-27T17:55:27.0060852Z _______________ ERROR at setup of test_elemental_number_density ________________
2025-01-27T17:55:27.0061293Z 
2025-01-27T17:55:27.0062371Z config_verysimple = {'tardis_config_version': 'v1.0', 'supernova': {'luminosity_requested': <Quantity 1.07688e+36 W>, 'time_explosion': <Q...: {'points': 1000, 'interpolate_shells': 0, 'compute': 'CPU'}}, 'config_dirname': 'tardis/io/configuration/tests/data'}
2025-01-27T17:55:27.0063098Z 
2025-01-27T17:55:27.0063196Z     @pytest.fixture(scope="function")
2025-01-27T17:55:27.0063476Z     def composition_instance(config_verysimple):
2025-01-27T17:55:27.0063834Z         time_explosion = config_verysimple.supernova.time_explosion.cgs
2025-01-27T17:55:27.0064266Z         geometry = parse_geometry_from_config(config_verysimple, time_explosion)
2025-01-27T17:55:27.0064650Z >       atom_data = parse_atom_data(config_verysimple)
2025-01-27T17:55:27.0064845Z 
2025-01-27T17:55:27.0064973Z tardis/model/matter/tests/test_composition.py:15: 
2025-01-27T17:55:27.0065284Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0065623Z tardis/io/model/parse_atom_data.py:43: in parse_atom_data
2025-01-27T17:55:27.0065958Z     atom_data = AtomData.from_hdf(atom_data_fname)
2025-01-27T17:55:27.0066248Z tardis/io/atom_data/base.py:190: in from_hdf
2025-01-27T17:55:27.0066519Z     fname = resolve_atom_data_fname(fname)
2025-01-27T17:55:27.0066795Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0067155Z 
2025-01-27T17:55:27.0067273Z fname = PosixPath('kurucz_cd23_chianti_H_He.h5')
2025-01-27T17:55:27.0067470Z 
2025-01-27T17:55:27.0067563Z     def resolve_atom_data_fname(fname):
2025-01-27T17:55:27.0067797Z         """
2025-01-27T17:55:27.0068268Z         Check where if atom data HDF file is available on disk, can be downloaded or does not exist
2025-01-27T17:55:27.0068649Z     
2025-01-27T17:55:27.0068813Z         Parameters
2025-01-27T17:55:27.0068999Z         ----------
2025-01-27T17:55:27.0069182Z         fname : Path
2025-01-27T17:55:27.0069505Z             name or path of atom data HDF file
2025-01-27T17:55:27.0069744Z     
2025-01-27T17:55:27.0069900Z         Returns
2025-01-27T17:55:27.0070076Z         -------
2025-01-27T17:55:27.0070253Z             : Path
2025-01-27T17:55:27.0070436Z             resolved fpath
2025-01-27T17:55:27.0070639Z         """
2025-01-27T17:55:27.0070812Z         fname = Path(fname)
2025-01-27T17:55:27.0071032Z         if os.path.exists(fname):
2025-01-27T17:55:27.0071261Z             return fname
2025-01-27T17:55:27.0071454Z     
2025-01-27T17:55:27.0071645Z         fname = Path(fname.stem).with_suffix(".h5")
2025-01-27T17:55:27.0071953Z         fpath = Path(os.path.join(get_data_dir(), fname))
2025-01-27T17:55:27.0072246Z         if os.path.exists(fpath):
2025-01-27T17:55:27.0072474Z             logger.info(
2025-01-27T17:55:27.0072814Z                 f"\n\tAtom Data {fname} not found in local path.\n\tExists in TARDIS Data repo {fpath}"
2025-01-27T17:55:27.0073176Z             )
2025-01-27T17:55:27.0073358Z             return fpath
2025-01-27T17:55:27.0073556Z     
2025-01-27T17:55:27.0073724Z         atom_data_name = fname.stem
2025-01-27T17:55:27.0073985Z         atom_repo_config = get_atomic_repo_config()
2025-01-27T17:55:27.0074267Z         if atom_data_name in atom_repo_config:
2025-01-27T17:55:27.0074515Z >           raise OSError(
2025-01-27T17:55:27.0074868Z                 f"Atom Data {fname} not found in path or in TARDIS data repo - it is available as download:\n"
2025-01-27T17:55:27.0075624Z                 f"from tardis.io.atom_data import download_atom_data\n"
2025-01-27T17:55:27.0076180Z                 f"download_atom_data('{atom_data_name}')"
2025-01-27T17:55:27.0076615Z             )
2025-01-27T17:55:27.0077467Z E           OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0078340Z E           from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0078895Z E           download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0079250Z 
2025-01-27T17:55:27.0079405Z tardis/io/atom_data/util.py:42: OSError
2025-01-27T17:55:27.0080005Z ___ ERROR at setup of test_calculate_mass_fraction_at_time[time_explosion0] ____
2025-01-27T17:55:27.0080474Z 
2025-01-27T17:55:27.0081590Z config_verysimple = {'tardis_config_version': 'v1.0', 'supernova': {'luminosity_requested': <Quantity 1.07688e+36 W>, 'time_explosion': <Q...: {'points': 1000, 'interpolate_shells': 0, 'compute': 'CPU'}}, 'config_dirname': 'tardis/io/configuration/tests/data'}
2025-01-27T17:55:27.0082694Z 
2025-01-27T17:55:27.0082797Z     @pytest.fixture(scope="function")
2025-01-27T17:55:27.0083078Z     def composition_instance(config_verysimple):
2025-01-27T17:55:27.0083444Z         time_explosion = config_verysimple.supernova.time_explosion.cgs
2025-01-27T17:55:27.0083892Z         geometry = parse_geometry_from_config(config_verysimple, time_explosion)
2025-01-27T17:55:27.0084278Z >       atom_data = parse_atom_data(config_verysimple)
2025-01-27T17:55:27.0084479Z 
2025-01-27T17:55:27.0084607Z tardis/model/matter/tests/test_composition.py:15: 
2025-01-27T17:55:27.0084920Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0085256Z tardis/io/model/parse_atom_data.py:43: in parse_atom_data
2025-01-27T17:55:27.0085585Z     atom_data = AtomData.from_hdf(atom_data_fname)
2025-01-27T17:55:27.0085876Z tardis/io/atom_data/base.py:190: in from_hdf
2025-01-27T17:55:27.0086150Z     fname = resolve_atom_data_fname(fname)
2025-01-27T17:55:27.0086431Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0086633Z 
2025-01-27T17:55:27.0086763Z fname = PosixPath('kurucz_cd23_chianti_H_He.h5')
2025-01-27T17:55:27.0087362Z 
2025-01-27T17:55:27.0087461Z     def resolve_atom_data_fname(fname):
2025-01-27T17:55:27.0087701Z         """
2025-01-27T17:55:27.0088022Z         Check where if atom data HDF file is available on disk, can be downloaded or does not exist
2025-01-27T17:55:27.0088876Z     
2025-01-27T17:55:27.0089156Z         Parameters
2025-01-27T17:55:27.0089376Z         ----------
2025-01-27T17:55:27.0089565Z         fname : Path
2025-01-27T17:55:27.0089776Z             name or path of atom data HDF file
2025-01-27T17:55:27.0090026Z     
2025-01-27T17:55:27.0090186Z         Returns
2025-01-27T17:55:27.0090363Z         -------
2025-01-27T17:55:27.0090537Z             : Path
2025-01-27T17:55:27.0090722Z             resolved fpath
2025-01-27T17:55:27.0090926Z         """
2025-01-27T17:55:27.0091100Z         fname = Path(fname)
2025-01-27T17:55:27.0091323Z         if os.path.exists(fname):
2025-01-27T17:55:27.0091554Z             return fname
2025-01-27T17:55:27.0091751Z     
2025-01-27T17:55:27.0091945Z         fname = Path(fname.stem).with_suffix(".h5")
2025-01-27T17:55:27.0092254Z         fpath = Path(os.path.join(get_data_dir(), fname))
2025-01-27T17:55:27.0092540Z         if os.path.exists(fpath):
2025-01-27T17:55:27.0092769Z             logger.info(
2025-01-27T17:55:27.0093207Z                 f"\n\tAtom Data {fname} not found in local path.\n\tExists in TARDIS Data repo {fpath}"
2025-01-27T17:55:27.0093570Z             )
2025-01-27T17:55:27.0093746Z             return fpath
2025-01-27T17:55:27.0093936Z     
2025-01-27T17:55:27.0094113Z         atom_data_name = fname.stem
2025-01-27T17:55:27.0094376Z         atom_repo_config = get_atomic_repo_config()
2025-01-27T17:55:27.0094656Z         if atom_data_name in atom_repo_config:
2025-01-27T17:55:27.0094912Z >           raise OSError(
2025-01-27T17:55:27.0095268Z                 f"Atom Data {fname} not found in path or in TARDIS data repo - it is available as download:\n"
2025-01-27T17:55:27.0095715Z                 f"from tardis.io.atom_data import download_atom_data\n"
2025-01-27T17:55:27.0096045Z                 f"download_atom_data('{atom_data_name}')"
2025-01-27T17:55:27.0096298Z             )
2025-01-27T17:55:27.0096695Z E           OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0097424Z E           from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0097763Z E           download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0097963Z 
2025-01-27T17:55:27.0098063Z tardis/io/atom_data/util.py:42: OSError
2025-01-27T17:55:27.0098423Z ___ ERROR at setup of test_calculate_mass_fraction_at_time[time_explosion1] ____
2025-01-27T17:55:27.0098699Z 
2025-01-27T17:55:27.0099351Z config_verysimple = {'tardis_config_version': 'v1.0', 'supernova': {'luminosity_requested': <Quantity 1.07688e+36 W>, 'time_explosion': <Q...: {'points': 1000, 'interpolate_shells': 0, 'compute': 'CPU'}}, 'config_dirname': 'tardis/io/configuration/tests/data'}
2025-01-27T17:55:27.0100074Z 
2025-01-27T17:55:27.0100174Z     @pytest.fixture(scope="function")
2025-01-27T17:55:27.0100458Z     def composition_instance(config_verysimple):
2025-01-27T17:55:27.0100820Z         time_explosion = config_verysimple.supernova.time_explosion.cgs
2025-01-27T17:55:27.0101263Z         geometry = parse_geometry_from_config(config_verysimple, time_explosion)
2025-01-27T17:55:27.0101648Z >       atom_data = parse_atom_data(config_verysimple)
2025-01-27T17:55:27.0101878Z 
2025-01-27T17:55:27.0102005Z tardis/model/matter/tests/test_composition.py:15: 
2025-01-27T17:55:27.0102313Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0102650Z tardis/io/model/parse_atom_data.py:43: in parse_atom_data
2025-01-27T17:55:27.0102982Z     atom_data = AtomData.from_hdf(atom_data_fname)
2025-01-27T17:55:27.0103281Z tardis/io/atom_data/base.py:190: in from_hdf
2025-01-27T17:55:27.0103554Z     fname = resolve_atom_data_fname(fname)
2025-01-27T17:55:27.0103999Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0104201Z 
2025-01-27T17:55:27.0104311Z fname = PosixPath('kurucz_cd23_chianti_H_He.h5')
2025-01-27T17:55:27.0104504Z 
2025-01-27T17:55:27.0104593Z     def resolve_atom_data_fname(fname):
2025-01-27T17:55:27.0104938Z         """
2025-01-27T17:55:27.0105256Z         Check where if atom data HDF file is available on disk, can be downloaded or does not exist
2025-01-27T17:55:27.0105636Z     
2025-01-27T17:55:27.0105799Z         Parameters
2025-01-27T17:55:27.0105983Z         ----------
2025-01-27T17:55:27.0106162Z         fname : Path
2025-01-27T17:55:27.0106379Z             name or path of atom data HDF file
2025-01-27T17:55:27.0106623Z     
2025-01-27T17:55:27.0106780Z         Returns
2025-01-27T17:55:27.0107063Z         -------
2025-01-27T17:55:27.0107241Z             : Path
2025-01-27T17:55:27.0107426Z             resolved fpath
2025-01-27T17:55:27.0107627Z         """
2025-01-27T17:55:27.0107806Z         fname = Path(fname)
2025-01-27T17:55:27.0108026Z         if os.path.exists(fname):
2025-01-27T17:55:27.0108257Z             return fname
2025-01-27T17:55:27.0108454Z     
2025-01-27T17:55:27.0108646Z         fname = Path(fname.stem).with_suffix(".h5")
2025-01-27T17:55:27.0108958Z         fpath = Path(os.path.join(get_data_dir(), fname))
2025-01-27T17:55:27.0109244Z         if os.path.exists(fpath):
2025-01-27T17:55:27.0109474Z             logger.info(
2025-01-27T17:55:27.0109814Z                 f"\n\tAtom Data {fname} not found in local path.\n\tExists in TARDIS Data repo {fpath}"
2025-01-27T17:55:27.0110178Z             )
2025-01-27T17:55:27.0110356Z             return fpath
2025-01-27T17:55:27.0110547Z     
2025-01-27T17:55:27.0110715Z         atom_data_name = fname.stem
2025-01-27T17:55:27.0110978Z         atom_repo_config = get_atomic_repo_config()
2025-01-27T17:55:27.0111264Z         if atom_data_name in atom_repo_config:
2025-01-27T17:55:27.0111517Z >           raise OSError(
2025-01-27T17:55:27.0111879Z                 f"Atom Data {fname} not found in path or in TARDIS data repo - it is available as download:\n"
2025-01-27T17:55:27.0112326Z                 f"from tardis.io.atom_data import download_atom_data\n"
2025-01-27T17:55:27.0112654Z                 f"download_atom_data('{atom_data_name}')"
2025-01-27T17:55:27.0112916Z             )
2025-01-27T17:55:27.0113314Z E           OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0113825Z E           from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0114154Z E           download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0114352Z 
2025-01-27T17:55:27.0114451Z tardis/io/atom_data/util.py:42: OSError
2025-01-27T17:55:27.0114785Z _________________ ERROR at setup of test_calculate_cell_masses _________________
2025-01-27T17:55:27.0115034Z 
2025-01-27T17:55:27.0115682Z config_verysimple = {'tardis_config_version': 'v1.0', 'supernova': {'luminosity_requested': <Quantity 1.07688e+36 W>, 'time_explosion': <Q...: {'points': 1000, 'interpolate_shells': 0, 'compute': 'CPU'}}, 'config_dirname': 'tardis/io/configuration/tests/data'}
2025-01-27T17:55:27.0116409Z 
2025-01-27T17:55:27.0116505Z     @pytest.fixture(scope="function")
2025-01-27T17:55:27.0116791Z     def composition_instance(config_verysimple):
2025-01-27T17:55:27.0117338Z         time_explosion = config_verysimple.supernova.time_explosion.cgs
2025-01-27T17:55:27.0117777Z         geometry = parse_geometry_from_config(config_verysimple, time_explosion)
2025-01-27T17:55:27.0118162Z >       atom_data = parse_atom_data(config_verysimple)
2025-01-27T17:55:27.0118363Z 
2025-01-27T17:55:27.0118484Z tardis/model/matter/tests/test_composition.py:15: 
2025-01-27T17:55:27.0118799Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0119140Z tardis/io/model/parse_atom_data.py:43: in parse_atom_data
2025-01-27T17:55:27.0119689Z     atom_data = AtomData.from_hdf(atom_data_fname)
2025-01-27T17:55:27.0119985Z tardis/io/atom_data/base.py:190: in from_hdf
2025-01-27T17:55:27.0120259Z     fname = resolve_atom_data_fname(fname)
2025-01-27T17:55:27.0120541Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0120842Z 
2025-01-27T17:55:27.0120957Z fname = PosixPath('kurucz_cd23_chianti_H_He.h5')
2025-01-27T17:55:27.0121147Z 
2025-01-27T17:55:27.0121242Z     def resolve_atom_data_fname(fname):
2025-01-27T17:55:27.0121478Z         """
2025-01-27T17:55:27.0121796Z         Check where if atom data HDF file is available on disk, can be downloaded or does not exist
2025-01-27T17:55:27.0122175Z     
2025-01-27T17:55:27.0122335Z         Parameters
2025-01-27T17:55:27.0122524Z         ----------
2025-01-27T17:55:27.0122709Z         fname : Path
2025-01-27T17:55:27.0122923Z             name or path of atom data HDF file
2025-01-27T17:55:27.0123168Z     
2025-01-27T17:55:27.0123325Z         Returns
2025-01-27T17:55:27.0123507Z         -------
2025-01-27T17:55:27.0123682Z             : Path
2025-01-27T17:55:27.0123871Z             resolved fpath
2025-01-27T17:55:27.0124070Z         """
2025-01-27T17:55:27.0124238Z         fname = Path(fname)
2025-01-27T17:55:27.0124457Z         if os.path.exists(fname):
2025-01-27T17:55:27.0124727Z             return fname
2025-01-27T17:55:27.0124924Z     
2025-01-27T17:55:27.0125115Z         fname = Path(fname.stem).with_suffix(".h5")
2025-01-27T17:55:27.0125421Z         fpath = Path(os.path.join(get_data_dir(), fname))
2025-01-27T17:55:27.0125702Z         if os.path.exists(fpath):
2025-01-27T17:55:27.0125931Z             logger.info(
2025-01-27T17:55:27.0126262Z                 f"\n\tAtom Data {fname} not found in local path.\n\tExists in TARDIS Data repo {fpath}"
2025-01-27T17:55:27.0126620Z             )
2025-01-27T17:55:27.0126800Z             return fpath
2025-01-27T17:55:27.0127183Z     
2025-01-27T17:55:27.0127467Z         atom_data_name = fname.stem
2025-01-27T17:55:27.0127748Z         atom_repo_config = get_atomic_repo_config()
2025-01-27T17:55:27.0128032Z         if atom_data_name in atom_repo_config:
2025-01-27T17:55:27.0128285Z >           raise OSError(
2025-01-27T17:55:27.0128638Z                 f"Atom Data {fname} not found in path or in TARDIS data repo - it is available as download:\n"
2025-01-27T17:55:27.0129089Z                 f"from tardis.io.atom_data import download_atom_data\n"
2025-01-27T17:55:27.0129412Z                 f"download_atom_data('{atom_data_name}')"
2025-01-27T17:55:27.0129666Z             )
2025-01-27T17:55:27.0130066Z E           OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0130572Z E           from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0130898Z E           download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0131094Z 
2025-01-27T17:55:27.0131189Z tardis/io/atom_data/util.py:42: OSError
2025-01-27T17:55:27.0131528Z ____________ ERROR at setup of test_calculate_elemental_cell_masses ____________
2025-01-27T17:55:27.0131790Z 
2025-01-27T17:55:27.0132433Z config_verysimple = {'tardis_config_version': 'v1.0', 'supernova': {'luminosity_requested': <Quantity 1.07688e+36 W>, 'time_explosion': <Q...: {'points': 1000, 'interpolate_shells': 0, 'compute': 'CPU'}}, 'config_dirname': 'tardis/io/configuration/tests/data'}
2025-01-27T17:55:27.0133161Z 
2025-01-27T17:55:27.0133259Z     @pytest.fixture(scope="function")
2025-01-27T17:55:27.0133538Z     def composition_instance(config_verysimple):
2025-01-27T17:55:27.0133893Z         time_explosion = config_verysimple.supernova.time_explosion.cgs
2025-01-27T17:55:27.0134325Z         geometry = parse_geometry_from_config(config_verysimple, time_explosion)
2025-01-27T17:55:27.0134708Z >       atom_data = parse_atom_data(config_verysimple)
2025-01-27T17:55:27.0134906Z 
2025-01-27T17:55:27.0135027Z tardis/model/matter/tests/test_composition.py:15: 
2025-01-27T17:55:27.0135476Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0135810Z tardis/io/model/parse_atom_data.py:43: in parse_atom_data
2025-01-27T17:55:27.0136138Z     atom_data = AtomData.from_hdf(atom_data_fname)
2025-01-27T17:55:27.0136427Z tardis/io/atom_data/base.py:190: in from_hdf
2025-01-27T17:55:27.0136806Z     fname = resolve_atom_data_fname(fname)
2025-01-27T17:55:27.0137278Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0137477Z 
2025-01-27T17:55:27.0137592Z fname = PosixPath('kurucz_cd23_chianti_H_He.h5')
2025-01-27T17:55:27.0137784Z 
2025-01-27T17:55:27.0137881Z     def resolve_atom_data_fname(fname):
2025-01-27T17:55:27.0138114Z         """
2025-01-27T17:55:27.0138427Z         Check where if atom data HDF file is available on disk, can be downloaded or does not exist
2025-01-27T17:55:27.0138808Z     
2025-01-27T17:55:27.0138970Z         Parameters
2025-01-27T17:55:27.0139153Z         ----------
2025-01-27T17:55:27.0139343Z         fname : Path
2025-01-27T17:55:27.0139556Z             name or path of atom data HDF file
2025-01-27T17:55:27.0139801Z     
2025-01-27T17:55:27.0139962Z         Returns
2025-01-27T17:55:27.0140137Z         -------
2025-01-27T17:55:27.0140311Z             : Path
2025-01-27T17:55:27.0140496Z             resolved fpath
2025-01-27T17:55:27.0140706Z         """
2025-01-27T17:55:27.0140879Z         fname = Path(fname)
2025-01-27T17:55:27.0141098Z         if os.path.exists(fname):
2025-01-27T17:55:27.0141326Z             return fname
2025-01-27T17:55:27.0141520Z     
2025-01-27T17:55:27.0141710Z         fname = Path(fname.stem).with_suffix(".h5")
2025-01-27T17:55:27.0142013Z         fpath = Path(os.path.join(get_data_dir(), fname))
2025-01-27T17:55:27.0142296Z         if os.path.exists(fpath):
2025-01-27T17:55:27.0142522Z             logger.info(
2025-01-27T17:55:27.0142853Z                 f"\n\tAtom Data {fname} not found in local path.\n\tExists in TARDIS Data repo {fpath}"
2025-01-27T17:55:27.0143213Z             )
2025-01-27T17:55:27.0143388Z             return fpath
2025-01-27T17:55:27.0143580Z     
2025-01-27T17:55:27.0143752Z         atom_data_name = fname.stem
2025-01-27T17:55:27.0144014Z         atom_repo_config = get_atomic_repo_config()
2025-01-27T17:55:27.0144307Z         if atom_data_name in atom_repo_config:
2025-01-27T17:55:27.0144557Z >           raise OSError(
2025-01-27T17:55:27.0144909Z                 f"Atom Data {fname} not found in path or in TARDIS data repo - it is available as download:\n"
2025-01-27T17:55:27.0145351Z                 f"from tardis.io.atom_data import download_atom_data\n"
2025-01-27T17:55:27.0145680Z                 f"download_atom_data('{atom_data_name}')"
2025-01-27T17:55:27.0145933Z             )
2025-01-27T17:55:27.0146322Z E           OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0146827Z E           from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0147264Z E           download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0147467Z 
2025-01-27T17:55:27.0147558Z tardis/io/atom_data/util.py:42: OSError
2025-01-27T17:55:27.0147831Z =================================== FAILURES ===================================
2025-01-27T17:55:27.0148186Z _____________________ test_calculate_sobolev_line_opacity ______________________
2025-01-27T17:55:27.0148437Z 
2025-01-27T17:55:27.0148668Z nb_simulation_verysimple = <tardis.simulation.base.Simulation object at 0x7f1f0b5b61e0>
2025-01-27T17:55:27.0149258Z regression_data = <tardis.tests.fixtures.regression_data.RegressionData object at 0x7f1f0b4b83b0>
2025-01-27T17:55:27.0149617Z 
2025-01-27T17:55:27.0149718Z     def test_calculate_sobolev_line_opacity(
2025-01-27T17:55:27.0150005Z         nb_simulation_verysimple, regression_data
2025-01-27T17:55:27.0150261Z     ):
2025-01-27T17:55:27.0150473Z         legacy_plasma = nb_simulation_verysimple.plasma
2025-01-27T17:55:27.0150743Z     
2025-01-27T17:55:27.0151063Z         actual = calculate_sobolev_line_opacity(
2025-01-27T17:55:27.0151326Z             legacy_plasma.lines,
2025-01-27T17:55:27.0151573Z             legacy_plasma.level_number_density,
2025-01-27T17:55:27.0151845Z             legacy_plasma.time_explosion,
2025-01-27T17:55:27.0152302Z             legacy_plasma.stimulated_emission_factor,
2025-01-27T17:55:27.0152563Z         )
2025-01-27T17:55:27.0152776Z >       expected = regression_data.sync_dataframe(actual)
2025-01-27T17:55:27.0152981Z 
2025-01-27T17:55:27.0153093Z tardis/opacities/tests/test_tau_sobolev.py:21: 
2025-01-27T17:55:27.0153396Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0153751Z tardis/tests/fixtures/regression_data.py:88: in sync_dataframe
2025-01-27T17:55:27.0154094Z     return pd.read_hdf(self.fpath, key=key)
2025-01-27T17:55:27.0154383Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0154581Z 
2025-01-27T17:55:27.0154972Z path_or_buf = '/home/runner/work/tardis/tardis/tardis-regression-data/test_tau_sobolev/test_calculate_sobolev_line_opacity.h5'
2025-01-27T17:55:27.0155580Z key = 'data', mode = 'r', errors = 'strict', where = None, start = None
2025-01-27T17:55:27.0155996Z stop = None, columns = None, iterator = False, chunksize = None, kwargs = {}
2025-01-27T17:55:27.0156337Z exists = False
2025-01-27T17:55:27.0156446Z 
2025-01-27T17:55:27.0156524Z     def read_hdf(
2025-01-27T17:55:27.0156723Z         path_or_buf: FilePath | HDFStore,
2025-01-27T17:55:27.0157058Z         key=None,
2025-01-27T17:55:27.0157247Z         mode: str = "r",
2025-01-27T17:55:27.0157454Z         errors: str = "strict",
2025-01-27T17:55:27.0157686Z         where: str | list | None = None,
2025-01-27T17:55:27.0157934Z         start: int | None = None,
2025-01-27T17:55:27.0158164Z         stop: int | None = None,
2025-01-27T17:55:27.0158399Z         columns: list[str] | None = None,
2025-01-27T17:55:27.0158644Z         iterator: bool = False,
2025-01-27T17:55:27.0158875Z         chunksize: int | None = None,
2025-01-27T17:55:27.0159100Z         **kwargs,
2025-01-27T17:55:27.0159277Z     ):
2025-01-27T17:55:27.0159436Z         """
2025-01-27T17:55:27.0159644Z         Read from the store, close it if we opened it.
2025-01-27T17:55:27.0159910Z     
2025-01-27T17:55:27.0160160Z         Retrieve pandas object stored in file, optionally based on where
2025-01-27T17:55:27.0160477Z         criteria.
2025-01-27T17:55:27.0160652Z     
2025-01-27T17:55:27.0165383Z         .. warning::
2025-01-27T17:55:27.0165614Z     
2025-01-27T17:55:27.0165899Z            Pandas uses PyTables for reading and writing HDF5 files, which allows
2025-01-27T17:55:27.0166368Z            serializing object-dtype data with pickle when using the "fixed" format.
2025-01-27T17:55:27.0166827Z            Loading pickled data received from untrusted sources can be unsafe.
2025-01-27T17:55:27.0167487Z     
2025-01-27T17:55:27.0167774Z            See: https://docs.python.org/3/library/pickle.html for more.
2025-01-27T17:55:27.0168105Z     
2025-01-27T17:55:27.0168272Z         Parameters
2025-01-27T17:55:27.0168465Z         ----------
2025-01-27T17:55:27.0168703Z         path_or_buf : str, path object, pandas.HDFStore
2025-01-27T17:55:27.0169088Z             Any valid string path is acceptable. Only supports the local file system,
2025-01-27T17:55:27.0169499Z             remote URLs and file-like objects are not supported.
2025-01-27T17:55:27.0169783Z     
2025-01-27T17:55:27.0170002Z             If you want to pass in a path object, pandas accepts any
2025-01-27T17:55:27.0170314Z             ``os.PathLike``.
2025-01-27T17:55:27.0170549Z     
2025-01-27T17:55:27.0170825Z             Alternatively, pandas accepts an open :class:`pandas.HDFStore` object.
2025-01-27T17:55:27.0171162Z     
2025-01-27T17:55:27.0171327Z         key : object, optional
2025-01-27T17:55:27.0171626Z             The group identifier in the store. Can be omitted if the HDF file
2025-01-27T17:55:27.0171961Z             contains a single pandas object.
2025-01-27T17:55:27.0172395Z         mode : {'r', 'r+', 'a'}, default 'r'
2025-01-27T17:55:27.0172705Z             Mode to use when opening the file. Ignored if path_or_buf is a
2025-01-27T17:55:27.0173037Z             :class:`pandas.HDFStore`. Default is 'r'.
2025-01-27T17:55:27.0173425Z         errors : str, default 'strict'
2025-01-27T17:55:27.0173735Z             Specifies how encoding and decoding errors are to be handled.
2025-01-27T17:55:27.0174115Z             See the errors argument for :func:`open` for a full list
2025-01-27T17:55:27.0174410Z             of options.
2025-01-27T17:55:27.0174613Z         where : list, optional
2025-01-27T17:55:27.0174855Z             A list of Term (or convertible) objects.
2025-01-27T17:55:27.0175115Z         start : int, optional
2025-01-27T17:55:27.0175346Z             Row number to start selection.
2025-01-27T17:55:27.0175594Z         stop  : int, optional
2025-01-27T17:55:27.0175815Z             Row number to stop selection.
2025-01-27T17:55:27.0176067Z         columns : list, optional
2025-01-27T17:55:27.0176306Z             A list of columns names to return.
2025-01-27T17:55:27.0176554Z         iterator : bool, optional
2025-01-27T17:55:27.0176786Z             Return an iterator object.
2025-01-27T17:55:27.0177245Z         chunksize : int, optional
2025-01-27T17:55:27.0177550Z             Number of rows to include in an iteration when using an iterator.
2025-01-27T17:55:27.0177871Z         **kwargs
2025-01-27T17:55:27.0178100Z             Additional keyword arguments passed to HDFStore.
2025-01-27T17:55:27.0178370Z     
2025-01-27T17:55:27.0178560Z         Returns
2025-01-27T17:55:27.0178738Z         -------
2025-01-27T17:55:27.0178909Z         object
2025-01-27T17:55:27.0179164Z             The selected object. Return type depends on the object stored.
2025-01-27T17:55:27.0179465Z     
2025-01-27T17:55:27.0179620Z         See Also
2025-01-27T17:55:27.0179798Z         --------
2025-01-27T17:55:27.0180037Z         DataFrame.to_hdf : Write a HDF file from a DataFrame.
2025-01-27T17:55:27.0180355Z         HDFStore : Low-level access to HDF files.
2025-01-27T17:55:27.0180602Z     
2025-01-27T17:55:27.0180759Z         Examples
2025-01-27T17:55:27.0180933Z         --------
2025-01-27T17:55:27.0181200Z         >>> df = pd.DataFrame([[1, 1.0, 'a']], columns=['x', 'y', 'z'])  # doctest: +SKIP
2025-01-27T17:55:27.0181562Z         >>> df.to_hdf('./store.h5', 'data')  # doctest: +SKIP
2025-01-27T17:55:27.0181875Z         >>> reread = pd.read_hdf('./store.h5')  # doctest: +SKIP
2025-01-27T17:55:27.0182142Z         """
2025-01-27T17:55:27.0182321Z         if mode not in ["r", "r+", "a"]:
2025-01-27T17:55:27.0182559Z             raise ValueError(
2025-01-27T17:55:27.0182834Z                 f"mode {mode} is not allowed while performing a read. "
2025-01-27T17:55:27.0183149Z                 f"Allowed modes are r, r+ and a."
2025-01-27T17:55:27.0183386Z             )
2025-01-27T17:55:27.0183560Z         # grab the scope
2025-01-27T17:55:27.0183771Z         if where is not None:
2025-01-27T17:55:27.0184012Z             where = _ensure_term(where, scope_level=1)
2025-01-27T17:55:27.0184263Z     
2025-01-27T17:55:27.0184446Z         if isinstance(path_or_buf, HDFStore):
2025-01-27T17:55:27.0184699Z             if not path_or_buf.is_open:
2025-01-27T17:55:27.0184997Z                 raise OSError("The HDFStore must be open for reading.")
2025-01-27T17:55:27.0185280Z     
2025-01-27T17:55:27.0185444Z             store = path_or_buf
2025-01-27T17:55:27.0185664Z             auto_close = False
2025-01-27T17:55:27.0185870Z         else:
2025-01-27T17:55:27.0186074Z             path_or_buf = stringify_path(path_or_buf)
2025-01-27T17:55:27.0186355Z             if not isinstance(path_or_buf, str):
2025-01-27T17:55:27.0186622Z                 raise NotImplementedError(
2025-01-27T17:55:27.0186931Z                     "Support for generic buffers has not been implemented."
2025-01-27T17:55:27.0187322Z                 )
2025-01-27T17:55:27.0187492Z             try:
2025-01-27T17:55:27.0187835Z                 exists = os.path.exists(path_or_buf)
2025-01-27T17:55:27.0188080Z     
2025-01-27T17:55:27.0188249Z             # if filepath is too long
2025-01-27T17:55:27.0188498Z             except (TypeError, ValueError):
2025-01-27T17:55:27.0188741Z                 exists = False
2025-01-27T17:55:27.0189053Z     
2025-01-27T17:55:27.0189211Z             if not exists:
2025-01-27T17:55:27.0189501Z >               raise FileNotFoundError(f"File {path_or_buf} does not exist")
2025-01-27T17:55:27.0190223Z E               FileNotFoundError: File /home/runner/work/tardis/tardis/tardis-regression-data/test_tau_sobolev/test_calculate_sobolev_line_opacity.h5 does not exist
2025-01-27T17:55:27.0190773Z 
2025-01-27T17:55:27.0191074Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/pandas/io/pytables.py:424: FileNotFoundError
2025-01-27T17:55:27.0191608Z ---------------------------- Captured stdout setup -----------------------------
2025-01-27T17:55:27.0192224Z [[1mtardis.io.model.parse_density_configuration[0m][[1;33mWARNING[0m]  
2025-01-27T17:55:27.0192941Z 	Number of density points larger than number of shells. Assuming inner point irrelevant ([1mparse_density_configuration.py[0m:114)
2025-01-27T17:55:27.0193530Z ---------------------------- Captured stderr setup -----------------------------
2025-01-27T17:55:27.0193775Z 
2025-01-27T17:55:27.0194105Z Iterations:████████████████████████████████████████████████████████████████                4/5 [00:12<00:02,  2.71s/it]
2025-01-27T17:55:27.0194384Z 
2025-01-27T17:55:27.0194617Z Packets:                                                                                   4030/? [00:12<00:00, 34528.26it/s][A
2025-01-27T17:55:27.0194992Z ------------------------------ Captured log setup ------------------------------
2025-01-27T17:55:27.0195744Z WARNING  tardis.io.model.parse_density_configuration:parse_density_configuration.py:114 Number of density points larger than number of shells. Assuming inner point irrelevant
2025-01-27T17:55:27.0196491Z _________________________ test_calculate_beta_sobolevs _________________________
2025-01-27T17:55:27.0196732Z 
2025-01-27T17:55:27.0197118Z nb_simulation_verysimple = <tardis.simulation.base.Simulation object at 0x7f1f0b5b61e0>
2025-01-27T17:55:27.0197746Z regression_data = <tardis.tests.fixtures.regression_data.RegressionData object at 0x7f1f0b6055e0>
2025-01-27T17:55:27.0198113Z 
2025-01-27T17:55:27.0198301Z     def test_calculate_beta_sobolevs(nb_simulation_verysimple, regression_data):
2025-01-27T17:55:27.0198696Z         legacy_plasma = nb_simulation_verysimple.plasma
2025-01-27T17:55:27.0198964Z     
2025-01-27T17:55:27.0199287Z         tau_sobolevs = calculate_sobolev_line_opacity(
2025-01-27T17:55:27.0199678Z             legacy_plasma.lines,
2025-01-27T17:55:27.0200029Z             legacy_plasma.level_number_density,
2025-01-27T17:55:27.0200495Z             legacy_plasma.time_explosion,
2025-01-27T17:55:27.0200904Z             legacy_plasma.stimulated_emission_factor,
2025-01-27T17:55:27.0201245Z         )
2025-01-27T17:55:27.0201620Z         actual = calculate_beta_sobolev(tau_sobolevs)
2025-01-27T17:55:27.0202049Z >       expected = regression_data.sync_ndarray(actual)
2025-01-27T17:55:27.0202273Z 
2025-01-27T17:55:27.0202509Z tardis/opacities/tests/test_tau_sobolev.py:35: 
2025-01-27T17:55:27.0202929Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0203384Z tardis/tests/fixtures/regression_data.py:111: in sync_ndarray
2025-01-27T17:55:27.0203870Z     return np.load(self.fpath)
2025-01-27T17:55:27.0204215Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-01-27T17:55:27.0204439Z 
2025-01-27T17:55:27.0204886Z file = PosixPath('/home/runner/work/tardis/tardis/tardis-regression-data/test_tau_sobolev/test_calculate_beta_sobolevs.npy')
2025-01-27T17:55:27.0205705Z mmap_mode = None, allow_pickle = False, fix_imports = True, encoding = 'ASCII'
2025-01-27T17:55:27.0206002Z 
2025-01-27T17:55:27.0206298Z     @set_module('numpy')
2025-01-27T17:55:27.0206717Z     def load(file, mmap_mode=None, allow_pickle=False, fix_imports=True,
2025-01-27T17:55:27.0217645Z              encoding='ASCII', *, max_header_size=format._MAX_HEADER_SIZE):
2025-01-27T17:55:27.0218183Z         """
2025-01-27T17:55:27.0218837Z         Load arrays or pickled objects from ``.npy``, ``.npz`` or pickled files.
2025-01-27T17:55:27.0219352Z     
2025-01-27T17:55:27.0219783Z         .. warning:: Loading files that contain object arrays uses the ``pickle``
2025-01-27T17:55:27.0220417Z                      module, which is not secure against erroneous or maliciously
2025-01-27T17:55:27.0221034Z                      constructed data. Consider passing ``allow_pickle=False`` to
2025-01-27T17:55:27.0221634Z                      load data that is known not to contain object arrays for the
2025-01-27T17:55:27.0222153Z                      safer handling of untrusted sources.
2025-01-27T17:55:27.0222550Z     
2025-01-27T17:55:27.0222803Z         Parameters
2025-01-27T17:55:27.0223096Z         ----------
2025-01-27T17:55:27.0223457Z         file : file-like object, string, or pathlib.Path
2025-01-27T17:55:27.0223973Z             The file to read. File-like objects must support the
2025-01-27T17:55:27.0224475Z             ``seek()`` and ``read()`` methods and must always
2025-01-27T17:55:27.0225003Z             be opened in binary mode.  Pickled files require that the
2025-01-27T17:55:27.0225578Z             file-like object support the ``readline()`` method as well.
2025-01-27T17:55:27.0226110Z         mmap_mode : {None, 'r+', 'r', 'w+', 'c'}, optional
2025-01-27T17:55:27.0226641Z             If not None, then memory-map the file, using the given mode (see
2025-01-27T17:55:27.0227401Z             `numpy.memmap` for a detailed description of the modes).  A
2025-01-27T17:55:27.0228017Z             memory-mapped array is kept on disk. However, it can be accessed
2025-01-27T17:55:27.0228659Z             and sliced like any ndarray.  Memory mapping is especially useful
2025-01-27T17:55:27.0229307Z             for accessing small fragments of large files without reading the
2025-01-27T17:55:27.0229821Z             entire file into memory.
2025-01-27T17:55:27.0230200Z         allow_pickle : bool, optional
2025-01-27T17:55:27.0230710Z             Allow loading pickled object arrays stored in npy files. Reasons for
2025-01-27T17:55:27.0231387Z             disallowing pickles include security, as loading pickled data can
2025-01-27T17:55:27.0232066Z             execute arbitrary code. If pickles are disallowed, loading object
2025-01-27T17:55:27.0232506Z             arrays will fail. Default: False
2025-01-27T17:55:27.0232744Z     
2025-01-27T17:55:27.0232920Z             .. versionchanged:: 1.16.3
2025-01-27T17:55:27.0233202Z                 Made default False in response to CVE-2019-6446.
2025-01-27T17:55:27.0233477Z     
2025-01-27T17:55:27.0233646Z         fix_imports : bool, optional
2025-01-27T17:55:27.0233978Z             Only useful when loading Python 2 generated pickled files on Python 3,
2025-01-27T17:55:27.0234427Z             which includes npy/npz files containing object arrays. If `fix_imports`
2025-01-27T17:55:27.0234865Z             is True, pickle will try to map the old Python 2 names to the new names
2025-01-27T17:55:27.0235192Z             used in Python 3.
2025-01-27T17:55:27.0235423Z         encoding : str, optional
2025-01-27T17:55:27.0235738Z             What encoding to use when reading Python 2 strings. Only useful when
2025-01-27T17:55:27.0236152Z             loading Python 2 generated pickled files in Python 3, which includes
2025-01-27T17:55:27.0236575Z             npy/npz files containing object arrays. Values other than 'latin1',
2025-01-27T17:55:27.0237129Z             'ASCII', and 'bytes' are not allowed, as they can corrupt numerical
2025-01-27T17:55:27.0237467Z             data. Default: 'ASCII'
2025-01-27T17:55:27.0237709Z         max_header_size : int, optional
2025-01-27T17:55:27.0238041Z             Maximum allowed size of the header.  Large headers may not be safe
2025-01-27T17:55:27.0238619Z             to load securely and thus require explicitly passing a larger value.
2025-01-27T17:55:27.0238982Z             See :py:func:`ast.literal_eval()` for details.
2025-01-27T17:55:27.0239348Z             This option is ignored when `allow_pickle` is passed.  In that case
2025-01-27T17:55:27.0239859Z             the file is by definition trusted and the limit is unnecessary.
2025-01-27T17:55:27.0240180Z     
2025-01-27T17:55:27.0240340Z         Returns
2025-01-27T17:55:27.0240522Z         -------
2025-01-27T17:55:27.0240720Z         result : array, tuple, dict, etc.
2025-01-27T17:55:27.0241046Z             Data stored in the file. For ``.npz`` files, the returned instance
2025-01-27T17:55:27.0241442Z             of NpzFile class must be closed to avoid leaking file descriptors.
2025-01-27T17:55:27.0241754Z     
2025-01-27T17:55:27.0241911Z         Raises
2025-01-27T17:55:27.0242085Z         ------
2025-01-27T17:55:27.0242262Z         OSError
2025-01-27T17:55:27.0242490Z             If the input file does not exist or cannot be read.
2025-01-27T17:55:27.0242771Z         UnpicklingError
2025-01-27T17:55:27.0243060Z             If ``allow_pickle=True``, but the file cannot be loaded as a pickle.
2025-01-27T17:55:27.0243387Z         ValueError
2025-01-27T17:55:27.0243675Z             The file contains an object array, but ``allow_pickle=False`` given.
2025-01-27T17:55:27.0243992Z         EOFError
2025-01-27T17:55:27.0244254Z             When calling ``np.load`` multiple times on the same file handle,
2025-01-27T17:55:27.0244586Z             if all data has already been read
2025-01-27T17:55:27.0244828Z     
2025-01-27T17:55:27.0244987Z         See Also
2025-01-27T17:55:27.0245165Z         --------
2025-01-27T17:55:27.0245368Z         save, savez, savez_compressed, loadtxt
2025-01-27T17:55:27.0245713Z         memmap : Create a memory-map to an array stored in a file on disk.
2025-01-27T17:55:27.0246131Z         lib.format.open_memmap : Create or load a memory-mapped ``.npy`` file.
2025-01-27T17:55:27.0246461Z     
2025-01-27T17:55:27.0246616Z         Notes
2025-01-27T17:55:27.0246786Z         -----
2025-01-27T17:55:27.0247246Z         - If the file contains pickle data, then whatever object is stored
2025-01-27T17:55:27.0247593Z           in the pickle is returned.
2025-01-27T17:55:27.0247902Z         - If the file is a ``.npy`` file, then a single array is returned.
2025-01-27T17:55:27.0248266Z         - If the file is a ``.npz`` file, then a dictionary-like object is
2025-01-27T17:55:27.0248661Z           returned, containing ``{filename: array}`` key-value pairs, one for
2025-01-27T17:55:27.0249000Z           each file in the archive.
2025-01-27T17:55:27.0249308Z         - If the file is a ``.npz`` file, the returned value supports the
2025-01-27T17:55:27.0249713Z           context manager protocol in a similar fashion to the open function::
2025-01-27T17:55:27.0250041Z     
2025-01-27T17:55:27.0250216Z             with load('foo.npz') as data:
2025-01-27T17:55:27.0250461Z                 a = data['a']
2025-01-27T17:55:27.0250667Z     
2025-01-27T17:55:27.0250908Z           The underlying file descriptor is closed when exiting the 'with'
2025-01-27T17:55:27.0251220Z           block.
2025-01-27T17:55:27.0251394Z     
2025-01-27T17:55:27.0251555Z         Examples
2025-01-27T17:55:27.0251731Z         --------
2025-01-27T17:55:27.0251931Z         Store data to disk, and load it again:
2025-01-27T17:55:27.0252172Z     
2025-01-27T17:55:27.0252380Z         >>> np.save('/tmp/123', np.array([[1, 2, 3], [4, 5, 6]]))
2025-01-27T17:55:27.0252668Z         >>> np.load('/tmp/123.npy')
2025-01-27T17:55:27.0252901Z         array([[1, 2, 3],
2025-01-27T17:55:27.0253103Z                [4, 5, 6]])
2025-01-27T17:55:27.0253293Z     
2025-01-27T17:55:27.0253498Z         Store compressed data to disk, and load it again:
2025-01-27T17:55:27.0253769Z     
2025-01-27T17:55:27.0253946Z         >>> a=np.array([[1, 2, 3], [4, 5, 6]])
2025-01-27T17:55:27.0254191Z         >>> b=np.array([1, 2])
2025-01-27T17:55:27.0254578Z         >>> np.savez('/tmp/123.npz', a=a, b=b)
2025-01-27T17:55:27.0254839Z         >>> data = np.load('/tmp/123.npz')
2025-01-27T17:55:27.0255077Z         >>> data['a']
2025-01-27T17:55:27.0255271Z         array([[1, 2, 3],
2025-01-27T17:55:27.0255578Z                [4, 5, 6]])
2025-01-27T17:55:27.0255771Z         >>> data['b']
2025-01-27T17:55:27.0255958Z         array([1, 2])
2025-01-27T17:55:27.0256150Z         >>> data.close()
2025-01-27T17:55:27.0256349Z     
2025-01-27T17:55:27.0256572Z         Mem-map the stored array, and then access the second row
2025-01-27T17:55:27.0256868Z         directly from disk:
2025-01-27T17:55:27.0257255Z     
2025-01-27T17:55:27.0257457Z         >>> X = np.load('/tmp/123.npy', mmap_mode='r')
2025-01-27T17:55:27.0257714Z         >>> X[1, :]
2025-01-27T17:55:27.0257903Z         memmap([4, 5, 6])
2025-01-27T17:55:27.0258094Z     
2025-01-27T17:55:27.0258250Z         """
2025-01-27T17:55:27.0258459Z         if encoding not in ('ASCII', 'latin1', 'bytes'):
2025-01-27T17:55:27.0258804Z             # The 'encoding' value for pickle also affects what encoding
2025-01-27T17:55:27.0259163Z             # the serialized binary data of NumPy arrays is loaded
2025-01-27T17:55:27.0259510Z             # in. Pickle does not pass on the encoding information to
2025-01-27T17:55:27.0259870Z             # NumPy. The unpickling code in numpy.core.multiarray is
2025-01-27T17:55:27.0260232Z             # written to assume that unicode data appearing where binary
2025-01-27T17:55:27.0260607Z             # should be is in 'latin1'. 'bytes' is also safe, as is 'ASCII'.
2025-01-27T17:55:27.0260902Z             #
2025-01-27T17:55:27.0261140Z             # Other encoding values can corrupt binary data, and we
2025-01-27T17:55:27.0261517Z             # purposefully disallow them. For the same reason, the errors=
2025-01-27T17:55:27.0261890Z             # argument is not exposed, as values other than 'strict'
2025-01-27T17:55:27.0262227Z             # result can similarly silently corrupt numerical data.
2025-01-27T17:55:27.0262609Z             raise ValueError("encoding must be 'ASCII', 'latin1', or 'bytes'")
2025-01-27T17:55:27.0262924Z     
2025-01-27T17:55:27.0263172Z         pickle_kwargs = dict(encoding=encoding, fix_imports=fix_imports)
2025-01-27T17:55:27.0263488Z     
2025-01-27T17:55:27.0263677Z         with contextlib.ExitStack() as stack:
2025-01-27T17:55:27.0263941Z             if hasattr(file, 'read'):
2025-01-27T17:55:27.0264176Z                 fid = file
2025-01-27T17:55:27.0264387Z                 own_fid = False
2025-01-27T17:55:27.0264600Z             else:
2025-01-27T17:55:27.0264845Z >               fid = stack.enter_context(open(os_fspath(file), "rb"))
2025-01-27T17:55:27.0265549Z E               FileNotFoundError: [Errno 2] No such file or directory: '/home/runner/work/tardis/tardis/tardis-regression-data/test_tau_sobolev/test_calculate_beta_sobolevs.npy'
2025-01-27T17:55:27.0266114Z 
2025-01-27T17:55:27.0266394Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/numpy/lib/npyio.py:427: FileNotFoundError
2025-01-27T17:55:27.0266878Z =============================== warnings summary ===============================
2025-01-27T17:55:27.0267378Z tardis/io/configuration/config_validator.py:6
2025-01-27T17:55:27.0267681Z tardis/io/configuration/config_validator.py:6
2025-01-27T17:55:27.0268177Z   /home/runner/work/tardis/tardis/tardis/io/configuration/config_validator.py:6: DeprecationWarning:
2025-01-27T17:55:27.0268644Z   
2025-01-27T17:55:27.0269847Z   jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
2025-01-27T17:55:27.0271034Z 
2025-01-27T17:55:27.0271269Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22
2025-01-27T17:55:27.0272123Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22: DeprecationWarning:
2025-01-27T17:55:27.0272629Z   
2025-01-27T17:55:27.0272874Z   Jupyter is migrating its paths to use standard platformdirs
2025-01-27T17:55:27.0273424Z   given by the platformdirs library.  To remove this warning and
2025-01-27T17:55:27.0273823Z   see the appropriate new directories, set the environment variable
2025-01-27T17:55:27.0274219Z   `JUPYTER_PLATFORM_DIRS=1` and then run `jupyter --paths`.
2025-01-27T17:55:27.0274597Z   The use of platformdirs will be the default in `jupyter_core` v6
2025-01-27T17:55:27.0274831Z 
2025-01-27T17:55:27.0274985Z tardis/io/tests/test_HDFWriter.py::test_multi_index_write
2025-01-27T17:55:27.0275473Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-01-27T17:55:27.0276021Z   /home/runner/work/tardis/tardis/tardis/io/util.py:276: PerformanceWarning:
2025-01-27T17:55:27.0276385Z   
2025-01-27T17:55:27.0276534Z   
2025-01-27T17:55:27.0276821Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-01-27T17:55:27.0277534Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-01-27T17:55:27.0277880Z 
2025-01-27T17:55:27.0278072Z tardis/io/tests/test_model_reader.py::test_read_cmfgen_isotope_abundances
2025-01-27T17:55:27.0278553Z tardis/plasma/tests/test_tardis_model_density_config.py::test_electron_densities
2025-01-27T17:55:27.0279079Z tardis/plasma/tests/test_tardis_model_density_config.py::test_isotope_number_densities
2025-01-27T17:55:27.0279575Z tardis/plasma/tests/test_tardis_model_density_config.py::test_t_rad
2025-01-27T17:55:27.0280133Z   /home/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:82: DeprecationWarning:
2025-01-27T17:55:27.0280590Z   
2025-01-27T17:55:27.0280790Z   The current CMFGEN model parser is deprecated
2025-01-27T17:55:27.0280982Z 
2025-01-27T17:55:27.0281103Z tardis/io/tests/test_model_reader.py: 1 warning
2025-01-27T17:55:27.0281463Z tardis/plasma/tests/test_tardis_model_density_config.py: 9 warnings
2025-01-27T17:55:27.0282017Z   /home/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:40: DeprecationWarning:
2025-01-27T17:55:27.0282478Z   
2025-01-27T17:55:27.0282674Z   The current CMFGEN model parser is deprecated
2025-01-27T17:55:27.0282859Z 
2025-01-27T17:55:27.0283066Z tardis/model/tests/test_base.py::TestModelFromPaper1Config::test_abundances
2025-01-27T17:55:27.0283702Z   /home/runner/work/tardis/tardis/tardis/transport/montecarlo/montecarlo_main_loop.py:123: NumbaTypeSafetyWarning:
2025-01-27T17:55:27.0284216Z   
2025-01-27T17:55:27.0284636Z   [1m[1m[1munsafe cast from uint64 to int64. Precision may be lost.[0m[0m[0m
2025-01-27T17:55:27.0284908Z 
2025-01-27T17:55:27.0285009Z tardis/model/tests/test_base.py: 6 warnings
2025-01-27T17:55:27.0285303Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-01-27T17:55:27.0285678Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-01-27T17:55:27.0286196Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:50: DeprecationWarning:
2025-01-27T17:55:27.0286613Z   
2025-01-27T17:55:27.0286804Z   v_inner_boundary < 0, assuming default value
2025-01-27T17:55:27.0287097Z 
2025-01-27T17:55:27.0287207Z tardis/model/tests/test_base.py: 6 warnings
2025-01-27T17:55:27.0287498Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-01-27T17:55:27.0287861Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-01-27T17:55:27.0288372Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:61: DeprecationWarning:
2025-01-27T17:55:27.0288789Z   
2025-01-27T17:55:27.0288971Z   v_outer_boundary < 0, assuming default value
2025-01-27T17:55:27.0289160Z 
2025-01-27T17:55:27.0289611Z tardis/plasma/equilibrium/tests/test_level_populations.py::TestLevelPopulationSolver::test_solve[collisional_rate_solver0-radiative_transitions0]
2025-01-27T17:55:27.0290566Z   /home/runner/work/tardis/tardis/tardis/plasma/equilibrium/level_populations.py:65: FutureWarning:
2025-01-27T17:55:27.0291017Z   
2025-01-27T17:55:27.0291378Z   A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
2025-01-27T17:55:27.0292278Z   The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
2025-01-27T17:55:27.0292862Z   
2025-01-27T17:55:27.0293465Z   For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
2025-01-27T17:55:27.0294063Z 
2025-01-27T17:55:27.0294217Z tardis/plasma/tests/test_complete_plasmas.py: 20 warnings
2025-01-27T17:55:27.0294726Z   /home/runner/work/tardis/tardis/tardis/plasma/tests/test_complete_plasmas.py:197: UserWarning:
2025-01-27T17:55:27.0295171Z   
2025-01-27T17:55:27.0295343Z   Property "atomic_mass" not found
2025-01-27T17:55:27.0295503Z 
2025-01-27T17:55:27.0295934Z tardis/plasma/tests/test_complete_plasmas.py::TestPlasma::test_plasma_properties[radiative_rates_type:detailed-w_epsilon:1e-10-j_blues_norm_factor]
2025-01-27T17:55:27.0296817Z tardis/plasma/tests/test_complete_plasmas.py::TestPlasma::test_plasma_properties[radiative_rates_type:detailed-j_blues_norm_factor]
2025-01-27T17:55:27.0297760Z   /home/runner/work/tardis/tardis/tardis/plasma/tests/test_complete_plasmas.py:197: UserWarning:
2025-01-27T17:55:27.0298201Z   
2025-01-27T17:55:27.0298398Z   Property "j_blues_norm_factor" not found
2025-01-27T17:55:27.0298584Z 
2025-01-27T17:55:27.0298998Z tardis/plasma/tests/test_complete_plasmas.py::TestPlasma::test_plasma_properties[radiative_rates_type:detailed-w_epsilon:1e-10-j_blue_estimator]
2025-01-27T17:55:27.0299849Z tardis/plasma/tests/test_complete_plasmas.py::TestPlasma::test_plasma_properties[radiative_rates_type:detailed-j_blue_estimator]
2025-01-27T17:55:27.0300574Z   /home/runner/work/tardis/tardis/tardis/plasma/tests/test_complete_plasmas.py:197: UserWarning:
2025-01-27T17:55:27.0301000Z   
2025-01-27T17:55:27.0301173Z   Property "j_blue_estimator" not found
2025-01-27T17:55:27.0301355Z 
2025-01-27T17:55:27.0301736Z tardis/plasma/tests/test_complete_plasmas.py::TestPlasma::test_plasma_properties[radiative_rates_type:detailed-w_epsilon:1e-10-volume]
2025-01-27T17:55:27.0302559Z tardis/plasma/tests/test_complete_plasmas.py::TestPlasma::test_plasma_properties[radiative_rates_type:detailed-volume]
2025-01-27T17:55:27.0303248Z   /home/runner/work/tardis/tardis/tardis/plasma/tests/test_complete_plasmas.py:197: UserWarning:
2025-01-27T17:55:27.0303674Z   
2025-01-27T17:55:27.0303850Z   Property "volume" not found
2025-01-27T17:55:27.0304007Z 
2025-01-27T17:55:27.0304400Z tardis/plasma/tests/test_complete_plasmas.py::TestPlasma::test_plasma_properties[radiative_rates_type:detailed-w_epsilon:1e-10-r_inner]
2025-01-27T17:55:27.0305209Z tardis/plasma/tests/test_complete_plasmas.py::TestPlasma::test_plasma_properties[radiative_rates_type:detailed-r_inner]
2025-01-27T17:55:27.0305896Z   /home/runner/work/tardis/tardis/tardis/plasma/tests/test_complete_plasmas.py:197: UserWarning:
2025-01-27T17:55:27.0306323Z   
2025-01-27T17:55:27.0306492Z   Property "r_inner" not found
2025-01-27T17:55:27.0306645Z 
2025-01-27T17:55:27.0306859Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3750]
2025-01-27T17:55:27.0307452Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3850]
2025-01-27T17:55:27.0307945Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3900]
2025-01-27T17:55:27.0308465Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:71: UserWarning:
2025-01-27T17:55:27.0308851Z   
2025-01-27T17:55:27.0309126Z   Requesting inner boundary below inner shell. Extrapolating the inner cell
2025-01-27T17:55:27.0309404Z 
2025-01-27T17:55:27.0309743Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-01-27T17:55:27.0310232Z   /home/runner/work/tardis/tardis/tardis/spectrum/base.py:70: UserWarning:
2025-01-27T17:55:27.0310579Z   
2025-01-27T17:55:27.0310985Z   SpectrumSolver.spectrum_virtual_packets is zero. Please run the montecarlo simulation with no_of_virtual_packets > 0
2025-01-27T17:55:27.0311520Z 
2025-01-27T17:55:27.0311726Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-01-27T17:55:27.0312211Z   /home/runner/work/tardis/tardis/tardis/spectrum/base.py:111: UserWarning:
2025-01-27T17:55:27.0312559Z   
2025-01-27T17:55:27.0312986Z   SpectrumSolver.integrator: The FormalIntegrator is not yet available.Please run the montecarlo simulation at least once.
2025-01-27T17:55:27.0313414Z 
2025-01-27T17:55:27.0313624Z tardis/transport/montecarlo/tests/test_vpacket.py::test_trace_vpacket_volley
2025-01-27T17:55:27.0314040Z   <string>:3: NumbaPendingDeprecationWarning:
2025-01-27T17:55:27.0314304Z   
2025-01-27T17:55:27.0315444Z   [1m[1mCode using Numba extension API maybe depending on 'old_style' error-capturing, which is deprecated and will be replaced by 'new_style' in a future release. See details at https://numba.readthedocs.io/en/latest/reference/deprecation.html#deprecation-of-old-style-numba-captured-errors
2025-01-27T17:55:27.0316463Z   Exception origin:
2025-01-27T17:55:27.0316834Z     File "/home/runner/micromamba/envs/tardis/lib/python3.12/inspect.py", line 3180, in _bind
2025-01-27T17:55:27.0317357Z       raise TypeError(msg) from None
2025-01-27T17:55:27.0317615Z   [0m[0m
2025-01-27T17:55:27.0317711Z 
2025-01-27T17:55:27.0318040Z tardis/visualization/tools/tests/test_sdec_plot.py::TestSDECPlotter::test_mpl_image[plotter_generate_plot_mpl4]
2025-01-27T17:55:27.0318724Z   /home/runner/work/tardis/tardis/tardis/visualization/tools/sdec_plot.py:1225: RuntimeWarning:
2025-01-27T17:55:27.0319155Z   
2025-01-27T17:55:27.0320090Z   More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
2025-01-27T17:55:27.0321016Z 
2025-01-27T17:55:27.0321369Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0322143Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0322909Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0323670Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0324430Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0325194Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0325964Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-01-27T17:55:27.0326469Z   
2025-01-27T17:55:27.0326747Z   Passing unrecognized arguments to super(Checkbox).__init__(icon='lock').
2025-01-27T17:55:27.0327288Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-01-27T17:55:27.0327781Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-01-27T17:55:27.0328104Z 
2025-01-27T17:55:27.0328449Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0329215Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0329981Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-01-27T17:55:27.0330603Z   
2025-01-27T17:55:27.0330867Z   Passing unrecognized arguments to super(FloatText).__init__(min=0).
2025-01-27T17:55:27.0331296Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-01-27T17:55:27.0331889Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-01-27T17:55:27.0332273Z 
2025-01-27T17:55:27.0332628Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-01-27T17:55:27.0333398Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-01-27T17:55:27.0333895Z   
2025-01-27T17:55:27.0334152Z   Passing unrecognized arguments to super(HTML).__init__(indent=True).
2025-01-27T17:55:27.0334582Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-01-27T17:55:27.0335074Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-01-27T17:55:27.0335393Z 
2025-01-27T17:55:27.0335816Z tardis/visualization/widgets/tests/test_line_info.py::TestLineInfoWidgetData::test_get_species_interactions[wavelength_range0-packet_out_nu]
2025-01-27T17:55:27.0336647Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/qgridnext/grid.py:825: DeprecationWarning:
2025-01-27T17:55:27.0337321Z   
2025-01-27T17:55:27.0337683Z   QgridWidget._grid_options_changed is deprecated in traitlets 4.1: use @observe and @unobserve instead.
2025-01-27T17:55:27.0338046Z 
2025-01-27T17:55:27.0338300Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-01-27T17:55:27.0338841Z   /home/runner/work/tardis/tardis/tardis/io/util.py:289: PerformanceWarning:
2025-01-27T17:55:27.0339200Z   
2025-01-27T17:55:27.0339354Z   
2025-01-27T17:55:27.0339644Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-01-27T17:55:27.0340191Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-01-27T17:55:27.0340528Z 
2025-01-27T17:55:27.0340784Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-01-27T17:55:27.0341328Z   /home/runner/work/tardis/tardis/tardis/io/util.py:292: PerformanceWarning:
2025-01-27T17:55:27.0341684Z   
2025-01-27T17:55:27.0341837Z   
2025-01-27T17:55:27.0342116Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-01-27T17:55:27.0342575Z   map directly to c-types [inferred_type->mixed,key->values] [items->None]
2025-01-27T17:55:27.0342839Z 
2025-01-27T17:55:27.0343090Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-01-27T17:55:27.0343668Z   /home/runner/work/tardis/tardis/tardis/spectrum/formal_integral.py:398: UserWarning:
2025-01-27T17:55:27.0344067Z   
2025-01-27T17:55:27.0344342Z   The number of interpolate_shells was not specified. The value was set to 80.
2025-01-27T17:55:27.0344624Z 
2025-01-27T17:55:27.0344807Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-01-27T17:55:27.0345078Z 
2025-01-27T17:55:27.0345242Z ---------- coverage: platform linux, python 3.12.4-final-0 -----------
2025-01-27T17:55:27.0345609Z Coverage HTML written to dir coverage_html_report
2025-01-27T17:55:27.0345905Z Coverage XML written to file coverage.xml
2025-01-27T17:55:27.0346084Z 
2025-01-27T17:55:27.0346210Z =========================== short test summary info ============================
2025-01-27T17:55:27.0347254Z FAILED tardis/opacities/tests/test_tau_sobolev.py::test_calculate_sobolev_line_opacity - FileNotFoundError: File /home/runner/work/tardis/tardis/tardis-regression-data/test_tau_sobolev/test_calculate_sobolev_line_opacity.h5 does not exist
2025-01-27T17:55:27.0348801Z FAILED tardis/opacities/tests/test_tau_sobolev.py::test_calculate_beta_sobolevs - FileNotFoundError: [Errno 2] No such file or directory: '/home/runner/work/tardis/tardis/tardis-regression-data/test_tau_sobolev/test_calculate_beta_sobolevs.npy'
2025-01-27T17:55:27.0350319Z ERROR tardis/model/matter/tests/test_composition.py::test_elemental_mass_fraction - OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0351177Z from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0351490Z download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0352235Z ERROR tardis/model/matter/tests/test_composition.py::test_elemental_number_density - OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0352987Z from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0353292Z download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0354104Z ERROR tardis/model/matter/tests/test_composition.py::test_calculate_mass_fraction_at_time[time_explosion0] - OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0354927Z from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0355227Z download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0356036Z ERROR tardis/model/matter/tests/test_composition.py::test_calculate_mass_fraction_at_time[time_explosion1] - OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0356861Z from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0357346Z download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0358080Z ERROR tardis/model/matter/tests/test_composition.py::test_calculate_cell_masses - OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0358820Z from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0359150Z download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0359913Z ERROR tardis/model/matter/tests/test_composition.py::test_calculate_elemental_cell_masses - OSError: Atom Data kurucz_cd23_chianti_H_He.h5 not found in path or in TARDIS data repo - it is available as download:
2025-01-27T17:55:27.0360693Z from tardis.io.atom_data import download_atom_data
2025-01-27T17:55:27.0360994Z download_atom_data('kurucz_cd23_chianti_H_He')
2025-01-27T17:55:27.0361464Z = 2 failed, 1436 passed, 329 skipped, 2 deselected, 19 xfailed, 8 xpassed, 91 warnings, 6 errors in 753.20s (0:12:33) =
2025-01-27T17:55:29.1298618Z ##[error]Process completed with exit code 1.
