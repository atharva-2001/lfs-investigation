2025-02-21T12:39:32.8530710Z ##[group]Run pytest tardis --tardis-regression-data=/Users/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"
2025-02-21T12:39:32.8531810Z [36;1mpytest tardis --tardis-regression-data=/Users/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"[0m
2025-02-21T12:39:32.8602160Z shell: /bin/bash -l {0}
2025-02-21T12:39:32.8602380Z env:
2025-02-21T12:39:32.8602540Z   CACHE_NUMBER: 0
2025-02-21T12:39:32.8603070Z   PYTEST_FLAGS: --tardis-regression-data=/Users/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append
2025-02-21T12:39:32.8603610Z   CODECOV_TOKEN: 
2025-02-21T12:39:32.8603800Z   MAMBA_ROOT_PREFIX: /Users/runner/micromamba
2025-02-21T12:39:32.8604070Z   MAMBA_EXE: /Users/runner/micromamba-bin/micromamba
2025-02-21T12:39:32.8604350Z   CONDARC: /Users/runner/work/_temp/setup-micromamba/.condarc
2025-02-21T12:39:32.8604710Z ##[endgroup]
2025-02-21T12:39:48.3063950Z ============================= test session starts ==============================
2025-02-21T12:39:48.3064970Z platform darwin -- Python 3.12.4, pytest-8.2.2, pluggy-1.5.0
2025-02-21T12:39:48.3065400Z rootdir: /Users/runner/work/tardis/tardis
2025-02-21T12:39:48.3065740Z configfile: pyproject.toml
2025-02-21T12:39:48.3066150Z plugins: cov-5.0.0, html-4.1.1, metadata-3.1.1, doctestplus-1.2.1, anyio-4.4.0
2025-02-21T12:39:48.3066590Z collected 1796 items / 2 deselected / 1794 selected
2025-02-21T12:39:48.3066820Z 
2025-02-21T12:39:51.9960320Z tardis/energy_input/tests/test_energy_source.py ..xxx                    [  0%]
2025-02-21T12:39:54.0001480Z tardis/energy_input/tests/test_gamma_ray_channel.py ...........          [  0%]
2025-02-21T12:39:55.3381160Z tardis/energy_input/tests/test_gamma_ray_grid.py xx.                     [  1%]
2025-02-21T12:39:56.7393760Z tardis/energy_input/tests/test_gamma_ray_interactions.py xx....          [  1%]
2025-02-21T12:39:56.7454150Z tardis/energy_input/tests/test_gamma_ray_packet_source.py sssssssss      [  1%]
2025-02-21T12:39:57.9382720Z tardis/energy_input/tests/test_util.py .....xxxx.....                    [  2%]
2025-02-21T12:39:58.2284410Z tardis/grid/tests/test_grid.py .                                         [  2%]
2025-02-21T12:39:58.2321260Z tardis/gui/tests/test_gui.py s                                           [  2%]
2025-02-21T12:40:01.4786910Z tardis/io/configuration/tests/test_config_reader.py ...........          [  3%]
2025-02-21T12:40:01.4888540Z tardis/io/configuration/tests/test_configuration_namespace.py .........  [  3%]
2025-02-21T12:40:01.5089340Z tardis/io/logger/tests/test_logging.py ssssssssssssssssssssssssssss      [  5%]
2025-02-21T12:40:33.9208230Z tardis/io/model/readers/tests/test_arepo_parser.py ..                    [  5%]
2025-02-21T12:40:33.9649260Z tardis/io/model/readers/tests/test_ascii_readers.py ...                  [  5%]
2025-02-21T12:40:33.9774890Z tardis/io/model/readers/tests/test_cmfgen_reader.py ..                   [  5%]
2025-02-21T12:40:34.0017540Z tardis/io/model/readers/tests/test_csvy_reader.py ....                   [  6%]
2025-02-21T12:40:34.0181390Z tardis/io/model/readers/tests/test_stella_reader.py ..                   [  6%]
2025-02-21T12:40:34.2740300Z tardis/io/tests/test_HDFWriter.py ...............                        [  7%]
2025-02-21T12:40:34.7092060Z tardis/io/tests/test_atomic.py .....                                     [  7%]
2025-02-21T12:40:34.7293910Z tardis/io/tests/test_decay.py ..                                         [  7%]
2025-02-21T12:40:34.9087340Z tardis/io/tests/test_model_reader.py ......                              [  7%]
2025-02-21T12:40:34.9150840Z tardis/model/geometry/tests/test_radial1d.py ..                          [  7%]
2025-02-21T12:41:02.1781680Z tardis/model/tests/test_base.py ........................................ [ 10%]
2025-02-21T12:41:02.9790160Z ............                                                             [ 10%]
2025-02-21T12:41:05.7409460Z tardis/model/tests/test_csvy_model.py .........                          [ 11%]
2025-02-21T12:41:05.7813180Z tardis/model/tests/test_density.py ..                                    [ 11%]
2025-02-21T12:41:07.0562920Z tardis/opacities/tests/test_opacity_solver.py .....                      [ 11%]
2025-02-21T12:41:08.1026360Z tardis/opacities/tests/test_opacity_state_numba.py .....                 [ 11%]
2025-02-21T12:41:10.0647160Z tardis/opacities/tests/test_tau_sobolev.py ..                            [ 12%]
2025-02-21T12:41:12.5734240Z tardis/plasma/equilibrium/tests/test_collisional_transitions.py ...      [ 12%]
2025-02-21T12:41:52.0891330Z tardis/plasma/equilibrium/tests/test_level_populations.py ....           [ 12%]
2025-02-21T12:42:00.8482570Z tardis/plasma/equilibrium/tests/test_rate_matrix.py .                    [ 12%]
2025-02-21T12:42:01.8788340Z tardis/plasma/tests/test_complete_plasmas.py ..............s......s..... [ 13%]
2025-02-21T12:42:03.9828430Z s....ssssss............s......s.....ss.....s....ssssss............s..... [ 18%]
2025-02-21T12:42:05.2920390Z .s.....ss.....s....ssssss............s......s.....ss.....s....ssssss.... [ 22%]
2025-02-21T12:42:07.5386570Z ........s......s.....ss.....s....ssssss............s......s.....ss.....s [ 26%]
2025-02-21T12:42:09.5926120Z ....ssssss............s......s.....ss.....s....ssssss............s...... [ 30%]
2025-02-21T12:42:10.1180250Z s.....ss.....s....ssssss............s......s.....ss.....s.ss.ssssss..... [ 34%]
2025-02-21T12:42:12.0833640Z .......s......s.....ss.....s....ssssss............s......s.....ss.....s. [ 38%]
2025-02-21T12:42:14.4777750Z ...ssssss............s......s.....ss.....s....ssssss............s......s [ 42%]
2025-02-21T12:42:16.8120250Z .....ss.....s....ssssss............s......s.....s...........ssssss...... [ 46%]
2025-02-21T12:42:18.3065090Z ......s......s.....s...........ssssss............s......s.....s......... [ 50%]
2025-02-21T12:42:20.4451410Z ..ssssss............s......s.....ss.....s....ssssss............s......s. [ 54%]
2025-02-21T12:42:22.9912070Z ....ss.....s....ssssss...................s......s.....s....ssss......... [ 58%]
2025-02-21T12:42:23.2891380Z ............s......s.....s....ssss.......                                [ 60%]
2025-02-21T12:42:23.4817940Z tardis/plasma/tests/test_hdf_plasma.py ................................. [ 62%]
2025-02-21T12:42:23.4892240Z ......                                                                   [ 62%]
2025-02-21T12:42:23.7719880Z tardis/plasma/tests/test_nlte_excitation.py ...                          [ 62%]
2025-02-21T12:44:06.7975740Z tardis/plasma/tests/test_nlte_solver.py .....X                           [ 63%]
2025-02-21T12:44:06.8018700Z tardis/plasma/tests/test_plasma_continuum.py .                           [ 63%]
2025-02-21T12:44:28.8764520Z tardis/plasma/tests/test_plasma_vboundary.py .............               [ 63%]
2025-02-21T12:44:39.7110970Z tardis/plasma/tests/test_tardis_model_density_config.py ...              [ 64%]
2025-02-21T12:44:40.2706290Z tardis/simulation/tests/test_convergence.py .....                        [ 64%]
2025-02-21T12:44:47.4171300Z tardis/simulation/tests/test_simulation.py .............                 [ 65%]
2025-02-21T12:44:47.4314580Z tardis/spectrum/tests/test_cuda_formal_integral.py sssssssssssssssssssss [ 66%]
2025-02-21T12:44:47.7321960Z ssss...ssssssssssssssssssssss                                            [ 67%]
2025-02-21T12:44:47.7368150Z tardis/spectrum/tests/test_luminosity.py ....                            [ 68%]
2025-02-21T12:44:48.6118570Z tardis/spectrum/tests/test_numba_formal_integral.py .................... [ 69%]
2025-02-21T12:44:48.6255690Z ..........                                                               [ 69%]
2025-02-21T12:44:48.7570680Z tardis/spectrum/tests/test_spectrum.py ................................. [ 71%]
2025-02-21T12:44:48.7856860Z .........                                                                [ 72%]
2025-02-21T12:44:48.8765300Z tardis/spectrum/tests/test_spectrum_solver.py .FFF                       [ 72%]
2025-02-21T12:45:24.1316940Z tardis/tests/test_tardis_full.py .FFF                                    [ 72%]
2025-02-21T12:47:05.8523610Z tardis/tests/test_tardis_full_formal_integral.py ................        [ 73%]
2025-02-21T12:47:05.9055030Z tardis/tests/test_util.py .............................................  [ 75%]
2025-02-21T12:47:08.1685970Z tardis/transport/montecarlo/tests/test_base.py x.....................    [ 77%]
2025-02-21T12:47:12.9330170Z tardis/transport/montecarlo/tests/test_interaction.py .......            [ 77%]
2025-02-21T12:47:13.0712960Z tardis/transport/montecarlo/tests/test_macro_atom.py ....                [ 77%]
2025-02-21T12:47:13.0821210Z tardis/transport/montecarlo/tests/test_montecarlo.py sssssssssssssssssss [ 78%]
2025-02-21T12:47:13.1047080Z sssssssssssssssssssssssssssssssssssssssssssss                            [ 81%]
2025-02-21T12:47:20.7775940Z tardis/transport/montecarlo/tests/test_montecarlo_main_loop.py x..       [ 81%]
2025-02-21T12:47:20.7914510Z tardis/transport/montecarlo/tests/test_nonhomologous.py ...              [ 81%]
2025-02-21T12:47:22.6930330Z tardis/transport/montecarlo/tests/test_numba_interface.py .....x.        [ 82%]
2025-02-21T12:47:23.0163030Z tardis/transport/montecarlo/tests/test_opacities.py ...............      [ 82%]
2025-02-21T12:47:23.7162790Z tardis/transport/montecarlo/tests/test_packet.py .................xXXXXX [ 84%]
2025-02-21T12:47:23.8007120Z XX.........                                                              [ 84%]
2025-02-21T12:47:23.8241460Z tardis/transport/montecarlo/tests/test_packet_source.py ........         [ 85%]
2025-02-21T12:47:24.0100960Z tardis/transport/montecarlo/tests/test_rpacket_last_interaction_tracker.py . [ 85%]
2025-02-21T12:47:24.2745570Z .....                                                                    [ 85%]
2025-02-21T12:47:33.0799580Z tardis/transport/montecarlo/tests/test_rpacket_tracker.py ......         [ 85%]
2025-02-21T12:47:33.1007160Z tardis/transport/montecarlo/tests/test_single_packet_loop.py xxx         [ 86%]
2025-02-21T12:47:33.1033680Z tardis/transport/montecarlo/tests/test_tracker_utils.py ..               [ 86%]
2025-02-21T12:47:34.2250920Z tardis/transport/montecarlo/tests/test_vpacket.py ..x.                   [ 86%]
2025-02-21T12:47:34.2390670Z tardis/transport/montecarlo/tests/test_weighted_packet_source.py ....    [ 86%]
2025-02-21T12:47:36.8123220Z tardis/transport/montecarlo/tests/test_weighted_packet_source_integration.py . [ 86%]
2025-02-21T12:47:36.8123890Z                                                                          [ 86%]
2025-02-21T12:47:37.5447650Z tardis/transport/tests/test_doppler_factor.py ..................         [ 87%]
2025-02-21T12:47:38.9326330Z tardis/visualization/tools/tests/test_convergence_plot.py .............. [ 88%]
2025-02-21T12:47:40.3574330Z ......                                                                   [ 88%]
2025-02-21T12:47:43.4945570Z tardis/visualization/tools/tests/test_liv_plot.py ...................... [ 90%]
2025-02-21T12:47:46.4300580Z .............................                                            [ 91%]
2025-02-21T12:47:49.1830490Z tardis/visualization/tools/tests/test_rpacket_plot.py .................. [ 92%]
2025-02-21T12:47:55.8675250Z ....                                                                     [ 92%]
2025-02-21T12:48:00.1020900Z tardis/visualization/tools/tests/test_sdec_plot.py ..................... [ 94%]
2025-02-21T12:48:05.8373580Z ..............................                                           [ 95%]
2025-02-21T12:48:06.1803320Z tardis/visualization/widgets/tests/test_custom_abundance.py ........ss.. [ 96%]
2025-02-21T12:48:06.2201460Z ....                                                                     [ 96%]
2025-02-21T12:48:07.0055060Z tardis/visualization/widgets/tests/test_line_info.py ................... [ 97%]
2025-02-21T12:48:07.5758680Z ..................                                                       [ 98%]
2025-02-21T12:51:11.1813150Z tardis/visualization/widgets/tests/test_shell_info.py .................. [ 99%]
2025-02-21T12:51:18.0248090Z ......                                                                   [100%]
2025-02-21T12:51:18.0248640Z 
2025-02-21T12:51:18.0249010Z =================================== FAILURES ===================================
2025-02-21T12:51:18.0249550Z ________________ TestSpectrumSolver.test_spectrum_real_packets _________________
2025-02-21T12:51:18.0250790Z 
2025-02-21T12:51:18.0251280Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x136098ef0>
2025-02-21T12:51:18.0252060Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x137806600>
2025-02-21T12:51:18.0252470Z 
2025-02-21T12:51:18.0252780Z     def test_spectrum_real_packets(self, simulation_regression_data):
2025-02-21T12:51:18.0253790Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:51:18.0254490Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:51:18.0255290Z     
2025-02-21T12:51:18.0255660Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:51:18.0256170Z         result = solver.spectrum_real_packets.luminosity
2025-02-21T12:51:18.0256780Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:51:18.0257260Z         expected = self.get_expected_data(key)
2025-02-21T12:51:18.0257670Z     
2025-02-21T12:51:18.0257990Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:51:18.0258410Z     
2025-02-21T12:51:18.0258750Z >       assert_quantity_allclose(
2025-02-21T12:51:18.0259150Z             result,
2025-02-21T12:51:18.0259430Z             luminosity,
2025-02-21T12:51:18.0260110Z         )
2025-02-21T12:51:18.0260320Z 
2025-02-21T12:51:18.0260510Z tardis/spectrum/tests/test_spectrum_solver.py:61: 
2025-02-21T12:51:18.0261010Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0273730Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:18.0274280Z     np.testing.assert_allclose(
2025-02-21T12:51:18.0274550Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0274770Z 
2025-02-21T12:51:18.0275230Z args = (<function assert_allclose.<locals>.compare at 0x15b25c540>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39, .....), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T12:51:18.0275830Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:18.0276320Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:18.0276650Z 
2025-02-21T12:51:18.0276700Z     @wraps(func)
2025-02-21T12:51:18.0276990Z     def inner(*args, **kwds):
2025-02-21T12:51:18.0277240Z         with self._recreate_cm():
2025-02-21T12:51:18.0277580Z >           return func(*args, **kwds)
2025-02-21T12:51:18.0277840Z E           AssertionError: 
2025-02-21T12:51:18.0278160Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0278420Z E           
2025-02-21T12:51:18.0278680Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:51:18.0279030Z E           Max absolute difference: 1.94155993e+40
2025-02-21T12:51:18.0279300Z E           Max relative difference: 137.15340685
2025-02-21T12:51:18.0279710Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0280090Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0280570Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:51:18.0280940Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0281160Z 
2025-02-21T12:51:18.0281410Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:18.0291100Z ___________ TestSpectrumSolver.test_spectrum_real_packets_reabsorbed ___________
2025-02-21T12:51:18.0291420Z 
2025-02-21T12:51:18.0291690Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x1360991c0>
2025-02-21T12:51:18.0292230Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x137806600>
2025-02-21T12:51:18.0292620Z 
2025-02-21T12:51:18.0292840Z     def test_spectrum_real_packets_reabsorbed(self, simulation_regression_data):
2025-02-21T12:51:18.0293320Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:51:18.0293780Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:51:18.0294200Z     
2025-02-21T12:51:18.0294490Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:51:18.0295000Z         result = solver.spectrum_real_packets_reabsorbed.luminosity
2025-02-21T12:51:18.0295480Z         key = "simulation/spectrum_solver/spectrum_real_packets_reabsorbed/luminosity"
2025-02-21T12:51:18.0295940Z         expected = self.get_expected_data(key)
2025-02-21T12:51:18.0296190Z     
2025-02-21T12:51:18.0296440Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:51:18.0296700Z     
2025-02-21T12:51:18.0296930Z >       assert_quantity_allclose(
2025-02-21T12:51:18.0297260Z             result,
2025-02-21T12:51:18.0297580Z             luminosity,
2025-02-21T12:51:18.0297820Z         )
2025-02-21T12:51:18.0297970Z 
2025-02-21T12:51:18.0298190Z tardis/spectrum/tests/test_spectrum_solver.py:77: 
2025-02-21T12:51:18.0298540Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0299170Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:18.0299760Z     np.testing.assert_allclose(
2025-02-21T12:51:18.0300050Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0300290Z 
2025-02-21T12:51:18.0300940Z args = (<function assert_allclose.<locals>.compare at 0x15b1c4b80>, array([0., 0., 0., ..., 0., 0., 0.]), array([2.03920412e+38, 3.72882494e+38, 2.29646943e+38, ...,
2025-02-21T12:51:18.0301490Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:18.0302010Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:18.0302350Z 
2025-02-21T12:51:18.0302410Z     @wraps(func)
2025-02-21T12:51:18.0302660Z     def inner(*args, **kwds):
2025-02-21T12:51:18.0302920Z         with self._recreate_cm():
2025-02-21T12:51:18.0304320Z >           return func(*args, **kwds)
2025-02-21T12:51:18.0304760Z E           AssertionError: 
2025-02-21T12:51:18.0305370Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0305770Z E           
2025-02-21T12:51:18.0308740Z E           Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T12:51:18.0309410Z E           Max absolute difference: 1.0639846e+40
2025-02-21T12:51:18.0311250Z E           Max relative difference: 122.79315318
2025-02-21T12:51:18.0312210Z E            x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T12:51:18.0313900Z E            y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T12:51:18.0315190Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0315380Z 
2025-02-21T12:51:18.0317320Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:18.0319250Z ________________________ TestSpectrumSolver.test_solve _________________________
2025-02-21T12:51:18.0319510Z 
2025-02-21T12:51:18.0319830Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x136099a60>
2025-02-21T12:51:18.0321590Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x137806600>
2025-02-21T12:51:18.0323830Z 
2025-02-21T12:51:18.0323960Z     def test_solve(self, simulation_regression_data):
2025-02-21T12:51:18.0327320Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T12:51:18.0328120Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T12:51:18.0330960Z     
2025-02-21T12:51:18.0332060Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T12:51:18.0335810Z         result_real, result_virtual, result_integrated = solver.solve(
2025-02-21T12:51:18.0336510Z             transport_state
2025-02-21T12:51:18.0338060Z         )
2025-02-21T12:51:18.0340350Z         key_real = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:51:18.0341910Z         expected_real = self.get_expected_data(key_real)
2025-02-21T12:51:18.0343410Z     
2025-02-21T12:51:18.0344350Z         luminosity_real = u.Quantity(expected_real, "erg /s")
2025-02-21T12:51:18.0345070Z     
2025-02-21T12:51:18.0345340Z >       assert_quantity_allclose(
2025-02-21T12:51:18.0345710Z             result_real.luminosity,
2025-02-21T12:51:18.0345970Z             luminosity_real,
2025-02-21T12:51:18.0346360Z         )
2025-02-21T12:51:18.0347230Z 
2025-02-21T12:51:18.0347340Z tardis/spectrum/tests/test_spectrum_solver.py:95: 
2025-02-21T12:51:18.0355150Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0356960Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:18.0357410Z     np.testing.assert_allclose(
2025-02-21T12:51:18.0358750Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0359020Z 
2025-02-21T12:51:18.0360930Z args = (<function assert_allclose.<locals>.compare at 0x15b1c62a0>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39, .....), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T12:51:18.0363490Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:18.0363960Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:18.0369440Z 
2025-02-21T12:51:18.0370470Z     @wraps(func)
2025-02-21T12:51:18.0372350Z     def inner(*args, **kwds):
2025-02-21T12:51:18.0373950Z         with self._recreate_cm():
2025-02-21T12:51:18.0375630Z >           return func(*args, **kwds)
2025-02-21T12:51:18.0375880Z E           AssertionError: 
2025-02-21T12:51:18.0376160Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0376410Z E           
2025-02-21T12:51:18.0376640Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:51:18.0376910Z E           Max absolute difference: 1.94155993e+40
2025-02-21T12:51:18.0377330Z E           Max relative difference: 137.15340685
2025-02-21T12:51:18.0377650Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0379240Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0380840Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:51:18.0381150Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0383300Z 
2025-02-21T12:51:18.0385700Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:18.0386130Z __________________ TestTransportSimple.test_j_blue_estimators __________________
2025-02-21T12:51:18.0386400Z 
2025-02-21T12:51:18.0386610Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x13609a1b0>
2025-02-21T12:51:18.0387070Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x137806600>
2025-02-21T12:51:18.0387390Z 
2025-02-21T12:51:18.0387550Z     def test_j_blue_estimators(self, simulation_regression_data):
2025-02-21T12:51:18.0387900Z         key = "simulation/transport/transport_state/j_blue_estimator"
2025-02-21T12:51:18.0388430Z         expected = self.get_expected_data(key)
2025-02-21T12:51:18.0388940Z     
2025-02-21T12:51:18.0391000Z >       npt.assert_allclose(
2025-02-21T12:51:18.0391930Z             simulation_regression_data.transport.transport_state.radfield_mc_estimators.j_blue_estimator,
2025-02-21T12:51:18.0394170Z             expected.values,
2025-02-21T12:51:18.0396090Z         )
2025-02-21T12:51:18.0396230Z 
2025-02-21T12:51:18.0396370Z tardis/tests/test_tardis_full.py:60: 
2025-02-21T12:51:18.0396650Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0398610Z 
2025-02-21T12:51:18.0398980Z args = (<function assert_allclose.<locals>.compare at 0x15b25e980>, array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0399420Z        [0., 0., 0.,.....,
2025-02-21T12:51:18.0399960Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0400440Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0401690Z        [0., 0., 0., ..., 0., 0., 0.]]))
2025-02-21T12:51:18.0402340Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:18.0403120Z 
2025-02-21T12:51:18.0404260Z     @wraps(func)
2025-02-21T12:51:18.0409590Z     def inner(*args, **kwds):
2025-02-21T12:51:18.0409890Z         with self._recreate_cm():
2025-02-21T12:51:18.0410660Z >           return func(*args, **kwds)
2025-02-21T12:51:18.0410960Z E           AssertionError: 
2025-02-21T12:51:18.0412640Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0415190Z E           
2025-02-21T12:51:18.0416320Z E           Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T12:51:18.0417210Z E           Max absolute difference: 1.43452643e-17
2025-02-21T12:51:18.0419430Z E           Max relative difference: 235.31367318
2025-02-21T12:51:18.0420420Z E            x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0421390Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0421860Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:51:18.0423400Z E            y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0424490Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0426640Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:51:18.0426850Z 
2025-02-21T12:51:18.0427030Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:18.0428240Z ______________________ TestTransportSimple.test_spectrum _______________________
2025-02-21T12:51:18.0428670Z 
2025-02-21T12:51:18.0437510Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x13609a630>
2025-02-21T12:51:18.0439170Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x137806600>
2025-02-21T12:51:18.0439680Z 
2025-02-21T12:51:18.0440620Z     def test_spectrum(self, simulation_regression_data):
2025-02-21T12:51:18.0441050Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T12:51:18.0444130Z         expected = self.get_expected_data(key)
2025-02-21T12:51:18.0444450Z     
2025-02-21T12:51:18.0444840Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:51:18.0446780Z     
2025-02-21T12:51:18.0448370Z >       assert_quantity_allclose(
2025-02-21T12:51:18.0449090Z             simulation_regression_data.spectrum_solver.spectrum_real_packets.luminosity,
2025-02-21T12:51:18.0450200Z             luminosity,
2025-02-21T12:51:18.0450600Z         )
2025-02-21T12:51:18.0450760Z 
2025-02-21T12:51:18.0451230Z tardis/tests/test_tardis_full.py:71: 
2025-02-21T12:51:18.0451670Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0452940Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:18.0453940Z     np.testing.assert_allclose(
2025-02-21T12:51:18.0454620Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0454870Z 
2025-02-21T12:51:18.0455400Z args = (<function assert_allclose.<locals>.compare at 0x31b8f6980>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39, .....), array([1.47119190e+39, 1.69564189e+39, 1.35368464e+39, ...,
2025-02-21T12:51:18.0456420Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:18.0465450Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:18.0465820Z 
2025-02-21T12:51:18.0465880Z     @wraps(func)
2025-02-21T12:51:18.0466970Z     def inner(*args, **kwds):
2025-02-21T12:51:18.0468260Z         with self._recreate_cm():
2025-02-21T12:51:18.0468680Z >           return func(*args, **kwds)
2025-02-21T12:51:18.0469440Z E           AssertionError: 
2025-02-21T12:51:18.0473790Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0474050Z E           
2025-02-21T12:51:18.0481130Z E           Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T12:51:18.0482820Z E           Max absolute difference: 1.96604107e+40
2025-02-21T12:51:18.0483750Z E           Max relative difference: 97.03021569
2025-02-21T12:51:18.0486490Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0486910Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0504290Z E            y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0505600Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0506800Z 
2025-02-21T12:51:18.0513030Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:18.0514940Z __________________ TestTransportSimple.test_virtual_spectrum ___________________
2025-02-21T12:51:18.0516470Z 
2025-02-21T12:51:18.0517170Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x13609a900>
2025-02-21T12:51:18.0518890Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x137806600>
2025-02-21T12:51:18.0520640Z 
2025-02-21T12:51:18.0521700Z     def test_virtual_spectrum(self, simulation_regression_data):
2025-02-21T12:51:18.0523490Z         key = "simulation/spectrum_solver/spectrum_virtual_packets/luminosity"
2025-02-21T12:51:18.0524050Z         expected = self.get_expected_data(key)
2025-02-21T12:51:18.0524490Z     
2025-02-21T12:51:18.0584800Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T12:51:18.0585200Z     
2025-02-21T12:51:18.0585400Z >       assert_quantity_allclose(
2025-02-21T12:51:18.0585810Z             simulation_regression_data.spectrum_solver.spectrum_virtual_packets.luminosity,
2025-02-21T12:51:18.0586200Z             luminosity,
2025-02-21T12:51:18.0586380Z         )
2025-02-21T12:51:18.0586480Z 
2025-02-21T12:51:18.0586560Z tardis/tests/test_tardis_full.py:82: 
2025-02-21T12:51:18.0586870Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0587450Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T12:51:18.0587970Z     np.testing.assert_allclose(
2025-02-21T12:51:18.0588310Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T12:51:18.0588530Z 
2025-02-21T12:51:18.0588900Z args = (<function assert_allclose.<locals>.compare at 0x15b1c62a0>, array([1.31895331e+39, 2.31381538e+39, 3.72000430e+39, .....), array([1.44033177e+39, 1.35611403e+39, 1.39755698e+39, ...,
2025-02-21T12:51:18.0589520Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T12:51:18.0589980Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T12:51:18.0590260Z 
2025-02-21T12:51:18.0590310Z     @wraps(func)
2025-02-21T12:51:18.0590530Z     def inner(*args, **kwds):
2025-02-21T12:51:18.0590720Z         with self._recreate_cm():
2025-02-21T12:51:18.0590900Z >           return func(*args, **kwds)
2025-02-21T12:51:18.0591100Z E           AssertionError: 
2025-02-21T12:51:18.0591310Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0592230Z E           
2025-02-21T12:51:18.0592400Z E           Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T12:51:18.0592620Z E           Max absolute difference: 4.69537822e+39
2025-02-21T12:51:18.0592850Z E           Max relative difference: 419.77405263
2025-02-21T12:51:18.0593120Z E            x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0593390Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0593650Z E            y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0593910Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0594040Z 
2025-02-21T12:51:18.0594220Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T12:51:18.0594550Z =============================== warnings summary ===============================
2025-02-21T12:51:18.0594810Z tardis/io/configuration/config_validator.py:6
2025-02-21T12:51:18.0595070Z tardis/io/configuration/config_validator.py:6
2025-02-21T12:51:18.0595490Z   /Users/runner/work/tardis/tardis/tardis/io/configuration/config_validator.py:6: DeprecationWarning:
2025-02-21T12:51:18.0595860Z   
2025-02-21T12:51:18.0596850Z   jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
2025-02-21T12:51:18.0597830Z 
2025-02-21T12:51:18.0598030Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22
2025-02-21T12:51:18.0598580Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22: DeprecationWarning:
2025-02-21T12:51:18.0598990Z   
2025-02-21T12:51:18.0599180Z   Jupyter is migrating its paths to use standard platformdirs
2025-02-21T12:51:18.0599500Z   given by the platformdirs library.  To remove this warning and
2025-02-21T12:51:18.0600030Z   see the appropriate new directories, set the environment variable
2025-02-21T12:51:18.0600350Z   `JUPYTER_PLATFORM_DIRS=1` and then run `jupyter --paths`.
2025-02-21T12:51:18.0600660Z   The use of platformdirs will be the default in `jupyter_core` v6
2025-02-21T12:51:18.0600850Z 
2025-02-21T12:51:18.0609590Z tardis/io/tests/test_HDFWriter.py::test_multi_index_write
2025-02-21T12:51:18.0610030Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:51:18.0610480Z   /Users/runner/work/tardis/tardis/tardis/io/util.py:276: PerformanceWarning:
2025-02-21T12:51:18.0610780Z   
2025-02-21T12:51:18.0610890Z   
2025-02-21T12:51:18.0611120Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:51:18.0611570Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T12:51:18.0611880Z 
2025-02-21T12:51:18.0612060Z tardis/io/tests/test_model_reader.py::test_read_cmfgen_isotope_abundances
2025-02-21T12:51:18.0612460Z tardis/plasma/tests/test_tardis_model_density_config.py::test_electron_densities
2025-02-21T12:51:18.0613000Z tardis/plasma/tests/test_tardis_model_density_config.py::test_isotope_number_densities
2025-02-21T12:51:18.0613410Z tardis/plasma/tests/test_tardis_model_density_config.py::test_t_rad
2025-02-21T12:51:18.0613880Z   /Users/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:82: DeprecationWarning:
2025-02-21T12:51:18.0614250Z   
2025-02-21T12:51:18.0614400Z   The current CMFGEN model parser is deprecated
2025-02-21T12:51:18.0614550Z 
2025-02-21T12:51:18.0614650Z tardis/io/tests/test_model_reader.py: 1 warning
2025-02-21T12:51:18.0614950Z tardis/plasma/tests/test_tardis_model_density_config.py: 9 warnings
2025-02-21T12:51:18.0615410Z   /Users/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:40: DeprecationWarning:
2025-02-21T12:51:18.0616550Z   
2025-02-21T12:51:18.0616710Z   The current CMFGEN model parser is deprecated
2025-02-21T12:51:18.0616860Z 
2025-02-21T12:51:18.0617040Z tardis/model/tests/test_base.py::TestModelFromPaper1Config::test_abundances
2025-02-21T12:51:18.0617560Z   /Users/runner/work/tardis/tardis/tardis/transport/montecarlo/montecarlo_main_loop.py:123: NumbaTypeSafetyWarning:
2025-02-21T12:51:18.0617970Z   
2025-02-21T12:51:18.0622800Z   [1m[1m[1munsafe cast from uint64 to int64. Precision may be lost.[0m[0m[0m
2025-02-21T12:51:18.0623030Z 
2025-02-21T12:51:18.0623110Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T12:51:18.0623350Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T12:51:18.0623650Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T12:51:18.0624080Z   /Users/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:50: DeprecationWarning:
2025-02-21T12:51:18.0624430Z   
2025-02-21T12:51:18.0624600Z   v_inner_boundary < 0, assuming default value
2025-02-21T12:51:18.0624760Z 
2025-02-21T12:51:18.0624840Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T12:51:18.0625070Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T12:51:18.0625370Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T12:51:18.0625800Z   /Users/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:61: DeprecationWarning:
2025-02-21T12:51:18.0626140Z   
2025-02-21T12:51:18.0626290Z   v_outer_boundary < 0, assuming default value
2025-02-21T12:51:18.0626440Z 
2025-02-21T12:51:18.0626820Z tardis/plasma/equilibrium/tests/test_level_populations.py::TestLevelPopulationSolver::test_solve[collisional_rate_solver0-radiative_transitions0]
2025-02-21T12:51:18.0627500Z   /Users/runner/work/tardis/tardis/tardis/plasma/equilibrium/level_populations.py:65: FutureWarning:
2025-02-21T12:51:18.0627860Z   
2025-02-21T12:51:18.0628150Z   A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
2025-02-21T12:51:18.0629660Z   The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
2025-02-21T12:51:18.0630140Z   
2025-02-21T12:51:18.0630630Z   For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
2025-02-21T12:51:18.0631130Z 
2025-02-21T12:51:18.0631300Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3750]
2025-02-21T12:51:18.0631720Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3850]
2025-02-21T12:51:18.0632120Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3900]
2025-02-21T12:51:18.0632550Z   /Users/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:71: UserWarning:
2025-02-21T12:51:18.0632870Z   
2025-02-21T12:51:18.0633090Z   Requesting inner boundary below inner shell. Extrapolating the inner cell
2025-02-21T12:51:18.0633330Z 
2025-02-21T12:51:18.0633510Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T12:51:18.0633920Z   /Users/runner/work/tardis/tardis/tardis/spectrum/base.py:70: UserWarning:
2025-02-21T12:51:18.0634200Z   
2025-02-21T12:51:18.0634530Z   SpectrumSolver.spectrum_virtual_packets is zero. Please run the montecarlo simulation with no_of_virtual_packets > 0
2025-02-21T12:51:18.0634860Z 
2025-02-21T12:51:18.0635030Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T12:51:18.0635450Z   /Users/runner/work/tardis/tardis/tardis/spectrum/base.py:111: UserWarning:
2025-02-21T12:51:18.0635730Z   
2025-02-21T12:51:18.0636080Z   SpectrumSolver.integrator: The FormalIntegrator is not yet available.Please run the montecarlo simulation at least once.
2025-02-21T12:51:18.0636440Z 
2025-02-21T12:51:18.0636620Z tardis/transport/montecarlo/tests/test_vpacket.py::test_trace_vpacket_volley
2025-02-21T12:51:18.0637230Z   <string>:3: NumbaPendingDeprecationWarning:
2025-02-21T12:51:18.0637430Z   
2025-02-21T12:51:18.0638380Z   [1m[1mCode using Numba extension API maybe depending on 'old_style' error-capturing, which is deprecated and will be replaced by 'new_style' in a future release. See details at https://numba.readthedocs.io/en/latest/reference/deprecation.html#deprecation-of-old-style-numba-captured-errors
2025-02-21T12:51:18.0639210Z   Exception origin:
2025-02-21T12:51:18.0639520Z     File "/Users/runner/micromamba/envs/tardis/lib/python3.12/inspect.py", line 3180, in _bind
2025-02-21T12:51:18.0639860Z       raise TypeError(msg) from None
2025-02-21T12:51:18.0640060Z   [0m[0m
2025-02-21T12:51:18.0640140Z 
2025-02-21T12:51:18.0640410Z tardis/visualization/tools/tests/test_sdec_plot.py::TestSDECPlotter::test_mpl_image[plotter_generate_plot_mpl4]
2025-02-21T12:51:18.0640970Z   /Users/runner/work/tardis/tardis/tardis/visualization/tools/sdec_plot.py:1225: RuntimeWarning:
2025-02-21T12:51:18.0641330Z   
2025-02-21T12:51:18.0642070Z   More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
2025-02-21T12:51:18.0642810Z 
2025-02-21T12:51:18.0643100Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0643730Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0644370Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0645000Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0645650Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0646510Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0647150Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:51:18.0647560Z   
2025-02-21T12:51:18.0647780Z   Passing unrecognized arguments to super(Checkbox).__init__(icon='lock').
2025-02-21T12:51:18.0648160Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:51:18.0648570Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:51:18.0648840Z 
2025-02-21T12:51:18.0649120Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0649930Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0650580Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:51:18.0650960Z   
2025-02-21T12:51:18.0651170Z   Passing unrecognized arguments to super(FloatText).__init__(min=0).
2025-02-21T12:51:18.0651530Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:51:18.0651930Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:51:18.0652190Z 
2025-02-21T12:51:18.0652470Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T12:51:18.0653110Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T12:51:18.0653500Z   
2025-02-21T12:51:18.0653710Z   Passing unrecognized arguments to super(HTML).__init__(indent=True).
2025-02-21T12:51:18.0654350Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T12:51:18.0654760Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T12:51:18.0655020Z 
2025-02-21T12:51:18.0655360Z tardis/visualization/widgets/tests/test_line_info.py::TestLineInfoWidgetData::test_get_species_interactions[wavelength_range0-packet_out_nu]
2025-02-21T12:51:18.0656040Z   /Users/runner/micromamba/envs/tardis/lib/python3.12/site-packages/qgridnext/grid.py:830: DeprecationWarning:
2025-02-21T12:51:18.0656410Z   
2025-02-21T12:51:18.0656700Z   QgridWidget._show_toolbar_changed is deprecated in traitlets 4.1: use @observe and @unobserve instead.
2025-02-21T12:51:18.0657000Z 
2025-02-21T12:51:18.0657200Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:51:18.0657650Z   /Users/runner/work/tardis/tardis/tardis/io/util.py:289: PerformanceWarning:
2025-02-21T12:51:18.0657940Z   
2025-02-21T12:51:18.0658060Z   
2025-02-21T12:51:18.0658280Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:51:18.0658720Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T12:51:18.0659000Z 
2025-02-21T12:51:18.0659210Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:51:18.0659650Z   /Users/runner/work/tardis/tardis/tardis/io/util.py:292: PerformanceWarning:
2025-02-21T12:51:18.0659940Z   
2025-02-21T12:51:18.0660040Z   
2025-02-21T12:51:18.0660260Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T12:51:18.0660640Z   map directly to c-types [inferred_type->mixed,key->values] [items->None]
2025-02-21T12:51:18.0660850Z 
2025-02-21T12:51:18.0661060Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T12:51:18.0661530Z   /Users/runner/work/tardis/tardis/tardis/spectrum/formal_integral.py:398: UserWarning:
2025-02-21T12:51:18.0661930Z   
2025-02-21T12:51:18.0662150Z   The number of interpolate_shells was not specified. The value was set to 80.
2025-02-21T12:51:18.0662370Z 
2025-02-21T12:51:18.0662540Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-02-21T12:51:18.0662760Z 
2025-02-21T12:51:18.0662900Z ---------- coverage: platform darwin, python 3.12.4-final-0 ----------
2025-02-21T12:51:18.0663200Z Coverage HTML written to dir coverage_html_report
2025-02-21T12:51:18.0663430Z Coverage XML written to file coverage.xml
2025-02-21T12:51:18.0663570Z 
2025-02-21T12:51:18.0663670Z =========================== short test summary info ============================
2025-02-21T12:51:18.0664130Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets - AssertionError: 
2025-02-21T12:51:18.0664550Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0664700Z 
2025-02-21T12:51:18.0664780Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:51:18.0664990Z Max absolute difference: 1.94155993e+40
2025-02-21T12:51:18.0665200Z Max relative difference: 137.15340685
2025-02-21T12:51:18.0665440Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0665690Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0665920Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:51:18.0666160Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0666600Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets_reabsorbed - AssertionError: 
2025-02-21T12:51:18.0667040Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0667180Z 
2025-02-21T12:51:18.0667250Z Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T12:51:18.0667450Z Max absolute difference: 1.0639846e+40
2025-02-21T12:51:18.0667650Z Max relative difference: 122.79315318
2025-02-21T12:51:18.0668010Z  x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T12:51:18.0668250Z  y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T12:51:18.0668500Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0668860Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve - AssertionError: 
2025-02-21T12:51:18.0669230Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0669380Z 
2025-02-21T12:51:18.0669450Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T12:51:18.0669650Z Max absolute difference: 1.94155993e+40
2025-02-21T12:51:18.0669860Z Max relative difference: 137.15340685
2025-02-21T12:51:18.0670100Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0670340Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0670570Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T12:51:18.0670810Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0671170Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_j_blue_estimators - AssertionError: 
2025-02-21T12:51:18.0671550Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0671690Z 
2025-02-21T12:51:18.0671770Z Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T12:51:18.0671980Z Max absolute difference: 1.43452643e-17
2025-02-21T12:51:18.0672180Z Max relative difference: 235.31367318
2025-02-21T12:51:18.0672370Z  x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0672560Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0672730Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:51:18.0672910Z  y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0673100Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T12:51:18.0673280Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T12:51:18.0673600Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_spectrum - AssertionError: 
2025-02-21T12:51:18.0673960Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0674100Z 
2025-02-21T12:51:18.0674240Z Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T12:51:18.0674450Z Max absolute difference: 1.96604107e+40
2025-02-21T12:51:18.0674650Z Max relative difference: 97.03021569
2025-02-21T12:51:18.0674890Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0675130Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0675360Z  y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0675600Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0675950Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_virtual_spectrum - AssertionError: 
2025-02-21T12:51:18.0676320Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T12:51:18.0676460Z 
2025-02-21T12:51:18.0676530Z Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T12:51:18.0676730Z Max absolute difference: 4.69537822e+39
2025-02-21T12:51:18.0676930Z Max relative difference: 419.77405263
2025-02-21T12:51:18.0677170Z  x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0677420Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0677650Z  y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T12:51:18.0677890Z        0.000000e+00, 0.000000e+00])
2025-02-21T12:51:18.0678220Z = 6 failed, 1404 passed, 357 skipped, 2 deselected, 19 xfailed, 8 xpassed, 63 warnings in 691.39s (0:11:31) =
2025-02-21T12:51:19.7534010Z ##[error]Process completed with exit code 1.
