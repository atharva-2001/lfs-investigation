2025-02-21T11:37:30.9580634Z ##[group]Run pytest tardis --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"
2025-02-21T11:37:30.9582965Z [36;1mpytest tardis --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append -m "not continuum"[0m
2025-02-21T11:37:30.9641708Z shell: /usr/bin/bash -l {0}
2025-02-21T11:37:30.9641989Z env:
2025-02-21T11:37:30.9642167Z   CACHE_NUMBER: 0
2025-02-21T11:37:30.9642797Z   PYTEST_FLAGS: --tardis-regression-data=/home/runner/work/tardis/tardis/tardis-regression-data --cov=tardis --cov-report=xml --cov-report=html --cov-append
2025-02-21T11:37:30.9643456Z   CODECOV_TOKEN: 
2025-02-21T11:37:30.9643677Z   MAMBA_ROOT_PREFIX: /home/runner/micromamba
2025-02-21T11:37:30.9643990Z   MAMBA_EXE: /home/runner/micromamba-bin/micromamba
2025-02-21T11:37:30.9644340Z   CONDARC: /home/runner/work/_temp/setup-micromamba/.condarc
2025-02-21T11:37:30.9644682Z ##[endgroup]
2025-02-21T11:37:39.3628020Z ============================= test session starts ==============================
2025-02-21T11:37:39.3628802Z platform linux -- Python 3.12.4, pytest-8.2.2, pluggy-1.5.0
2025-02-21T11:37:39.3629400Z rootdir: /home/runner/work/tardis/tardis
2025-02-21T11:37:39.3629946Z configfile: pyproject.toml
2025-02-21T11:37:39.3630779Z plugins: metadata-3.1.1, anyio-4.4.0, doctestplus-1.2.1, cov-5.0.0, html-4.1.1
2025-02-21T11:37:39.3631895Z collected 1796 items / 2 deselected / 1794 selected
2025-02-21T11:37:39.3632272Z 
2025-02-21T11:37:44.1638234Z tardis/energy_input/tests/test_energy_source.py ..xxx                    [  0%]
2025-02-21T11:37:47.0798591Z tardis/energy_input/tests/test_gamma_ray_channel.py ...........          [  0%]
2025-02-21T11:37:48.6449078Z tardis/energy_input/tests/test_gamma_ray_grid.py xx.                     [  1%]
2025-02-21T11:37:50.3950488Z tardis/energy_input/tests/test_gamma_ray_interactions.py xx....          [  1%]
2025-02-21T11:37:50.4042107Z tardis/energy_input/tests/test_gamma_ray_packet_source.py sssssssss      [  1%]
2025-02-21T11:37:51.6756070Z tardis/energy_input/tests/test_util.py .....xxxx.....                    [  2%]
2025-02-21T11:37:52.0500598Z tardis/grid/tests/test_grid.py .                                         [  2%]
2025-02-21T11:37:52.0521731Z tardis/gui/tests/test_gui.py s                                           [  2%]
2025-02-21T11:37:55.8584320Z tardis/io/configuration/tests/test_config_reader.py ...........          [  3%]
2025-02-21T11:37:55.8709591Z tardis/io/configuration/tests/test_configuration_namespace.py .........  [  3%]
2025-02-21T11:37:55.8982508Z tardis/io/logger/tests/test_logging.py ssssssssssssssssssssssssssss      [  5%]
2025-02-21T11:38:32.9940929Z tardis/io/model/readers/tests/test_arepo_parser.py ..                    [  5%]
2025-02-21T11:38:33.0100491Z tardis/io/model/readers/tests/test_ascii_readers.py ...                  [  5%]
2025-02-21T11:38:33.0203590Z tardis/io/model/readers/tests/test_cmfgen_reader.py ..                   [  5%]
2025-02-21T11:38:33.0500434Z tardis/io/model/readers/tests/test_csvy_reader.py ....                   [  6%]
2025-02-21T11:38:33.0702730Z tardis/io/model/readers/tests/test_stella_reader.py ..                   [  6%]
2025-02-21T11:38:33.3754854Z tardis/io/tests/test_HDFWriter.py ...............                        [  7%]
2025-02-21T11:38:33.6908951Z tardis/io/tests/test_atomic.py .....                                     [  7%]
2025-02-21T11:38:33.7125216Z tardis/io/tests/test_decay.py ..                                         [  7%]
2025-02-21T11:38:33.9136985Z tardis/io/tests/test_model_reader.py ......                              [  7%]
2025-02-21T11:38:33.9205409Z tardis/model/geometry/tests/test_radial1d.py ..                          [  7%]
2025-02-21T11:39:31.3606263Z tardis/model/tests/test_base.py ........................................ [ 10%]
2025-02-21T11:39:32.3601297Z ............                                                             [ 10%]
2025-02-21T11:39:35.4104937Z tardis/model/tests/test_csvy_model.py .........                          [ 11%]
2025-02-21T11:39:35.4577170Z tardis/model/tests/test_density.py ..                                    [ 11%]
2025-02-21T11:39:36.7485708Z tardis/opacities/tests/test_opacity_solver.py .....                      [ 11%]
2025-02-21T11:39:38.0655154Z tardis/opacities/tests/test_opacity_state_numba.py .....                 [ 11%]
2025-02-21T11:39:39.6531426Z tardis/opacities/tests/test_tau_sobolev.py ..                            [ 12%]
2025-02-21T11:39:42.6620250Z tardis/plasma/equilibrium/tests/test_collisional_transitions.py ...      [ 12%]
2025-02-21T11:40:29.0342115Z tardis/plasma/equilibrium/tests/test_level_populations.py ....           [ 12%]
2025-02-21T11:40:40.8309649Z tardis/plasma/equilibrium/tests/test_rate_matrix.py .                    [ 12%]
2025-02-21T11:40:42.2636626Z tardis/plasma/tests/test_complete_plasmas.py ..............s......s..... [ 13%]
2025-02-21T11:40:45.1452453Z s....ssssss............s......s.....ss.....s....ssssss............s..... [ 18%]
2025-02-21T11:40:47.0801643Z .s.....ss.....s....ssssss............s......s.....ss.....s....ssssss.... [ 22%]
2025-02-21T11:40:49.9366700Z ........s......s.....ss.....s....ssssss............s......s.....ss.....s [ 26%]
2025-02-21T11:40:52.7652739Z ....ssssss............s......s.....ss.....s....ssssss............s...... [ 30%]
2025-02-21T11:40:53.4708210Z s.....ss.....s....ssssss............s......s.....ss.....s.ss.ssssss..... [ 34%]
2025-02-21T11:40:56.3633941Z .......s......s.....ss.....s....ssssss............s......s.....ss.....s. [ 38%]
2025-02-21T11:40:59.5359212Z ...ssssss............s......s.....ss.....s....ssssss............s......s [ 42%]
2025-02-21T11:41:02.6061116Z .....ss.....s....ssssss............s......s.....s...........ssssss...... [ 46%]
2025-02-21T11:41:04.4120677Z ......s......s.....s...........ssssss............s......s.....s......... [ 50%]
2025-02-21T11:41:07.3242382Z ..ssssss............s......s.....ss.....s....ssssss............s......s. [ 54%]
2025-02-21T11:41:10.7962057Z ....ss.....s....ssssss...................s......s.....s....ssss......... [ 58%]
2025-02-21T11:41:11.0841304Z ............s......s.....s....ssss.......                                [ 60%]
2025-02-21T11:41:11.2033430Z tardis/plasma/tests/test_hdf_plasma.py ................................. [ 62%]
2025-02-21T11:41:11.2145306Z ......                                                                   [ 62%]
2025-02-21T11:41:11.3516182Z tardis/plasma/tests/test_nlte_excitation.py ...                          [ 62%]
2025-02-21T11:43:30.2862021Z tardis/plasma/tests/test_nlte_solver.py .....X                           [ 63%]
2025-02-21T11:43:30.2888314Z tardis/plasma/tests/test_plasma_continuum.py .                           [ 63%]
2025-02-21T11:43:54.7824201Z tardis/plasma/tests/test_plasma_vboundary.py .............               [ 63%]
2025-02-21T11:44:08.3640035Z tardis/plasma/tests/test_tardis_model_density_config.py ...              [ 64%]
2025-02-21T11:44:09.1238512Z tardis/simulation/tests/test_convergence.py .....                        [ 64%]
2025-02-21T11:44:18.0105261Z tardis/simulation/tests/test_simulation.py .............                 [ 65%]
2025-02-21T11:44:18.0299180Z tardis/spectrum/tests/test_cuda_formal_integral.py sssssssssssssssssssss [ 66%]
2025-02-21T11:44:18.5593057Z ssss...ssssssssssssssssssssss                                            [ 67%]
2025-02-21T11:44:18.5668213Z tardis/spectrum/tests/test_luminosity.py ....                            [ 68%]
2025-02-21T11:44:20.2460641Z tardis/spectrum/tests/test_numba_formal_integral.py .................... [ 69%]
2025-02-21T11:44:20.2655119Z ..........                                                               [ 69%]
2025-02-21T11:44:20.4478395Z tardis/spectrum/tests/test_spectrum.py ................................. [ 71%]
2025-02-21T11:44:20.4822404Z .........                                                                [ 72%]
2025-02-21T11:44:20.5715710Z tardis/spectrum/tests/test_spectrum_solver.py .FFF                       [ 72%]
2025-02-21T11:44:52.6477621Z tardis/tests/test_tardis_full.py .FFF                                    [ 72%]
2025-02-21T11:46:18.6499701Z tardis/tests/test_tardis_full_formal_integral.py ................        [ 73%]
2025-02-21T11:46:18.7271930Z tardis/tests/test_util.py .............................................  [ 75%]
2025-02-21T11:46:21.5207961Z tardis/transport/montecarlo/tests/test_base.py x.....................    [ 77%]
2025-02-21T11:46:28.8883749Z tardis/transport/montecarlo/tests/test_interaction.py .......            [ 77%]
2025-02-21T11:46:29.1062870Z tardis/transport/montecarlo/tests/test_macro_atom.py ....                [ 77%]
2025-02-21T11:46:29.1269639Z tardis/transport/montecarlo/tests/test_montecarlo.py sssssssssssssssssss [ 78%]
2025-02-21T11:46:29.1723665Z sssssssssssssssssssssssssssssssssssssssssssss                            [ 81%]
2025-02-21T11:46:38.7738072Z tardis/transport/montecarlo/tests/test_montecarlo_main_loop.py x..       [ 81%]
2025-02-21T11:46:38.7803692Z tardis/transport/montecarlo/tests/test_nonhomologous.py ...              [ 81%]
2025-02-21T11:46:44.8954666Z tardis/transport/montecarlo/tests/test_numba_interface.py .....x.        [ 82%]
2025-02-21T11:46:45.3801972Z tardis/transport/montecarlo/tests/test_opacities.py ...............      [ 82%]
2025-02-21T11:46:46.4342617Z tardis/transport/montecarlo/tests/test_packet.py .................xXXXXX [ 84%]
2025-02-21T11:46:46.5758473Z XX.........                                                              [ 84%]
2025-02-21T11:46:46.6043057Z tardis/transport/montecarlo/tests/test_packet_source.py ........         [ 85%]
2025-02-21T11:46:46.9457373Z tardis/transport/montecarlo/tests/test_rpacket_last_interaction_tracker.py . [ 85%]
2025-02-21T11:46:47.3703099Z .....                                                                    [ 85%]
2025-02-21T11:47:22.9118844Z tardis/transport/montecarlo/tests/test_rpacket_tracker.py ......         [ 85%]
2025-02-21T11:47:22.9406296Z tardis/transport/montecarlo/tests/test_single_packet_loop.py xxx         [ 86%]
2025-02-21T11:47:22.9437972Z tardis/transport/montecarlo/tests/test_tracker_utils.py ..               [ 86%]
2025-02-21T11:47:25.4083571Z tardis/transport/montecarlo/tests/test_vpacket.py ..x.                   [ 86%]
2025-02-21T11:47:25.4258988Z tardis/transport/montecarlo/tests/test_weighted_packet_source.py ....    [ 86%]
2025-02-21T11:47:28.8727810Z tardis/transport/montecarlo/tests/test_weighted_packet_source_integration.py . [ 86%]
2025-02-21T11:47:28.8730558Z                                                                          [ 86%]
2025-02-21T11:47:29.6009115Z tardis/transport/tests/test_doppler_factor.py ..................         [ 87%]
2025-02-21T11:47:31.4356519Z tardis/visualization/tools/tests/test_convergence_plot.py .............. [ 88%]
2025-02-21T11:47:33.6738494Z ......                                                                   [ 88%]
2025-02-21T11:47:38.4393881Z tardis/visualization/tools/tests/test_liv_plot.py ...................... [ 90%]
2025-02-21T11:47:41.1493993Z .............................                                            [ 91%]
2025-02-21T11:47:44.0028454Z tardis/visualization/tools/tests/test_rpacket_plot.py .................. [ 92%]
2025-02-21T11:47:51.0185597Z ....                                                                     [ 92%]
2025-02-21T11:47:57.1363241Z tardis/visualization/tools/tests/test_sdec_plot.py ..................... [ 94%]
2025-02-21T11:48:05.2645770Z ..............................                                           [ 95%]
2025-02-21T11:48:05.7021518Z tardis/visualization/widgets/tests/test_custom_abundance.py ........ss.. [ 96%]
2025-02-21T11:48:05.7745479Z ....                                                                     [ 96%]
2025-02-21T11:48:06.8323179Z tardis/visualization/widgets/tests/test_line_info.py ................... [ 97%]
2025-02-21T11:48:07.4712726Z ..................                                                       [ 98%]
2025-02-21T11:49:10.8426684Z tardis/visualization/widgets/tests/test_shell_info.py .................. [ 99%]
2025-02-21T11:49:19.0053199Z ......                                                                   [100%]
2025-02-21T11:49:19.0053712Z 
2025-02-21T11:49:19.0053906Z =================================== FAILURES ===================================
2025-02-21T11:49:19.0054583Z ________________ TestSpectrumSolver.test_spectrum_real_packets _________________
2025-02-21T11:49:19.0055096Z 
2025-02-21T11:49:19.0055540Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7fe200eac440>
2025-02-21T11:49:19.0056559Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fe1ffc769f0>
2025-02-21T11:49:19.0057144Z 
2025-02-21T11:49:19.0057431Z     def test_spectrum_real_packets(self, simulation_regression_data):
2025-02-21T11:49:19.0058180Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T11:49:19.0059058Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T11:49:19.0059746Z     
2025-02-21T11:49:19.0060452Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T11:49:19.0061219Z         result = solver.spectrum_real_packets.luminosity
2025-02-21T11:49:19.0061953Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T11:49:19.0062627Z         expected = self.get_expected_data(key)
2025-02-21T11:49:19.0063368Z     
2025-02-21T11:49:19.0063696Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T11:49:19.0064135Z     
2025-02-21T11:49:19.0064426Z >       assert_quantity_allclose(
2025-02-21T11:49:19.0064810Z             result,
2025-02-21T11:49:19.0065119Z             luminosity,
2025-02-21T11:49:19.0065436Z         )
2025-02-21T11:49:19.0065604Z 
2025-02-21T11:49:19.0065816Z tardis/spectrum/tests/test_spectrum_solver.py:61: 
2025-02-21T11:49:19.0066346Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0067279Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T11:49:19.0068176Z     np.testing.assert_allclose(
2025-02-21T11:49:19.0068611Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0068956Z 
2025-02-21T11:49:19.0069789Z args = (<function assert_allclose.<locals>.compare at 0x7fe1d2d64360>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T11:49:19.0071153Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T11:49:19.0071951Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T11:49:19.0072585Z 
2025-02-21T11:49:19.0072721Z     @wraps(func)
2025-02-21T11:49:19.0073080Z     def inner(*args, **kwds):
2025-02-21T11:49:19.0073491Z         with self._recreate_cm():
2025-02-21T11:49:19.0073904Z >           return func(*args, **kwds)
2025-02-21T11:49:19.0074324Z E           AssertionError: 
2025-02-21T11:49:19.0074741Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0075184Z E           
2025-02-21T11:49:19.0075514Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T11:49:19.0075985Z E           Max absolute difference: 1.94155993e+40
2025-02-21T11:49:19.0076455Z E           Max relative difference: 137.15340685
2025-02-21T11:49:19.0077008Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0077557Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0078075Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T11:49:19.0078614Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0078892Z 
2025-02-21T11:49:19.0079235Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T11:49:19.0080478Z ___________ TestSpectrumSolver.test_spectrum_real_packets_reabsorbed ___________
2025-02-21T11:49:19.0080968Z 
2025-02-21T11:49:19.0081432Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7fe200eac6e0>
2025-02-21T11:49:19.0082426Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fe1ffc769f0>
2025-02-21T11:49:19.0083043Z 
2025-02-21T11:49:19.0083402Z     def test_spectrum_real_packets_reabsorbed(self, simulation_regression_data):
2025-02-21T11:49:19.0084276Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T11:49:19.0085257Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T11:49:19.0086020Z     
2025-02-21T11:49:19.0086557Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T11:49:19.0087359Z         result = solver.spectrum_real_packets_reabsorbed.luminosity
2025-02-21T11:49:19.0088224Z         key = "simulation/spectrum_solver/spectrum_real_packets_reabsorbed/luminosity"
2025-02-21T11:49:19.0088976Z         expected = self.get_expected_data(key)
2025-02-21T11:49:19.0089429Z     
2025-02-21T11:49:19.0089792Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T11:49:19.0090520Z     
2025-02-21T11:49:19.0090848Z >       assert_quantity_allclose(
2025-02-21T11:49:19.0091271Z             result,
2025-02-21T11:49:19.0091606Z             luminosity,
2025-02-21T11:49:19.0092188Z         )
2025-02-21T11:49:19.0092367Z 
2025-02-21T11:49:19.0092582Z tardis/spectrum/tests/test_spectrum_solver.py:77: 
2025-02-21T11:49:19.0093135Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0094134Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T11:49:19.0095114Z     np.testing.assert_allclose(
2025-02-21T11:49:19.0095589Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0095972Z 
2025-02-21T11:49:19.0096616Z args = (<function assert_allclose.<locals>.compare at 0x7fe1d2d67ce0>, array([0., 0., 0., ..., 0., 0., 0.]), array([2.03920412e+38, 3.72882494e+38, 2.29646943e+38, ...,
2025-02-21T11:49:19.0097577Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T11:49:19.0098296Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T11:49:19.0098861Z 
2025-02-21T11:49:19.0098992Z     @wraps(func)
2025-02-21T11:49:19.0099317Z     def inner(*args, **kwds):
2025-02-21T11:49:19.0099705Z         with self._recreate_cm():
2025-02-21T11:49:19.0100325Z >           return func(*args, **kwds)
2025-02-21T11:49:19.0100770Z E           AssertionError: 
2025-02-21T11:49:19.0101195Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0101626Z E           
2025-02-21T11:49:19.0102113Z E           Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T11:49:19.0102596Z E           Max absolute difference: 1.0639846e+40
2025-02-21T11:49:19.0103039Z E           Max relative difference: 122.79315318
2025-02-21T11:49:19.0103507Z E            x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T11:49:19.0104062Z E            y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T11:49:19.0104630Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0104928Z 
2025-02-21T11:49:19.0105275Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T11:49:19.0106081Z ________________________ TestSpectrumSolver.test_solve _________________________
2025-02-21T11:49:19.0106550Z 
2025-02-21T11:49:19.0107014Z self = <tardis.spectrum.tests.test_spectrum_solver.TestSpectrumSolver object at 0x7fe200ead0d0>
2025-02-21T11:49:19.0108026Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fe1ffc769f0>
2025-02-21T11:49:19.0108616Z 
2025-02-21T11:49:19.0108822Z     def test_solve(self, simulation_regression_data):
2025-02-21T11:49:19.0109734Z         transport_state = simulation_regression_data.transport.transport_state
2025-02-21T11:49:19.0110930Z         spectrum_frequency_grid = simulation_regression_data.transport.spectrum_frequency_grid
2025-02-21T11:49:19.0111663Z     
2025-02-21T11:49:19.0112134Z         solver = SpectrumSolver(transport_state, spectrum_frequency_grid, None)
2025-02-21T11:49:19.0112824Z         result_real, result_virtual, result_integrated = solver.solve(
2025-02-21T11:49:19.0113320Z             transport_state
2025-02-21T11:49:19.0113638Z         )
2025-02-21T11:49:19.0114086Z         key_real = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T11:49:19.0114703Z         expected_real = self.get_expected_data(key_real)
2025-02-21T11:49:19.0115174Z     
2025-02-21T11:49:19.0115536Z         luminosity_real = u.Quantity(expected_real, "erg /s")
2025-02-21T11:49:19.0116009Z     
2025-02-21T11:49:19.0116286Z >       assert_quantity_allclose(
2025-02-21T11:49:19.0116690Z             result_real.luminosity,
2025-02-21T11:49:19.0117088Z             luminosity_real,
2025-02-21T11:49:19.0117434Z         )
2025-02-21T11:49:19.0117588Z 
2025-02-21T11:49:19.0117797Z tardis/spectrum/tests/test_spectrum_solver.py:95: 
2025-02-21T11:49:19.0118309Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0119208Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T11:49:19.0120518Z     np.testing.assert_allclose(
2025-02-21T11:49:19.0120956Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0121344Z 
2025-02-21T11:49:19.0122140Z args = (<function assert_allclose.<locals>.compare at 0x7fe1d2d67d80>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.33511090e+39, 1.33738696e+39, 9.41598476e+38, ...,
2025-02-21T11:49:19.0123237Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T11:49:19.0123951Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T11:49:19.0124503Z 
2025-02-21T11:49:19.0124630Z     @wraps(func)
2025-02-21T11:49:19.0124948Z     def inner(*args, **kwds):
2025-02-21T11:49:19.0125317Z         with self._recreate_cm():
2025-02-21T11:49:19.0125715Z >           return func(*args, **kwds)
2025-02-21T11:49:19.0126114Z E           AssertionError: 
2025-02-21T11:49:19.0126525Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0126957Z E           
2025-02-21T11:49:19.0127283Z E           Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T11:49:19.0127749Z E           Max absolute difference: 1.94155993e+40
2025-02-21T11:49:19.0128202Z E           Max relative difference: 137.15340685
2025-02-21T11:49:19.0128535Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0128856Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0129167Z E            y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T11:49:19.0129472Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0129633Z 
2025-02-21T11:49:19.0129836Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T11:49:19.0130493Z __________________ TestTransportSimple.test_j_blue_estimators __________________
2025-02-21T11:49:19.0130763Z 
2025-02-21T11:49:19.0130979Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7fe200ead8e0>
2025-02-21T11:49:19.0131515Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fe1ffc769f0>
2025-02-21T11:49:19.0131839Z 
2025-02-21T11:49:19.0131993Z     def test_j_blue_estimators(self, simulation_regression_data):
2025-02-21T11:49:19.0132370Z         key = "simulation/transport/transport_state/j_blue_estimator"
2025-02-21T11:49:19.0132700Z         expected = self.get_expected_data(key)
2025-02-21T11:49:19.0133111Z     
2025-02-21T11:49:19.0133285Z >       npt.assert_allclose(
2025-02-21T11:49:19.0133703Z             simulation_regression_data.transport.transport_state.radfield_mc_estimators.j_blue_estimator,
2025-02-21T11:49:19.0134137Z             expected.values,
2025-02-21T11:49:19.0134346Z         )
2025-02-21T11:49:19.0134444Z 
2025-02-21T11:49:19.0134537Z tardis/tests/test_tardis_full.py:60: 
2025-02-21T11:49:19.0134821Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0135025Z 
2025-02-21T11:49:19.0135354Z args = (<function assert_allclose.<locals>.compare at 0x7fe1fa481e40>, array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0135772Z        [0., 0., .....,
2025-02-21T11:49:19.0135966Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0136189Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0136411Z        [0., 0., 0., ..., 0., 0., 0.]]))
2025-02-21T11:49:19.0136807Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T11:49:19.0137135Z 
2025-02-21T11:49:19.0137208Z     @wraps(func)
2025-02-21T11:49:19.0137404Z     def inner(*args, **kwds):
2025-02-21T11:49:19.0137629Z         with self._recreate_cm():
2025-02-21T11:49:19.0137865Z >           return func(*args, **kwds)
2025-02-21T11:49:19.0138106Z E           AssertionError: 
2025-02-21T11:49:19.0138352Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0138731Z E           
2025-02-21T11:49:19.0138936Z E           Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T11:49:19.0139223Z E           Max absolute difference: 1.43452643e-17
2025-02-21T11:49:19.0139497Z E           Max relative difference: 235.31367318
2025-02-21T11:49:19.0139761Z E            x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0140011Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0140422Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T11:49:19.0140679Z E            y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0140925Z E                  [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0141166Z E                  [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T11:49:19.0141332Z 
2025-02-21T11:49:19.0141534Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T11:49:19.0141988Z ______________________ TestTransportSimple.test_spectrum _______________________
2025-02-21T11:49:19.0142248Z 
2025-02-21T11:49:19.0142463Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7fe200eadc40>
2025-02-21T11:49:19.0143010Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fe1ffc769f0>
2025-02-21T11:49:19.0143341Z 
2025-02-21T11:49:19.0143470Z     def test_spectrum(self, simulation_regression_data):
2025-02-21T11:49:19.0143853Z         key = "simulation/spectrum_solver/spectrum_real_packets/luminosity"
2025-02-21T11:49:19.0144222Z         expected = self.get_expected_data(key)
2025-02-21T11:49:19.0144478Z     
2025-02-21T11:49:19.0144676Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T11:49:19.0144931Z     
2025-02-21T11:49:19.0145104Z >       assert_quantity_allclose(
2025-02-21T11:49:19.0145469Z             simulation_regression_data.spectrum_solver.spectrum_real_packets.luminosity,
2025-02-21T11:49:19.0145840Z             luminosity,
2025-02-21T11:49:19.0146033Z         )
2025-02-21T11:49:19.0146127Z 
2025-02-21T11:49:19.0146231Z tardis/tests/test_tardis_full.py:71: 
2025-02-21T11:49:19.0146509Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0147037Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T11:49:19.0147536Z     np.testing.assert_allclose(
2025-02-21T11:49:19.0147805Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0148012Z 
2025-02-21T11:49:19.0148482Z args = (<function assert_allclose.<locals>.compare at 0x7fe1ff864f40>, array([0.00000000e+00, 0.00000000e+00, 2.76120259e+39,...), array([1.47119190e+39, 1.69564189e+39, 1.35368464e+39, ...,
2025-02-21T11:49:19.0149287Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T11:49:19.0149712Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T11:49:19.0150035Z 
2025-02-21T11:49:19.0150261Z     @wraps(func)
2025-02-21T11:49:19.0150481Z     def inner(*args, **kwds):
2025-02-21T11:49:19.0150709Z         with self._recreate_cm():
2025-02-21T11:49:19.0150948Z >           return func(*args, **kwds)
2025-02-21T11:49:19.0151198Z E           AssertionError: 
2025-02-21T11:49:19.0151447Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0151707Z E           
2025-02-21T11:49:19.0151910Z E           Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T11:49:19.0152187Z E           Max absolute difference: 1.96604107e+40
2025-02-21T11:49:19.0152480Z E           Max relative difference: 97.03021569
2025-02-21T11:49:19.0152813Z E            x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0153137Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0153445Z E            y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0153756Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0154052Z 
2025-02-21T11:49:19.0154259Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T11:49:19.0154725Z __________________ TestTransportSimple.test_virtual_spectrum ___________________
2025-02-21T11:49:19.0155072Z 
2025-02-21T11:49:19.0155288Z self = <tardis.tests.test_tardis_full.TestTransportSimple object at 0x7fe200eadf10>
2025-02-21T11:49:19.0155883Z simulation_regression_data = <tardis.simulation.base.Simulation object at 0x7fe1ffc769f0>
2025-02-21T11:49:19.0156210Z 
2025-02-21T11:49:19.0156370Z     def test_virtual_spectrum(self, simulation_regression_data):
2025-02-21T11:49:19.0156777Z         key = "simulation/spectrum_solver/spectrum_virtual_packets/luminosity"
2025-02-21T11:49:19.0157170Z         expected = self.get_expected_data(key)
2025-02-21T11:49:19.0157438Z     
2025-02-21T11:49:19.0157634Z         luminosity = u.Quantity(expected, "erg /s")
2025-02-21T11:49:19.0157882Z     
2025-02-21T11:49:19.0158054Z >       assert_quantity_allclose(
2025-02-21T11:49:19.0158431Z             simulation_regression_data.spectrum_solver.spectrum_virtual_packets.luminosity,
2025-02-21T11:49:19.0158861Z             luminosity,
2025-02-21T11:49:19.0159061Z         )
2025-02-21T11:49:19.0159160Z 
2025-02-21T11:49:19.0159258Z tardis/tests/test_tardis_full.py:82: 
2025-02-21T11:49:19.0159533Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0160062Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/astropy/tests/helper.py:203: in assert_quantity_allclose
2025-02-21T11:49:19.0160715Z     np.testing.assert_allclose(
2025-02-21T11:49:19.0160972Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-02-21T11:49:19.0161168Z 
2025-02-21T11:49:19.0161641Z args = (<function assert_allclose.<locals>.compare at 0x7fe1f8b8a980>, array([1.31895331e+39, 2.31381538e+39, 3.72000430e+39,...), array([1.44033177e+39, 1.35611403e+39, 1.39755698e+39, ...,
2025-02-21T11:49:19.0162285Z        0.00000000e+00, 0.00000000e+00, 0.00000000e+00]))
2025-02-21T11:49:19.0162711Z kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}
2025-02-21T11:49:19.0163039Z 
2025-02-21T11:49:19.0163111Z     @wraps(func)
2025-02-21T11:49:19.0163305Z     def inner(*args, **kwds):
2025-02-21T11:49:19.0163532Z         with self._recreate_cm():
2025-02-21T11:49:19.0163770Z >           return func(*args, **kwds)
2025-02-21T11:49:19.0164022Z E           AssertionError: 
2025-02-21T11:49:19.0164266Z E           Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0164655Z E           
2025-02-21T11:49:19.0164853Z E           Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T11:49:19.0165131Z E           Max absolute difference: 4.69537822e+39
2025-02-21T11:49:19.0165408Z E           Max relative difference: 419.77405263
2025-02-21T11:49:19.0165790Z E            x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0166114Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0166427Z E            y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0166739Z E                  0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0166906Z 
2025-02-21T11:49:19.0167101Z ../../../micromamba/envs/tardis/lib/python3.12/contextlib.py:81: AssertionError
2025-02-21T11:49:19.0167499Z =============================== warnings summary ===============================
2025-02-21T11:49:19.0167811Z tardis/io/configuration/config_validator.py:6
2025-02-21T11:49:19.0168117Z tardis/io/configuration/config_validator.py:6
2025-02-21T11:49:19.0168608Z   /home/runner/work/tardis/tardis/tardis/io/configuration/config_validator.py:6: DeprecationWarning:
2025-02-21T11:49:19.0169107Z   
2025-02-21T11:49:19.0170502Z   jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
2025-02-21T11:49:19.0171860Z 
2025-02-21T11:49:19.0172109Z ../../../micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22
2025-02-21T11:49:19.0172790Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/jupyter_client/connect.py:22: DeprecationWarning:
2025-02-21T11:49:19.0173303Z   
2025-02-21T11:49:19.0173548Z   Jupyter is migrating its paths to use standard platformdirs
2025-02-21T11:49:19.0173938Z   given by the platformdirs library.  To remove this warning and
2025-02-21T11:49:19.0174337Z   see the appropriate new directories, set the environment variable
2025-02-21T11:49:19.0174774Z   `JUPYTER_PLATFORM_DIRS=1` and then run `jupyter --paths`.
2025-02-21T11:49:19.0175178Z   The use of platformdirs will be the default in `jupyter_core` v6
2025-02-21T11:49:19.0175420Z 
2025-02-21T11:49:19.0182031Z tardis/io/tests/test_HDFWriter.py::test_multi_index_write
2025-02-21T11:49:19.0182602Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T11:49:19.0183174Z   /home/runner/work/tardis/tardis/tardis/io/util.py:276: PerformanceWarning:
2025-02-21T11:49:19.0183545Z   
2025-02-21T11:49:19.0183704Z   
2025-02-21T11:49:19.0184000Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T11:49:19.0184560Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T11:49:19.0184918Z 
2025-02-21T11:49:19.0185121Z tardis/io/tests/test_model_reader.py::test_read_cmfgen_isotope_abundances
2025-02-21T11:49:19.0185612Z tardis/plasma/tests/test_tardis_model_density_config.py::test_electron_densities
2025-02-21T11:49:19.0186188Z tardis/plasma/tests/test_tardis_model_density_config.py::test_isotope_number_densities
2025-02-21T11:49:19.0186691Z tardis/plasma/tests/test_tardis_model_density_config.py::test_t_rad
2025-02-21T11:49:19.0187274Z   /home/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:82: DeprecationWarning:
2025-02-21T11:49:19.0187746Z   
2025-02-21T11:49:19.0187951Z   The current CMFGEN model parser is deprecated
2025-02-21T11:49:19.0188149Z 
2025-02-21T11:49:19.0188264Z tardis/io/tests/test_model_reader.py: 1 warning
2025-02-21T11:49:19.0188628Z tardis/plasma/tests/test_tardis_model_density_config.py: 9 warnings
2025-02-21T11:49:19.0189188Z   /home/runner/work/tardis/tardis/tardis/io/model/readers/cmfgen_deprecated.py:40: DeprecationWarning:
2025-02-21T11:49:19.0189829Z   
2025-02-21T11:49:19.0190025Z   The current CMFGEN model parser is deprecated
2025-02-21T11:49:19.0190432Z 
2025-02-21T11:49:19.0190651Z tardis/model/tests/test_base.py::TestModelFromPaper1Config::test_abundances
2025-02-21T11:49:19.0191301Z   /home/runner/work/tardis/tardis/tardis/transport/montecarlo/montecarlo_main_loop.py:123: NumbaTypeSafetyWarning:
2025-02-21T11:49:19.0191815Z   
2025-02-21T11:49:19.0192338Z   [1m[1m[1munsafe cast from uint64 to int64. Precision may be lost.[0m[0m[0m
2025-02-21T11:49:19.0192610Z 
2025-02-21T11:49:19.0192715Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T11:49:19.0193009Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T11:49:19.0193381Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T11:49:19.0193919Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:50: DeprecationWarning:
2025-02-21T11:49:19.0194347Z   
2025-02-21T11:49:19.0194535Z   v_inner_boundary < 0, assuming default value
2025-02-21T11:49:19.0194720Z 
2025-02-21T11:49:19.0194824Z tardis/model/tests/test_base.py: 6 warnings
2025-02-21T11:49:19.0195116Z tardis/model/tests/test_csvy_model.py: 2 warnings
2025-02-21T11:49:19.0195483Z tardis/plasma/tests/test_tardis_model_density_config.py: 3 warnings
2025-02-21T11:49:19.0196006Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:61: DeprecationWarning:
2025-02-21T11:49:19.0196562Z   
2025-02-21T11:49:19.0196751Z   v_outer_boundary < 0, assuming default value
2025-02-21T11:49:19.0196937Z 
2025-02-21T11:49:19.0197390Z tardis/plasma/equilibrium/tests/test_level_populations.py::TestLevelPopulationSolver::test_solve[collisional_rate_solver0-radiative_transitions0]
2025-02-21T11:49:19.0198207Z   /home/runner/work/tardis/tardis/tardis/plasma/equilibrium/level_populations.py:65: FutureWarning:
2025-02-21T11:49:19.0198655Z   
2025-02-21T11:49:19.0199015Z   A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
2025-02-21T11:49:19.0199810Z   The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.
2025-02-21T11:49:19.0200568Z   
2025-02-21T11:49:19.0201176Z   For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.
2025-02-21T11:49:19.0201774Z 
2025-02-21T11:49:19.0201990Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3750]
2025-02-21T11:49:19.0202486Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3850]
2025-02-21T11:49:19.0202966Z tardis/plasma/tests/test_plasma_vboundary.py::test_plasma_vboundary[2900-3900]
2025-02-21T11:49:19.0203483Z   /home/runner/work/tardis/tardis/tardis/model/geometry/radial1d.py:71: UserWarning:
2025-02-21T11:49:19.0203871Z   
2025-02-21T11:49:19.0204146Z   Requesting inner boundary below inner shell. Extrapolating the inner cell
2025-02-21T11:49:19.0204421Z 
2025-02-21T11:49:19.0204626Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T11:49:19.0205113Z   /home/runner/work/tardis/tardis/tardis/spectrum/base.py:70: UserWarning:
2025-02-21T11:49:19.0205468Z   
2025-02-21T11:49:19.0205874Z   SpectrumSolver.spectrum_virtual_packets is zero. Please run the montecarlo simulation with no_of_virtual_packets > 0
2025-02-21T11:49:19.0206285Z 
2025-02-21T11:49:19.0206502Z tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve
2025-02-21T11:49:19.0206993Z   /home/runner/work/tardis/tardis/tardis/spectrum/base.py:111: UserWarning:
2025-02-21T11:49:19.0207337Z   
2025-02-21T11:49:19.0207758Z   SpectrumSolver.integrator: The FormalIntegrator is not yet available.Please run the montecarlo simulation at least once.
2025-02-21T11:49:19.0208180Z 
2025-02-21T11:49:19.0208517Z tardis/transport/montecarlo/tests/test_vpacket.py::test_trace_vpacket_volley
2025-02-21T11:49:19.0208925Z   <string>:3: NumbaPendingDeprecationWarning:
2025-02-21T11:49:19.0209178Z   
2025-02-21T11:49:19.0210499Z   [1m[1mCode using Numba extension API maybe depending on 'old_style' error-capturing, which is deprecated and will be replaced by 'new_style' in a future release. See details at https://numba.readthedocs.io/en/latest/reference/deprecation.html#deprecation-of-old-style-numba-captured-errors
2025-02-21T11:49:19.0211524Z   Exception origin:
2025-02-21T11:49:19.0211907Z     File "/home/runner/micromamba/envs/tardis/lib/python3.12/inspect.py", line 3180, in _bind
2025-02-21T11:49:19.0212342Z       raise TypeError(msg) from None
2025-02-21T11:49:19.0212604Z   [0m[0m
2025-02-21T11:49:19.0212702Z 
2025-02-21T11:49:19.0213040Z tardis/visualization/tools/tests/test_sdec_plot.py::TestSDECPlotter::test_mpl_image[plotter_generate_plot_mpl4]
2025-02-21T11:49:19.0213733Z   /home/runner/work/tardis/tardis/tardis/visualization/tools/sdec_plot.py:1225: RuntimeWarning:
2025-02-21T11:49:19.0214181Z   
2025-02-21T11:49:19.0215125Z   More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
2025-02-21T11:49:19.0216054Z 
2025-02-21T11:49:19.0216566Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0217346Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0218119Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0218881Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0219653Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0220621Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0221438Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T11:49:19.0221945Z   
2025-02-21T11:49:19.0222225Z   Passing unrecognized arguments to super(Checkbox).__init__(icon='lock').
2025-02-21T11:49:19.0222674Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T11:49:19.0223171Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T11:49:19.0223496Z 
2025-02-21T11:49:19.0223844Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0224616Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0225381Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T11:49:19.0225880Z   
2025-02-21T11:49:19.0226144Z   Passing unrecognized arguments to super(FloatText).__init__(min=0).
2025-02-21T11:49:19.0226575Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T11:49:19.0227064Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T11:49:19.0227377Z 
2025-02-21T11:49:19.0227727Z tardis/visualization/widgets/tests/test_custom_abundance.py::TestCustomAbundanceWidget::test_update_input_item_value
2025-02-21T11:49:19.0228493Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/traitlets/traitlets.py:1385: DeprecationWarning:
2025-02-21T11:49:19.0228985Z   
2025-02-21T11:49:19.0229247Z   Passing unrecognized arguments to super(HTML).__init__(indent=True).
2025-02-21T11:49:19.0229887Z   object.__init__() takes exactly one argument (the instance to initialize)
2025-02-21T11:49:19.0230546Z   This is deprecated in traitlets 4.2.This error will be raised in a future release of traitlets.
2025-02-21T11:49:19.0230869Z 
2025-02-21T11:49:19.0231298Z tardis/visualization/widgets/tests/test_line_info.py::TestLineInfoWidgetData::test_get_species_interactions[wavelength_range0-packet_out_nu]
2025-02-21T11:49:19.0232134Z   /home/runner/micromamba/envs/tardis/lib/python3.12/site-packages/qgridnext/grid.py:820: DeprecationWarning:
2025-02-21T11:49:19.0232622Z   
2025-02-21T11:49:19.0232983Z   QgridWidget._precision_changed is deprecated in traitlets 4.1: use @observe and @unobserve instead.
2025-02-21T11:49:19.0233338Z 
2025-02-21T11:49:19.0233598Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T11:49:19.0234152Z   /home/runner/work/tardis/tardis/tardis/io/util.py:289: PerformanceWarning:
2025-02-21T11:49:19.0234512Z   
2025-02-21T11:49:19.0234669Z   
2025-02-21T11:49:19.0234960Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T11:49:19.0235505Z   map directly to c-types [inferred_type->mixed,key->block0_values] [items->Index([0], dtype='int64')]
2025-02-21T11:49:19.0235849Z 
2025-02-21T11:49:19.0236108Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T11:49:19.0236780Z   /home/runner/work/tardis/tardis/tardis/io/util.py:292: PerformanceWarning:
2025-02-21T11:49:19.0237133Z   
2025-02-21T11:49:19.0237286Z   
2025-02-21T11:49:19.0237572Z   your performance may suffer as PyTables will pickle object types that it cannot
2025-02-21T11:49:19.0238035Z   map directly to c-types [inferred_type->mixed,key->values] [items->None]
2025-02-21T11:49:19.0238306Z 
2025-02-21T11:49:19.0238559Z tardis/visualization/widgets/tests/test_shell_info.py::TestHDFShellInfo::test_shells_data
2025-02-21T11:49:19.0239145Z   /home/runner/work/tardis/tardis/tardis/spectrum/formal_integral.py:398: UserWarning:
2025-02-21T11:49:19.0239551Z   
2025-02-21T11:49:19.0239828Z   The number of interpolate_shells was not specified. The value was set to 80.
2025-02-21T11:49:19.0240248Z 
2025-02-21T11:49:19.0240458Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-02-21T11:49:19.0240737Z 
2025-02-21T11:49:19.0240903Z ---------- coverage: platform linux, python 3.12.4-final-0 -----------
2025-02-21T11:49:19.0241274Z Coverage HTML written to dir coverage_html_report
2025-02-21T11:49:19.0241571Z Coverage XML written to file coverage.xml
2025-02-21T11:49:19.0241752Z 
2025-02-21T11:49:19.0241873Z =========================== short test summary info ============================
2025-02-21T11:49:19.0242445Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets - AssertionError: 
2025-02-21T11:49:19.0242980Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0243162Z 
2025-02-21T11:49:19.0243256Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T11:49:19.0243517Z Max absolute difference: 1.94155993e+40
2025-02-21T11:49:19.0243773Z Max relative difference: 137.15340685
2025-02-21T11:49:19.0244085Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0244399Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0244688Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T11:49:19.0244991Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0245529Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_spectrum_real_packets_reabsorbed - AssertionError: 
2025-02-21T11:49:19.0246096Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0246274Z 
2025-02-21T11:49:19.0246361Z Mismatched elements: 4491 / 10000 (44.9%)
2025-02-21T11:49:19.0246615Z Max absolute difference: 1.0639846e+40
2025-02-21T11:49:19.0246864Z Max relative difference: 122.79315318
2025-02-21T11:49:19.0247235Z  x: array([0., 0., 0., ..., 0., 0., 0.])
2025-02-21T11:49:19.0247534Z  y: array([2.039204e+38, 3.728825e+38, 2.296469e+38, ..., 0.000000e+00,
2025-02-21T11:49:19.0247830Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0248270Z FAILED tardis/spectrum/tests/test_spectrum_solver.py::TestSpectrumSolver::test_solve - AssertionError: 
2025-02-21T11:49:19.0248752Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0248921Z 
2025-02-21T11:49:19.0249019Z Mismatched elements: 4355 / 10000 (43.5%)
2025-02-21T11:49:19.0261146Z Max absolute difference: 1.94155993e+40
2025-02-21T11:49:19.0261655Z Max relative difference: 137.15340685
2025-02-21T11:49:19.0262187Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0262692Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0263143Z  y: array([1.335111e+39, 1.337387e+39, 9.415985e+38, ..., 0.000000e+00,
2025-02-21T11:49:19.0263620Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0264373Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_j_blue_estimators - AssertionError: 
2025-02-21T11:49:19.0265169Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0265460Z 
2025-02-21T11:49:19.0265619Z Mismatched elements: 488044 / 584480 (83.5%)
2025-02-21T11:49:19.0266065Z Max absolute difference: 1.43452643e-17
2025-02-21T11:49:19.0266501Z Max relative difference: 235.31367318
2025-02-21T11:49:19.0266893Z  x: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0267495Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0267854Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T11:49:19.0268228Z  y: array([[0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0268598Z        [0., 0., 0., ..., 0., 0., 0.],
2025-02-21T11:49:19.0268953Z        [0., 0., 0., ..., 0., 0., 0.],...
2025-02-21T11:49:19.0269638Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_spectrum - AssertionError: 
2025-02-21T11:49:19.0270550Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0270856Z 
2025-02-21T11:49:19.0270996Z Mismatched elements: 4560 / 10000 (45.6%)
2025-02-21T11:49:19.0271410Z Max absolute difference: 1.96604107e+40
2025-02-21T11:49:19.0271825Z Max relative difference: 97.03021569
2025-02-21T11:49:19.0272314Z  x: array([0.000000e+00, 0.000000e+00, 2.761203e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0272805Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0273261Z  y: array([1.471192e+39, 1.695642e+39, 1.353685e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0273742Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0274464Z FAILED tardis/tests/test_tardis_full.py::TestTransportSimple::test_virtual_spectrum - AssertionError: 
2025-02-21T11:49:19.0275252Z Not equal to tolerance rtol=1e-07, atol=0
2025-02-21T11:49:19.0275533Z 
2025-02-21T11:49:19.0275677Z Mismatched elements: 5659 / 10000 (56.6%)
2025-02-21T11:49:19.0276094Z Max absolute difference: 4.69537822e+39
2025-02-21T11:49:19.0276505Z Max relative difference: 419.77405263
2025-02-21T11:49:19.0276991Z  x: array([1.318953e+39, 2.313815e+39, 3.720004e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0277486Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0277838Z  y: array([1.440332e+39, 1.356114e+39, 1.397557e+39, ..., 0.000000e+00,
2025-02-21T11:49:19.0278175Z        0.000000e+00, 0.000000e+00])
2025-02-21T11:49:19.0278637Z = 6 failed, 1404 passed, 357 skipped, 2 deselected, 19 xfailed, 8 xpassed, 63 warnings in 701.26s (0:11:41) =
2025-02-21T11:49:21.1054429Z ##[error]Process completed with exit code 1.
